<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>REMEEX Visa Banking</title>
  <link rel="icon" href="https://w7.pngwing.com/pngs/400/28/png-transparent-credit-card-computer-icons-visa-electron-bank-curio-blue-text-rectangle-thumbnail.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/v-mask@2.3.0/dist/v-mask.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.4/dist/gsap.min.js"></script>

  <style>
    :root {
      /* Modern color palette based on Revolut/N26 style */
      --primary: #1a1f71;
      --primary-dark: #0c1045;
      --primary-light: #3244b6;
      --secondary: #00579f;
      --accent: #f7b600;
      --success: #00d34d;
      --danger: #ff4d4d;
      --warning: #ffad33;
      --info: #0095ff;
      --neutral-100: #ffffff;
      --neutral-200: #f5f7fa;
      --neutral-300: #eaecf0;
      --neutral-400: #d0d5dd;
      --neutral-500: #9da4b4;
      --neutral-600: #6e7891;
      --neutral-700: #4f5d75;
      --neutral-800: #293249;
      --neutral-900: #1a1f37;

      /* Shadows & Effects */
      --shadow-sm: 0 1px 3px rgba(16, 24, 40, 0.1);
      --shadow-md: 0 4px 8px -2px rgba(16, 24, 40, 0.1), 0 2px 4px -2px rgba(16, 24, 40, 0.06);
      --shadow-lg: 0 12px 16px -4px rgba(16, 24, 40, 0.08), 0 4px 6px -2px rgba(16, 24, 40, 0.03);
      --shadow-xl: 0 20px 24px -4px rgba(16, 24, 40, 0.08), 0 8px 8px -4px rgba(16, 24, 40, 0.03);
      --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
      
      /* Border radius */
      --radius-sm: 6px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      
      /* Transitions */
      --transition-fast: all 0.2s ease;
      --transition-base: all 0.3s ease;
      --transition-slow: all 0.5s ease;
      
      /* Card gradients */
      --card-gradient: linear-gradient(135deg, #1a1f71 0%, #0c1045 100%);
      --success-gradient: linear-gradient(135deg, #00c057 0%, #00a346 100%);
      
      /* Animations */
      --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--neutral-200);
      color: var(--neutral-900);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      height: 100vh;
      margin: 0;
      position: relative;
    }
    
    /* Scrollbars */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--neutral-200);
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--neutral-500);
      border-radius: var(--radius-full);
    }
    
    /* Header */
    .app-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.6rem 1rem;
      background: var(--neutral-100);
      border-bottom: 1px solid var(--neutral-300);
      box-shadow: var(--shadow-sm);
      z-index: 1000;
      height: 60px;
    }
    
    .header-brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .header-brand img {
      height: 32px;
      width: auto;
    }
    
    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .header-action-btn {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--neutral-200);
      color: var(--neutral-700);
      border: none;
      cursor: pointer;
      transition: var(--transition-base);
      position: relative;
    }
    
    .header-action-btn:hover {
      background: var(--neutral-300);
      color: var(--neutral-900);
    }
    
    .notification-badge {
      position: absolute;
      top: -2px;
      right: -2px;
      background: var(--danger);
      color: white;
      border-radius: var(--radius-full);
      font-size: 0.6rem;
      width: 16px;
      height: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }
    
    /* Connected Users Badge */
    .users-online-badge {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.25rem 0.5rem;
      background: rgba(26, 31, 113, 0.08);
      border-radius: var(--radius-md);
      font-size: 0.7rem;
      color: var(--primary);
      font-weight: 500;
      white-space: nowrap;
    }
    
    .users-online-badge i {
      font-size: 0.7rem;
    }
    
    .pulse-dot {
      width: 6px;
      height: 6px;
      background-color: var(--success);
      border-radius: 50%;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(0, 211, 77, 0.7);
      }
      
      70% {
        transform: scale(1);
        box-shadow: 0 0 0 4px rgba(0, 211, 77, 0);
      }
      
      100% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(0, 211, 77, 0);
      }
    }
    
    /* Account Balance Card */
    .balance-card {
      background: var(--card-gradient);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      color: white;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
      margin-bottom: 1.25rem;
      transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
    }
    
    .balance-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-xl);
    }
    
    .balance-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      animation: shine 3s infinite;
    }
    
    @keyframes shine {
      100% { left: 200%; }
    }
    
    .card-decoration {
      position: absolute;
      right: -50px;
      bottom: -50px;
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      z-index: 1;
    }
    
    .card-decoration:nth-child(2) {
      left: -30px;
      top: -30px;
      width: 150px;
      height: 150px;
    }
    
    .balance-content {
      position: relative;
      z-index: 2;
    }
    
    .balance-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    
    .header-avatar {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: rgba(255, 255, 255, 0.2);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.8rem;
      flex-shrink: 0;
    }

    .balance-label {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 0.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .balance-label i {
      font-size: 0.9rem;
    }
    
    .balance-amount {
      font-size: clamp(1.5rem, 5vw, 2.25rem);
      font-weight: 700;
      margin: 0.5rem 0 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: nowrap;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .currency-flag {
      width: 20px;
      height: 14px;
      border-radius: 2px;
      object-fit: cover;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      flex-shrink: 0;
    }
    
    .balance-equivalents {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }
    
    .balance-equivalent {
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-md);
      padding: 0.4rem 0.6rem;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      white-space: nowrap;
    }
    
    .exchange-rate {
      background: rgba(255, 255, 255, 0.15);
      border-radius: var(--radius-md);
      padding: 0.4rem 0.6rem;
      font-size: 0.75rem;
      margin-bottom: 0.75rem;
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }
    
    .balance-date {
      font-size: 0.7rem;
      opacity: 0.7;
      margin-bottom: 1rem;
    }
    
    .balance-actions {
      display: flex;
      gap: 0.75rem;
      margin-top: 0.75rem;
    }
    
    .balance-btn {
      flex: 1;
      border: none;
      border-radius: var(--radius-md);
      height: 42px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.8rem;
      background: rgba(255,255,255,0.15);
      color: white;
      cursor: pointer;
      transition: all 0.3s var(--animation-bounce);
      backdrop-filter: blur(5px);
      white-space: nowrap;
    }
    
    .balance-btn:hover {
      background: rgba(255,255,255,0.25);
      transform: translateY(-3px);
    }
    
    .balance-btn:active {
      transform: translateY(0);
    }
    
    .balance-btn i {
      margin-right: 6px;
      font-size: 0.9rem;
    }
    
    /* Pending transactions badge */
    .pending-transaction-badge {
      background: rgba(255, 173, 51, 0.2);
      border-left: 3px solid var(--warning);
      border-radius: var(--radius-md);
      padding: 0.6rem;
      margin-top: 0.6rem;
      font-size: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .pending-transaction-badge i {
      color: var(--warning);
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    
    /* Dashboard Layout */
    .app-container {
      padding-top: 70px;
      padding-bottom: 70px;
      max-width: 100%;
      margin: 0 auto;
      height: 100vh;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
    }
    
    .dashboard-content {
      padding: 0.75rem;
      max-width: 1200px;
      margin: 0 auto;
    }
   
    /* Sections */
    .section-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--neutral-900);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .section-title i {
      margin-right: 0.5rem;
      color: var(--primary);
    }
    
    .section-title a {
      font-size: 0.7rem;
      color: var(--primary);
      text-decoration: none;
    }
    
    /* Cards */
    .card {
      background: var(--neutral-100);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      padding: 1rem;
      margin-bottom: 1.25rem;
      transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    /* Transactions */
    .transaction-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .transaction-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem;
      background: var(--neutral-100);
      border-radius: var(--radius-md);
      transition: all 0.3s ease;
      box-shadow: var(--shadow-sm);
    }
    
    .transaction-item:hover {
      background: var(--neutral-200);
      transform: translateX(5px);
      box-shadow: var(--shadow-md);
    }
    
    .transaction-icon {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      flex-shrink: 0;
    }
    
    .transaction-icon.deposit {
      background: var(--success);
      color: white;
    }
    
    .transaction-icon.withdraw {
      background: var(--danger);
      color: white;
    }
    
    .transaction-icon.transfer {
      background: var(--primary-light);
      color: white;
    }

    .transaction-icon.pending {
      background: var(--warning);
      color: white;
    }

    .transaction-icon.rejected {
      background: var(--danger);
      color: white;
    }
    
    .transaction-content {
      flex: 1;
      min-width: 0;
    }
    
    .transaction-title {
      font-weight: 600;
      font-size: 0.8rem;
      color: var(--neutral-900);
      margin-bottom: 0.125rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    
    .transaction-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.125rem 0.375rem;
      border-radius: var(--radius-sm);
      font-size: 0.6rem;
      font-weight: 600;
      text-transform: uppercase;
      margin-top: 1px;
    }
    
    .transaction-badge.pending {
      background: rgba(255, 173, 51, 0.15);
      color: var(--warning);
    }
    
    .transaction-badge.processing {
      background: rgba(0, 149, 255, 0.15);
      color: var(--info);
    }

    .transaction-badge.rejected {
      background: rgba(255, 77, 77, 0.15);
      color: var(--danger);
    }
    
    .transaction-details {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
      font-size: 0.7rem;
      color: var(--neutral-600);
    }
    
    .transaction-date {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .transaction-date i {
      font-size: 0.7rem;
    }
    
    .transaction-category {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .transaction-category i {
      font-size: 0.7rem;
    }
    
    .transaction-amount {
      font-weight: 600;
      font-size: 0.8rem;
      white-space: nowrap;
      flex-shrink: 0;
    }
    
    .transaction-amount.deposit {
      color: var(--success);
    }
    
    .transaction-amount.withdraw {
      color: var(--danger);
    }

    .transaction-amount.pending {
      color: var(--warning);
    }

    .transaction-amount.rejected {
      color: var(--danger);
    }
    
    /* Navigation Bar */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      display: flex;
      justify-content: space-around;
      padding: 0.5rem 0;
      box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
      z-index: 900;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.25rem;
      padding: 0.4rem;
      border-radius: var(--radius-md);
      transition: var(--transition-base);
      cursor: pointer;
      flex: 1;
    }
    
    .nav-item.active {
      color: var(--primary);
    }
    
    .nav-icon {
      font-size: 1.1rem;
      transition: transform 0.3s var(--animation-bounce);
    }
    
    .nav-item:hover .nav-icon {
      transform: translateY(-3px);
    }
    
    .nav-label {
      font-size: 0.6rem;
      font-weight: 600;
    }

    /* Service Overlay */
    .service-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    .service-container {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      border-top-left-radius: var(--radius-lg);
      border-top-right-radius: var(--radius-lg);
      padding: 1.5rem;
      animation: slideUp 0.4s ease;
      max-height: 80vh;
      overflow-y: auto;
    }

    .service-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .service-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .service-close {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--neutral-200);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-base);
    }

    .service-close:hover {
      background: var(--neutral-300);
    }

    .service-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .service-item {
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
      transition: all 0.3s var(--animation-bounce);
      text-align: center;
    }

    .service-item:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-md);
    }

    /* Support Overlay */
    .support-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    .support-container {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      border-top-left-radius: var(--radius-lg);
      border-top-right-radius: var(--radius-lg);
      padding: 1.5rem;
      animation: slideUp 0.4s ease;
      max-height: 80vh;
      overflow-y: auto;
    }

    .support-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .support-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .support-close {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--neutral-200);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-base);
    }

    .support-close:hover {
      background: var(--neutral-300);
    }

    .support-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .support-option {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      color: var(--neutral-900);
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 0.75rem;
      transition: var(--transition-base);
    }

    .support-option:hover {
      background: var(--neutral-300);
    }

    .support-option i {
      font-size: 1.25rem;
      color: var(--primary);
    }

    .register-exit {
      text-align: center;
      margin-top: 1rem;
    }

    .service-icon {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-full);
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }

    .service-icon.bills {
      background: var(--secondary);
    }

    .service-icon.dollar {
      background: var(--success);
    }

    .service-icon.zelle {
      background: var(--info);
    }

    .service-icon.exchange {
      background: var(--accent);
      color: var(--neutral-900);
    }

    .service-icon.reviews {
      background: var(--warning);
    }

    .service-icon.chat {
      background: var(--primary-light);
    }

    .service-name {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--neutral-900);
    }

    .service-description {
      font-size: 0.7rem;
      color: var(--neutral-600);
    }

    /* Cards Overlay */
    .cards-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    .card-container {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      border-top-left-radius: var(--radius-lg);
      border-top-right-radius: var(--radius-lg);
      padding: 1.5rem;
      animation: slideUp 0.4s ease;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .card-close {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--neutral-200);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-base);
    }

    .card-close:hover {
      background: var(--neutral-300);
    }

    .virtual-card {
      background: var(--card-gradient);
      border-radius: var(--radius-lg);
      height: 200px;
      width: 100%;
      max-width: 350px;
      margin: 0 auto 1.5rem;
      padding: 1.25rem;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
      color: white;
    }

    .virtual-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      animation: shine 3s infinite;
    }

    .card-logo {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 2rem;
    }

    .card-chip {
      width: 40px;
      height: auto;
      flex-shrink: 0;
    }

    .card-brand {
      width: 55px;
      height: auto;
      flex-shrink: 0;
    }

    .card-number {
      font-size: 1.25rem;
      letter-spacing: 1px;
      margin-bottom: 1.25rem;
      font-family: monospace;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card-details {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
    }

    .card-apps {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1.5rem;
      margin-bottom: 2rem;
    }

    .card-app {
      width: 46px;
      height: 46px;
      border-radius: var(--radius-md);
      background: var(--neutral-200);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--neutral-800);
    }

    .card-text {
      text-align: center;
      font-size: 0.9rem;
      color: var(--neutral-600);
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    /* Messages Overlay */
    .messages-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    .messages-container {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      border-top-left-radius: var(--radius-lg);
      border-top-right-radius: var(--radius-lg);
      padding: 1.5rem;
      animation: slideUp 0.4s ease;
      max-height: 80vh;
      overflow-y: auto;
    }

    .messages-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .messages-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .messages-close {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--neutral-200);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-base);
    }

    .messages-close:hover {
      background: var(--neutral-300);
    }

    .message-item {
      display: flex;
      gap: 1rem;
      padding: 1rem;
      border-radius: var(--radius-md);
      background: var(--neutral-200);
      margin-bottom: 1rem;
    }

    .message-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      flex-shrink: 0;
    }

    .message-icon.welcome {
      background: var(--success);
    }

    .message-icon.verify {
      background: var(--warning);
    }

    .message-icon.security {
      background: var(--info);
    }

    .message-content {
      flex: 1;
    }

    .message-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 0.25rem;
      color: var(--neutral-900);
    }

    .message-text {
      font-size: 0.8rem;
      color: var(--neutral-600);
    }

    .message-time {
      font-size: 0.7rem;
      color: var(--neutral-500);
      margin-top: 0.5rem;
    }

    /* Settings Overlay */
    .settings-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    .settings-container {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      border-top-left-radius: var(--radius-lg);
      border-top-right-radius: var(--radius-lg);
      padding: 1.5rem;
      animation: slideUp 0.4s ease;
      max-height: 80vh;
      overflow-y: auto;
    }

    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .settings-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
    }

    .settings-close {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--neutral-200);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-base);
    }

    .settings-close:hover {
      background: var(--neutral-300);
    }
    
    /* Login Page */
    .login-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
      background: var(--neutral-200);
      background-image: linear-gradient(135deg, rgba(26, 31, 113, 0.05) 0%, rgba(26, 31, 113, 0.02) 100%);
    }
    
    .login-card {
      background: var(--neutral-100);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      padding: 1.5rem;
      width: 100%;
      max-width: 400px;
      animation: fadeIn 0.5s ease;
    }
    
    .login-logo {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.5rem;
    }
    
    .login-logo-container {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
    }
    
    .login-logo img {
      height: 45px;
      width: auto;
      object-fit: contain;
    }
    
    .login-heading {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    
    .login-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    
    .login-subtitle {
      font-size: 0.85rem;
      color: var(--neutral-600);
    }
    
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-label {
      display: block;
      font-size: 0.8rem;
      font-weight: 500;
      color: var(--neutral-700);
      margin-bottom: 0.5rem;
    }
    
    .form-control {
      width: 100%;
      height: 44px;
      padding: 0 1rem;
      border: 1px solid var(--neutral-400);
      border-radius: var(--radius-md);
      font-size: 0.85rem;
      color: var(--neutral-900);
      background: var(--neutral-100);
      transition: var(--transition-base);
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15);
    }
    
    .error-message {
      font-size: 0.7rem;
      color: var(--danger);
      margin-top: 0.5rem;
      display: none;
    }

    .password-group {
      position: relative;
    }

    .toggle-password {
      position: absolute;
      top: 50%;
      right: 1rem;
      transform: translateY(-50%);
      cursor: pointer;
      color: var(--neutral-500);
      font-size: 1rem;
    }

    .password-strength {
      height: 6px;
      width: 100%;
      background: var(--neutral-300);
      border-radius: var(--radius-full);
      overflow: hidden;
      margin-top: 0.25rem;
    }

    .password-strength-bar {
      height: 100%;
      width: 0;
      background: var(--danger);
      transition: width 0.3s;
    }

    .register-step {
      display: none;
    }

    .register-step.active {
      display: block;
    }

    .wizard-nav {
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .password-strength-text {
      font-size: 0.7rem;
      color: var(--neutral-600);
      margin-top: 0.25rem;
    }
    
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 44px;
      padding: 0 1.5rem;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 0.85rem;
      border: none;
      cursor: pointer;
      transition: all 0.3s var(--animation-bounce);
    }
    
    .btn-primary {
      background: var(--primary);
      color: white;
      width: 100%;
    }
    
    .btn-primary:hover {
      background: var(--primary-light);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .btn-outline {
      background: transparent;
      border: 1px solid var(--primary);
      color: var(--primary);
    }
    
    .btn-outline:hover {
      background: rgba(26, 31, 113, 0.05);
      transform: translateY(-3px);
    }
    
    .btn i {
      margin-right: 0.5rem;
      font-size: 0.9rem;
    }
    
    /* OTP Verification for Card Payment */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    .modal {
      background: var(--neutral-100);
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 380px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
    }
    
    .modal-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
      margin-bottom: 0.75rem;
      text-align: center;
    }
    
    .modal-subtitle {
      font-size: 0.85rem;
      color: var(--neutral-600);
      margin-bottom: 1.5rem;
      text-align: center;
    }
    
    .otp-container {
      display: flex;
      gap: 0.5rem;
      margin: 1.5rem 0;
      justify-content: center;
    }
    
    .otp-input {
      width: 40px;
      height: 48px;
      border: 1px solid var(--neutral-400);
      border-radius: var(--radius-md);
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--neutral-900);
    }
    
    .otp-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15);
    }
    
    .resend-code {
      text-align: center;
      margin-top: 1rem;
      font-size: 0.8rem;
      color: var(--neutral-600);
    }
    
    .resend-code a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }
    
    /* Feature Blocked Modal */
    .feature-blocked-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      display: none;
    }

    .feature-blocked-card {
      background: var(--neutral-100);
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 380px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
      text-align: center;
    }

    .feature-blocked-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--warning);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.75rem;
      margin: 0 auto 1.25rem;
    }

    .feature-blocked-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
      margin-bottom: 0.75rem;
    }

    .feature-blocked-message {
      font-size: 0.85rem;
      color: var(--neutral-600);
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    .feature-blocked-actions {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    /* Recharge Page */
    .recharge-container {
      padding: 1rem;
      padding-top: 70px;
      padding-bottom: 70px;
      display: none;
      max-width: 800px;
      margin: 0 auto;
    }

    /* Transfer Page (embedded) */
    .transfer-container {
      padding: 1rem;
      padding-top: 70px;
      padding-bottom: 70px;
      display: none;
      max-width: 900px;
      margin: 0 auto;
    }

    .transfer-container iframe {
      width: 100%;
      height: calc(100vh - 140px);
      border: none;
    }

    /* Verification Page (embedded) */
    .verification-container {
      padding: 1rem;
      padding-top: 70px;
      padding-bottom: 70px;
      display: none;
      max-width: 900px;
      margin: 0 auto;
    }

    .verification-container iframe {
      width: 100%;
      height: calc(100vh - 140px);
      border: none;
    }
    
    .payment-method-tabs {
      display: flex;
      margin-bottom: 1.5rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 0.25rem;
    }
    
    .payment-method-tab {
      flex: 1;
      text-align: center;
      padding: 0.6rem 0.5rem;
      border-radius: var(--radius-md);
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition-base);
      white-space: nowrap;
    }
    
    .payment-method-tab.active {
      background: var(--neutral-100);
      box-shadow: var(--shadow-sm);
      color: var(--primary);
    }
    
    .payment-method-content {
      display: none;
    }
    
    .payment-method-content.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }
    
    .amount-select {
      width: 100%;
      height: 44px;
      padding: 0 1rem;
      border: 1px solid var(--neutral-400);
      border-radius: var(--radius-md);
      font-size: 0.85rem;
      color: var(--neutral-900);
      background: var(--neutral-100);
      margin-bottom: 1.5rem;
    }
    
    .amount-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15);
    }
    
    .security-badge {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: rgba(26, 31, 113, 0.05);
      border-radius: var(--radius-md);
      padding: 0.75rem;
      margin-bottom: 1.25rem;
    }
    
    .security-badge-icon {
      width: 30px;
      height: 30px;
      background: var(--primary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    
    .security-badge-content {
      flex: 1;
      min-width: 0;
    }
    
    .security-badge-title {
      font-weight: 600;
      font-size: 0.8rem;
      color: var(--neutral-900);
      margin-bottom: 0.125rem;
    }
    
    .security-badge-text {
      font-size: 0.7rem;
      color: var(--neutral-600);
      white-space: normal;
    }
    
    /* Bank Account Details */
    .bank-details {
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 1.1rem;
      margin: 1.25rem 0;
    }
    
    .bank-detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--neutral-300);
    }
    
    .bank-detail-row:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    
    .bank-detail-label {
      font-size: 0.8rem;
      color: var(--neutral-600);
      flex-shrink: 0;
      margin-right: 0.5rem;
    }
    
    .bank-detail-value {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--neutral-900);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-align: right;
      word-break: break-word;
      flex-grow: 1;
    }
    
    .copy-btn {
      background: var(--neutral-300);
      color: var(--neutral-700);
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-full);
      cursor: pointer;
      transition: var(--transition-base);
      flex-shrink: 0;
    }
    
    .copy-btn:hover {
      background: var(--primary);
      color: white;
    }
    
    .bank-warning {
      background: rgba(247, 182, 0, 0.1);
      border-left: 3px solid var(--warning);
      padding: 0.75rem;
      margin-top: 1.25rem;
      border-radius: var(--radius-sm);
    }
    
    .bank-warning-title {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--neutral-900);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .bank-warning-title i {
      color: var(--warning);
    }
    
    .bank-warning-content {
      font-size: 0.8rem;
      color: var(--neutral-700);
    }
    
    /* Receipt Upload */
    .receipt-upload {
      border: 2px dashed var(--neutral-400);
      border-radius: var(--radius-md);
      padding: 1.5rem 1rem;
      margin: 1.25rem 0;
      text-align: center;
      cursor: pointer;
      transition: var(--transition-base);
    }
    
    .receipt-upload:hover {
      border-color: var(--primary);
      background: rgba(26, 31, 113, 0.02);
    }
    
    .receipt-upload i {
      font-size: 2rem;
      color: var(--neutral-500);
      margin-bottom: 0.75rem;
    }
    
    .receipt-upload-title {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--neutral-800);
      margin-bottom: 0.4rem;
    }
    
    .receipt-upload-subtitle {
      font-size: 0.75rem;
      color: var(--neutral-600);
    }
    
    .receipt-preview {
      display: none;
      margin-top: 1.25rem;
    }
    
    .receipt-preview-container {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.8rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      margin-bottom: 0.75rem;
    }
    
    .receipt-preview-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-md);
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      flex-shrink: 0;
    }
    
    .receipt-preview-content {
      flex: 1;
      min-width: 0;
    }
    
    .receipt-preview-name {
      font-weight: 600;
      font-size: 0.8rem;
      margin-bottom: 0.2rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .receipt-preview-size {
      font-size: 0.7rem;
      color: var(--neutral-600);
    }
    
    .receipt-preview-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    /* Reference Number */
    .reference-number {
      margin-top: 1.25rem;
    }
    
    /* Credit Card Form */
    .card-preview {
      width: 100%;
      max-width: 350px;
      height: 200px;
      margin: 0 auto 1.5rem;
      perspective: 1000px;
      transition: var(--transition-base);
    }
    
    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.8s;
      transform-style: preserve-3d;
    }
    
    .card-preview.-active .card-inner {
      transform: rotateY(180deg);
    }
    
    .card-front,
    .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      box-shadow: var(--shadow-lg);
    }
    
    .card-front {
      background: var(--card-gradient);
      color: white;
    }
    
    .card-back {
      background: var(--card-gradient);
      color: white;
      transform: rotateY(180deg);
    }
    
    .card-logo {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 2rem;
    }
    
    .card-chip {
      width: 40px;
      height: auto;
      flex-shrink: 0;
    }
    
    .card-brand {
      width: 55px;
      height: auto;
      flex-shrink: 0;
    }
    
    .card-number {
      font-size: 1.25rem;
      letter-spacing: 1px;
      margin-bottom: 1.25rem;
      font-family: monospace;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .card-details {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
    }
    
    .card-holder {
      text-transform: uppercase;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      max-width: 65%;
    }
    
    .card-expiry {
      display: flex;
      gap: 0.25rem;
      flex-shrink: 0;
    }
    
    .card-stripe {
      height: 40px;
      background: #000;
      margin: 1rem 0;
    }
    
    .card-cvv {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      height: 40px;
      background: white;
      color: black;
      border-radius: 4px;
      padding: 0 0.75rem;
      font-size: 1rem;
      font-family: monospace;
    }
    
    .card-form {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }
    
    .card-row {
      display: flex;
      gap: 0.75rem;
    }
    
    .card-col {
      flex: 1;
    }

    .saved-card-container {
      display: none;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 1rem;
      margin-bottom: 1.5rem;
    }

    .saved-card {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .saved-card-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }

    .saved-card-details {
      flex: 1;
    }

    .saved-card-number {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--neutral-900);
    }

    .saved-card-type {
      font-size: 0.75rem;
      color: var(--neutral-600);
    }

    .saved-card-use {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .saved-card-checkbox {
      width: 18px;
      height: 18px;
    }
    
    /* Loading */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      display: none;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
      margin-bottom: 1.5rem;
    }
    
    .loading-text {
      color: white;
      font-size: 1rem;
      margin-bottom: 1.5rem;
      font-weight: 500;
    }
    
    .progress-bar-container {
      width: 80%;
      max-width: 280px;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-full);
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: white;
      width: 0%;
      border-radius: var(--radius-full);
      transition: width 0.3s ease;
    }
    
    /* Success Animation */
    .success-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1200;
      display: none;
    }
    
    .success-card {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 380px;
      padding: 2rem;
      text-align: center;
      animation: scaleIn 0.3s ease;
    }
    
    .success-checkmark {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--success);
      color: white;
      font-size: 2.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1.5rem;
      transform: scale(0);
      animation: checkmarkScale 0.5s ease forwards 0.3s;
    }
    
    .success-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--neutral-900);
      margin-bottom: 0.75rem;
      opacity: 0;
      animation: fadeInUp 0.5s ease forwards 0.8s;
    }
    
    .success-amount {
      font-size: 2.25rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 1.25rem;
      opacity: 0;
      animation: fadeInUp 0.5s ease forwards 1.1s;
    }
    
    .success-message {
      font-size: 0.9rem;
      color: var(--neutral-600);
      margin-bottom: 1.5rem;
      opacity: 0;
      animation: fadeInUp 0.5s ease forwards 1.4s;
    }
    
    .success-actions {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      opacity: 0;
      animation: fadeInUp 0.5s ease forwards 1.7s;
    }
    
    /* Verification Banner */
    .verify-banner {
      background: linear-gradient(135deg, var(--warning) 0%, #f59e0b 100%);
      border-radius: var(--radius-md);
      padding: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin: 1.25rem 0;
      box-shadow: var(--shadow-md);
    }
    
    .verify-icon {
      width: 36px;
      height: 36px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--warning);
      font-size: 1.1rem;
      flex-shrink: 0;
    }
    
    .verify-content {
      flex: 1;
      min-width: 0;
    }
    
    .verify-title {
      font-weight: 600;
      color: white;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    
    .verify-text {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.8rem;
    }
    
    .verify-action {
      background: white;
      color: var(--warning);
      font-weight: 600;
      font-size: 0.8rem;
      padding: 0.4rem 0.75rem;
      border-radius: var(--radius-md);
      flex-shrink: 0;
      transition: all 0.3s var(--animation-bounce);
      cursor: pointer;
      border: none;
      white-space: nowrap;
    }
    
    .verify-action:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* Verification Processing Banner - NUEVA IMPLEMENTACIÓN */
    .verification-processing-banner {
      background: linear-gradient(135deg, var(--info) 0%, #0d7ea3 100%);
      border-radius: var(--radius-md);
      padding: 0.9rem;
      display: none;
      align-items: center;
      gap: 0.8rem;
      margin: 1.25rem 0;
      box-shadow: var(--shadow-md);
    }
    
    .verification-processing-icon {
      width: 36px;
      height: 36px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--info);
      font-size: 1.1rem;
      flex-shrink: 0;
    }
    
    .verification-processing-content {
      flex: 1;
      min-width: 0;
    }
    
    .verification-processing-title {
      font-weight: 600;
      color: white;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    
    .verification-processing-text {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.8rem;
    }

    .verification-processing-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
      flex-shrink: 0;
    }

    .verification-support-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      font-weight: 500;
      font-size: 0.7rem;
      padding: 0.3rem 0.6rem;
      border-radius: var(--radius-md);
      flex-shrink: 0;
      transition: all 0.3s ease;
      cursor: pointer;
      border: none;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      backdrop-filter: blur(5px);
    }
    
    .verification-support-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .verification-support-btn i {
      font-size: 0.8rem;
    }
    
/* Verification Status Items */
.verification-status-items {
  margin-top: 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.verification-status-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  background: rgba(255, 255, 255, 0.1);
  padding: 0.75rem;
  border-radius: var(--radius-md);
  backdrop-filter: blur(5px);
}

.status-icon-container {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.status-icon {
  font-size: 1.5rem;
}

.status-icon.success {
  color: #4ade80;
  filter: drop-shadow(0 0 4px rgba(74, 222, 128, 0.5));
  animation: checkmarkPulse 2s ease-in-out infinite;
}

.status-icon.warning {
  color: #fbbf24;
  filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.5));
  animation: warningPulse 1.5s ease-in-out infinite;
}

.status-spinner {
  width: 24px;
  height: 24px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: #fbbf24;
  animation: spin 1s linear infinite;
  filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.3));
}

.status-text {
  flex: 1;
  color: white;
}

.status-label {
  font-weight: 600;
  font-size: 0.9rem;
  margin-bottom: 0.125rem;
}

.status-sublabel {
  font-size: 0.75rem;
  opacity: 0.9;
}

@keyframes checkmarkPulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
}

@keyframes warningPulse {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.05);
    opacity: 0.8;
  }
}

/* Update processing icon when in bank validation phase */
.verification-processing-icon.bank-phase {
  background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
}

.verification-processing-icon.bank-phase i {
  animation: iconRotate 3s ease-in-out infinite;
}

@keyframes iconRotate {
  0%, 100% {
    transform: rotate(0deg);
  }
  25% {
    transform: rotate(-5deg);
  }
  75% {
    transform: rotate(5deg);
  }
}

    /* Identity Verification Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      display: none;
    }
    
    /* Bank/Mobile Transfer Processing Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: 70px;
      right: 16px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .toast {
      background: var(--neutral-900);
      color: white;
      border-radius: var(--radius-md);
      padding: 0.75rem 1rem;
      min-width: 250px;
      max-width: 320px;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      animation: slideInRight 0.3s ease, fadeOut 0.3s ease 3s forwards;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--danger);
    }
    
    .toast.warning {
      border-left: 4px solid var(--warning);
    }
    
    .toast.info {
      border-left: 4px solid var(--info);
    }
    
    .toast-icon {
      flex-shrink: 0;
    }
    
    .toast-content {
      flex: 1;
      min-width: 0;
    }
    
    .toast-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.2rem;
    }
    
    .toast-message {
      font-size: 0.75rem;
      opacity: 0.9;
      word-wrap: break-word;
    }
    
    .toast-close {
      color: var(--neutral-400);
      cursor: pointer;
      transition: var(--transition-base);
      flex-shrink: 0;
    }
    
    .toast-close:hover {
      color: white;
    }
    
    /* Inactivity Modal */
    .inactivity-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      display: none;
      animation: fadeIn 0.3s ease;
    }
    
    .inactivity-card {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 320px;
      padding: 1.5rem;
      text-align: center;
      animation: scaleIn 0.3s ease;
    }
    
    .inactivity-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: var(--warning);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.75rem;
      margin: 0 auto 1.25rem;
    }
    
    .inactivity-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
      margin-bottom: 0.75rem;
    }
    
    .inactivity-message {
      font-size: 0.85rem;
      color: var(--neutral-600);
      margin-bottom: 1.25rem;
    }
    
    .inactivity-timer {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--danger);
      margin-bottom: 1.25rem;
    }
    
    .inactivity-actions {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    /* Welcome Modal */
    .welcome-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1200;
      display: none;
    }
    
    .welcome-card {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 380px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
    }
    
    .welcome-header {
      display: flex;
      align-items: center;
      gap: 1.25rem;
      margin-bottom: 1.25rem;
    }
    
    .welcome-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      flex-shrink: 0;
    }
    
    .welcome-title-container {
      flex: 1;
      min-width: 0;
    }
    
    .welcome-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
      margin-bottom: 0.25rem;
    }
    
    .welcome-subtitle {
      font-size: 0.85rem;
      color: var(--neutral-600);
    }
    
    .welcome-content {
      margin-bottom: 1.5rem;
    }
    
    .welcome-step {
      display: flex;
      gap: 0.75rem;
      align-items: flex-start;
      margin-bottom: 1.25rem;
    }
    
    .welcome-step-icon {
      width: 28px;
      height: 28px;
      border-radius: var(--radius-full);
      background: var(--primary-light);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    
    .welcome-step-content {
      flex: 1;
    }
    
    .welcome-step-title {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--neutral-900);
      margin-bottom: 0.25rem;
    }
    
    .welcome-step-description {
      font-size: 0.8rem;
      color: var(--neutral-600);
    }

    /* Contact Section */
    .contact-options {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 1.25rem;
    }
    
    .contact-option {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.9rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--neutral-900);
    }
    
    .contact-option:hover {
      background: var(--neutral-300);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .contact-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      flex-shrink: 0;
      color: white;
    }
    
    .contact-icon.whatsapp {
      background: #25D366;
    }
    
    .contact-icon.email {
      background: var(--primary);
    }

    .contact-icon.chat {
      background: var(--info);
    }

    .contact-icon.reviews {
      background: var(--warning);
    }
    
    .contact-content {
      flex: 1;
      min-width: 0;
    }
    
    .contact-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.2rem;
    }
    
    .contact-description {
      font-size: 0.75rem;
      color: var(--neutral-600);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Tawk.to */
    .tawkto-container {
      position: fixed;
      z-index: 1200;
      bottom: 20px;
      right: 20px;
      visibility: visible !important;
      display: block !important;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes scaleIn {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes checkmarkScale {
      from { transform: scale(0); }
      to { transform: scale(1); }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; visibility: hidden; }
    }

    @keyframes slideUp {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    /* Custom toggle switch */
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--neutral-400);
      transition: .4s;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
    }
    
    input:checked + .slider {
      background-color: var(--primary);
    }
    
    input:focus + .slider {
      box-shadow: 0 0 1px var(--primary);
    }
    
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    
    .slider.round {
      border-radius: 24px;
    }
    
    .slider.round:before {
      border-radius: 50%;
    }

    /* Botón para procesar directamente el pago con tarjeta guardada */
    .saved-card-pay-btn {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: var(--radius-md);
      padding: 0.8rem 1rem;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s var(--animation-bounce);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      margin-top: 1rem;
      width: 100%;
    }
    
    .saved-card-pay-btn:hover {
      background: var(--primary-light);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .saved-card-pay-btn:active {
      transform: translateY(0);
    }

    /* Primera recarga - Banner */
    .first-recharge-banner {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border-radius: var(--radius-md);
      padding: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin: 1.25rem 0;
      box-shadow: var(--shadow-md);
    }
    
    .first-recharge-icon {
      width: 36px;
      height: 36px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
      font-size: 1.1rem;
      flex-shrink: 0;
    }
    
    .first-recharge-content {
      flex: 1;
      min-width: 0;
    }
    
    .first-recharge-title {
      font-weight: 600;
      color: white;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    
    .first-recharge-text {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.8rem;
    }
    
    .first-recharge-action {
      background: white;
      color: var(--primary);
      font-weight: 600;
      font-size: 0.8rem;
      padding: 0.4rem 0.75rem;
      border-radius: var(--radius-md);
      flex-shrink: 0;
      transition: all 0.3s var(--animation-bounce);
      cursor: pointer;
      border: none;
      white-space: nowrap;
    }
    
    .first-recharge-action:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    /* Notificación de seguridad */
    .security-notice-banner {
      background: rgba(0, 149, 255, 0.1);
      border-left: 3px solid var(--info);
      border-radius: var(--radius-md);
      padding: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin: 1.25rem 0;
      box-shadow: var(--shadow-sm);
    }
    
    .security-notice-icon {
      width: 36px;
      height: 36px;
      background: var(--info);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.1rem;
      flex-shrink: 0;
    }
    
    .security-notice-content {
      flex: 1;
      min-width: 0;
    }
    
    .security-notice-title {
      font-weight: 600;
      color: var(--neutral-900);
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    
    .security-notice-text {
      color: var(--neutral-700);
      font-size: 0.8rem;
    }

    /* Nuevo estilo para el contenedor de soporte después de 5 minutos */
    .support-needed-container {
      display: none;
      background: linear-gradient(135deg, var(--warning) 0%, #f59e0b 100%);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      margin: 1.5rem 0;
      color: white;
      box-shadow: var(--shadow-lg);
      animation: fadeIn 0.5s ease;
    }

    .support-needed-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .support-needed-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: white;
      color: var(--warning);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .support-needed-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .support-needed-subtitle {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .support-needed-content {
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
      line-height: 1.6;
    }

    .whatsapp-support-btn {
      background: #25D366;
      color: white;
      border: none;
      border-radius: var(--radius-lg);
      padding: 1rem;
      width: 100%;
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      text-decoration: none;
      transition: all 0.3s var(--animation-bounce);
      box-shadow: var(--shadow-md);
    }

    .whatsapp-support-btn:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-xl);
    }

    .whatsapp-support-btn i {
      font-size: 1.5rem;
    }

    /* Estilos para botones deshabilitados */
    .btn-primary:disabled, 
    .saved-card-pay-btn:disabled {
      background: var(--neutral-500);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-primary:disabled:hover, 
    .saved-card-pay-btn:disabled:hover {
      background: var(--neutral-500);
      transform: none;
      box-shadow: none;
    }
    
    /* Mensaje de confirmación pago móvil */
    .mobile-payment-success {
      display: none;
      background: rgba(0, 211, 77, 0.1);
      border-left: 3px solid var(--success);
      border-radius: var(--radius-md);
      padding: 0.9rem;
      margin: 1.25rem 0;
      box-shadow: var(--shadow-sm);
    }
    
    .mobile-payment-success-icon {
      width: 36px;
      height: 36px;
      background: var(--success);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.1rem;
      flex-shrink: 0;
    }
    
    .mobile-payment-success-content {
      flex: 1;
      min-width: 0;
    }
    
    .mobile-payment-success-title {
      font-weight: 600;
      color: var(--neutral-900);
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
    }
    
    .mobile-payment-success-text {
      color: var(--neutral-700);
      font-size: 0.8rem;
    }

    /* Nuevos estilos para los botones de configuración */
    .settings-buttons {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-top: 1rem;
    }

    .settings-nav-btn {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.9rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--neutral-900);
      border: none;
      width: 100%;
      cursor: pointer;
    }

    .settings-nav-btn:hover {
      background: var(--neutral-300);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .settings-nav-icon {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      flex-shrink: 0;
      color: white;
    }

    .settings-nav-icon.verification {
      background: var(--primary);
    }

    .settings-nav-icon.activation {
      background: var(--success);
    }

    .settings-nav-content {
      flex: 1;
      min-width: 0;
      text-align: left;
    }

    .settings-nav-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.2rem;
    }

    .settings-nav-description {
      font-size: 0.75rem;
      color: var(--neutral-600);
    }
    
    /* Responsive Styles */
    @media (min-width: 480px) {      
      .users-online-badge {
        display: flex;
      }
      
      .saved-card-container {
        padding: 1.25rem;
      }
    }
    
    @media (min-width: 768px) {
      .app-container {
        max-width: 100%;
      }
      
      .dashboard-content {
        padding: 1.25rem;
      }
      
      .header-brand-text {
        display: block;
      }
      
      .balance-amount {
        font-size: 2.25rem;
      }
      
      .balance-btn {
        height: 44px;
        font-size: 0.85rem;
      }

      .service-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    @media (min-width: 1024px) {
      .dashboard-content {
        padding: 1.5rem;
      }
    }
  </style>
</head>

<body>
  <!-- Login Section -->
  <div class="login-container" id="login-container">
    <div class="login-card" id="login-card">
      <div class="login-logo">
        <div class="login-logo-container">
          <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX">
        </div>
      </div>
      
      <div class="login-heading">
        <h1 class="login-title">Bienvenido</h1>
        <p class="login-subtitle" id="login-subtitle">Ingrese sus datos para acceder a su cuenta</p>
      </div>
      
      <div class="security-badge">
        <div class="security-badge-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
      <div class="security-badge-content">
        <div class="security-badge-title">Conexión segura</div>
        <div class="security-badge-text">Sus datos están protegidos con cifrado de nivel bancario</div>
      </div>
      </div>

      <div class="balance-card" id="login-balance-card" style="display:none; margin-top:1rem;">
        <div class="card-decoration"></div>
        <div class="card-decoration"></div>
        <div class="balance-content">
          <div class="balance-header">
            <div class="balance-label">
              <i class="fas fa-wallet"></i>
              <span id="login-balance-label">Saldo</span>
            </div>
            <div class="header-avatar" id="login-avatar">--</div>
          </div>
          <div class="balance-amount" id="login-balance">
            <img src="https://upload.wikimedia.org/wikipedia/commons/0/06/Flag_of_Venezuela.svg" class="currency-flag" alt="Bandera de Venezuela">
            <span>Bs</span>
            <span id="login-balance-value">0,00</span>
          </div>
        </div>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="login-name">Nombre Completo</label>
        <input type="text" class="form-control" id="login-name" placeholder="Ej: Juan Pérez" aria-describedby="name-error">
        <div class="error-message" id="name-error">Por favor, introduce tu nombre y apellido (solo letras).</div>
      </div>
      
      <div class="form-group">
        <label class="form-label" for="login-email">Correo Electrónico</label>
        <input type="email" class="form-control" id="login-email" placeholder="ejemplo@correo.com" aria-describedby="email-error">
        <div class="error-message" id="email-error">Por favor, introduce un correo electrónico válido.</div>
      </div>

      <div class="form-group password-group">
        <label class="form-label" for="login-password">Contraseña</label>
        <input type="password" class="form-control" id="login-password" placeholder="Tu contraseña" aria-describedby="password-error">
        <span class="toggle-password" data-target="login-password"><i class="fas fa-eye"></i></span>
        <div class="error-message" id="password-error">La contraseña es obligatoria.</div>
      </div>

      <div class="form-group password-group">
        <label class="form-label" for="login-code">Clave de 20 dígitos</label>
        <input type="password" class="form-control" id="login-code" placeholder="Enviada a tu correo electrónico" aria-describedby="code-error">
        <span class="toggle-password" data-target="login-code"><i class="fas fa-eye"></i></span>
        <div class="error-message" id="code-error">La clave debe tener 20 dígitos.</div>
      </div>

      <div style="text-align: center; margin-top: 0.75rem;">
        <a href="#" id="forgot-password">¿Olvidaste tu contraseña?</a>
      </div>
      
      <button class="btn btn-primary" id="login-button">
        <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
      </button>

      <div style="text-align: center; margin-top: 1rem;">
        <a href="#" id="show-register">¿No tienes cuenta? Regístrate</a>
      </div>

      <div style="text-align: center; margin-top: 1.5rem;">
        <a href="https://wa.me/+17373018059" class="btn btn-outline" target="_blank" style="display: inline-flex; margin: 0 auto;">
          <i class="fab fa-whatsapp"></i> Contactar Soporte
        </a>
      </div>
    </div>


<div class="login-card" id="register-card" style="display:none;">
  <div class="login-logo">
    <div class="login-logo-container">
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX">
    </div>
  </div>

  <div class="login-heading">
    <h1 class="login-title">Registro</h1>
    <p class="login-subtitle">Crea tu cuenta</p>
  </div>

  <div class="register-step active" id="register-step-1">
    <div class="form-group">
      <label class="form-label" for="register-name">Nombres</label>
      <input type="text" class="form-control" id="register-name" placeholder="Ej: Juan Carlos" aria-describedby="register-name-error">
      <div class="error-message" id="register-name-error">Ingresa tus nombres.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-lastname">Apellidos</label>
      <input type="text" class="form-control" id="register-lastname" placeholder="Ej: Pérez" aria-describedby="register-lastname-error">
      <div class="error-message" id="register-lastname-error">Ingresa tus apellidos.</div>
    </div>
    <button class="btn btn-primary" id="register-next-1">Siguiente</button>
  </div>

  <div class="register-step" id="register-step-2" style="display:none;">
    <div class="form-group">
      <label class="form-label" for="register-gender">Género</label>
      <select id="register-gender" class="form-control" aria-describedby="register-gender-error">
        <option value="">Seleccione</option>
        <option value="el">Él</option>
        <option value="ella">Ella</option>
        <option value="elle">Elle</option>
      </select>
      <div class="error-message" id="register-gender-error">Seleccione su género.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-alias">¿Cómo prefieres que te llamen?</label>
      <input type="text" class="form-control" id="register-alias" aria-describedby="register-alias-error">
      <select id="alias-options" class="form-control" style="display:none; margin-top:0.25rem;"></select>
      <div class="error-message" id="register-alias-error">Indica tu nombre preferido.</div>
    </div>
    <div class="wizard-nav">
      <button class="btn btn-outline" id="register-prev-2">Anterior</button>
      <button class="btn btn-primary" id="register-next-2">Siguiente</button>
    </div>
  </div>

  <div class="register-step" id="register-step-3" style="display:none;">
    <div class="form-group">
      <label class="form-label" for="register-country">País</label>
      <select id="register-country" class="form-control" aria-describedby="register-country-error">
        <option value="">Seleccione</option>
        <option value="Venezuela">Venezuela</option>
        <option value="Colombia">Colombia</option>
        <option value="Argentina">Argentina</option>
        <option value="Chile">Chile</option>
        <option value="Perú">Perú</option>
      </select>
      <div class="error-message" id="register-country-error">Seleccione un país.</div>
    </div>
    <div class="form-group" id="venezuela-state-group" style="display:none;">
      <label class="form-label" for="register-state">Estado</label>
      <select id="register-state" class="form-control" aria-describedby="register-state-error">
        <option value="">Seleccione</option>
        <option value="Distrito Capital">Distrito Capital</option>
        <option value="Miranda">Miranda</option>
        <option value="Carabobo">Carabobo</option>
        <option value="Zulia">Zulia</option>
        <option value="Lara">Lara</option>
        <option value="Aragua">Aragua</option>
        <option value="Bolívar">Bolívar</option>
        <option value="Anzoátegui">Anzoátegui</option>
        <option value="Falcón">Falcón</option>
      </select>
      <div class="error-message" id="register-state-error">Seleccione un estado.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-city">Ciudad</label>
      <input type="text" class="form-control" id="register-city" placeholder="Ej: Caracas" aria-describedby="register-city-error">
      <div class="error-message" id="register-city-error">Indica tu ciudad.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-bank">Banco para retirar fondos</label>
      <select id="register-bank" class="form-control" aria-describedby="register-bank-error">
        <option value="">Seleccione</option>
        <option value="Banco de Venezuela">Banco de Venezuela</option>
        <option value="Banesco">Banesco</option>
        <option value="Provincial">Banco Provincial</option>
        <option value="Mercantil">Mercantil</option>
        <option value="BNC">BNC</option>
        <option value="Bancamiga">Bancamiga</option>
      </select>
      <div class="error-message" id="register-bank-error">Seleccione un banco.</div>
    </div>
    <div class="wizard-nav">
      <button class="btn btn-outline" id="register-prev-4">Anterior</button>
      <button class="btn btn-primary" id="register-next-4">Siguiente</button>
    </div>
  </div>

  <div class="register-step" id="register-step-4" style="display:none;">
    <p id="greeting-message" style="font-weight:600;margin-bottom:0.5rem;"></p>
    <div class="form-group">
      <label class="form-label" id="birth-label" for="register-birth">¿Cuál es tu fecha de nacimiento?</label>
      <input type="date" class="form-control" id="register-birth" aria-describedby="register-birth-error">
      <div class="error-message" id="register-birth-error">Debes tener al menos 18 años.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-doc-type">Tipo de documento</label>
      <select id="register-doc-type" class="form-control" aria-describedby="register-doc-type-error">
        <option value="">Seleccione</option>
        <option value="CI">Cédula de identidad</option>
        <option value="Pasaporte">Pasaporte</option>
        <option value="Licencia">Licencia de conducir</option>
      </select>
      <div class="error-message" id="register-doc-type-error">Seleccione un tipo de documento.</div>
    </div>
    <div class="form-group">
      <label class="form-label" id="register-doc-label" for="register-id">Número de documento</label>
      <input type="text" class="form-control" id="register-id" aria-describedby="register-id-error">
      <div class="error-message" id="register-id-error">Ingresa el número del documento.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-phone-operator">Operador telefónico</label>
      <select id="register-phone-operator" class="form-control" aria-describedby="register-phone-error">
        <option value="">Seleccione</option>
        <option value="0414">Movistar - 0414</option>
        <option value="0424">Movistar - 0424</option>
        <option value="0412">Digitel - 0412</option>
        <option value="0416">Movilnet - 0416</option>
        <option value="0426">Movilnet - 0426</option>
      </select>
      <div class="error-message" id="register-phone-error">Seleccione el operador.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-phone-number">Número de teléfono (+58)</label>
      <input type="text" class="form-control" id="register-phone-number" maxlength="7" placeholder="1234567" aria-describedby="register-phone-number-error">
      <div class="error-message" id="register-phone-number-error">Ingresa los 7 dígitos.</div>
    </div>
    <div class="wizard-nav">
      <button class="btn btn-outline" id="register-prev-3">Anterior</button>
      <button class="btn btn-primary" id="register-next-3">Siguiente</button>
    </div>
  </div>

  <div class="register-step" id="register-step-5" style="display:none;">
    <div class="form-group">
      <label class="form-label" for="register-email">Correo Electrónico</label>
      <input type="email" class="form-control" id="register-email" placeholder="ejemplo@correo.com" aria-describedby="register-email-error">
      <div class="error-message" id="register-email-error">Correo electrónico inválido.</div>
    </div>
    <div class="form-group password-group">
      <label class="form-label" for="register-password">Contraseña</label>
      <input type="password" class="form-control" id="register-password" aria-describedby="register-password-error">
      <span class="toggle-password" data-target="register-password"><i class="fas fa-eye"></i></span>
      <div class="password-strength" id="password-strength">
        <div class="password-strength-bar" id="password-strength-bar"></div>
      </div>
      <div class="password-strength-text" id="password-strength-text"></div>
      <div class="error-message" id="register-password-error">La contraseña es obligatoria.</div>
    </div>
    <div class="form-group password-group">
      <label class="form-label" for="register-confirm-password">Repetir Contraseña</label>
      <input type="password" class="form-control" id="register-confirm-password" aria-describedby="register-confirm-password-error">
      <span class="toggle-password" data-target="register-confirm-password"><i class="fas fa-eye"></i></span>
      <div class="error-message" id="register-confirm-password-error">Las contraseñas no coinciden.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-sec-question">Pregunta de Seguridad</label>
      <select id="register-sec-question" class="form-control" aria-describedby="register-sec-question-error">
        <option value="">Seleccione una pregunta</option>
        <option value="pet">¿Cómo se llama tu primera mascota?</option>
        <option value="city">¿En qué ciudad naciste?</option>
        <option value="maiden">¿Cuál es el apellido de soltera de tu madre?</option>
        <option value="job">¿Cuál fue tu primer trabajo?</option>
        <option value="food">¿Cuál es tu comida favorita?</option>
      </select>
      <div class="error-message" id="register-sec-question-error">Seleccione una pregunta.</div>
    </div>
    <div class="form-group">
      <label class="form-label" for="register-sec-answer">Respuesta</label>
      <input type="text" class="form-control" id="register-sec-answer" aria-describedby="register-sec-answer-error">
      <div class="error-message" id="register-sec-answer-error">Ingresa la respuesta.</div>
    </div>
    <div class="form-group password-group">
      <label class="form-label" for="register-code">Clave de 20 dígitos</label>
      <input type="password" class="form-control" id="register-code" placeholder="Enviada a tu correo" aria-describedby="register-code-error">
      <span class="toggle-password" data-target="register-code"><i class="fas fa-eye"></i></span>
      <div class="error-message" id="register-code-error">La clave debe tener 20 dígitos.</div>
    </div>
  <div class="wizard-nav">
      <button class="btn btn-outline" id="register-prev-5">Anterior</button>
      <button class="btn btn-primary" id="register-next-5">Siguiente</button>
    </div>
    <div style="text-align: center; margin-top: 1rem;">
      <a href="#" id="show-login">¿Ya tienes cuenta? Inicia Sesión</a>
    </div>
  </div>

  <div class="register-step" id="register-step-6" style="display:none;">
    <h3 style="margin-bottom:0.5rem;">Confirma tus datos</h3>
    <ul id="register-summary" style="font-size:0.9rem;line-height:1.4;margin-bottom:1rem;"></ul>
    <div class="wizard-nav">
      <button class="btn btn-outline" id="register-prev-6">Anterior</button>
      <button class="btn btn-primary" id="register-button"><i class="fas fa-user-plus"></i> Crear Cuenta</button>
    </div>
  </div>

  <div class="register-exit">
    <a href="https://home.remeexvisa.com" class="btn btn-outline" id="register-exit">Salir</a>
  </div>
</div>
  </div>

  <!-- App Header (only visible after login) -->
  <header class="app-header" id="app-header" style="display: none;">
    <div class="header-brand">
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX">
    </div>
    
    <div class="header-actions">
      <div class="users-online-badge">
        <div class="pulse-dot"></div>
        <span id="users-online-count">124 usuarios conectados</span>
      </div>
      
      <button class="header-action-btn" id="notification-btn" aria-label="Notificaciones">
        <i class="fas fa-bell"></i>
        <span class="notification-badge">3</span>
      </button>
    </div>
  </header>

  <!-- Dashboard Container -->
  <div class="app-container" id="dashboard-container" style="display: none;">
    <div class="dashboard-content">
      <!-- Home Section -->
      <div id="home-section">
        <!-- Main Account Card -->
        <div class="balance-card">
          <div class="card-decoration"></div>
          <div class="card-decoration"></div>
          <div class="balance-content">
            <div class="balance-header">
              <div class="balance-label">
                <i class="fas fa-shield-alt"></i>
                <span id="balance-label-name">Saldo Disponible</span>
              </div>
              <div class="header-avatar" id="header-avatar">JP</div>
            </div>
            
            <div class="balance-amount" id="dashboard-balance">
              <img src="https://upload.wikimedia.org/wikipedia/commons/0/06/Flag_of_Venezuela.svg" class="currency-flag" id="main-currency-flag" alt="Bandera de Venezuela">
              <span id="main-currency-symbol">Bs</span>
              <span id="main-balance-value">0,00</span>
            </div>
            
            <div class="balance-equivalents">
              <div class="balance-equivalent">
                <img src="https://flagcdn.com/us.svg" class="currency-flag" alt="Bandera de EEUU">
                <span id="usd-equivalent">≈ $0.00</span>
              </div>
              <div class="balance-equivalent">
                <img src="https://upload.wikimedia.org/wikipedia/commons/b/b7/Flag_of_Europe.svg" class="currency-flag" alt="Bandera de la Unión Europea">
                <span id="eur-equivalent">≈ €0.00</span>
              </div>
            </div>
            
            <div class="exchange-rate" id="exchange-rate">
              <i class="fas fa-exchange-alt"></i> <span id="exchange-rate-display">Tasa: 1 USD = 133.34 Bs | 1 USD = 0.94 EUR</span>
            </div>
            
            <div class="balance-date" id="balance-date">Domingo, 4 de Mayo de 2025</div>
            
            <!-- Pending Transaction Badge (hidden by default) -->
            <div class="pending-transaction-badge" id="pending-transaction-badge" style="display: none;">
              <i class="fas fa-clock"></i>
              <div>
                <div style="font-weight: 600; margin-bottom: 0.125rem;">Transacción pendiente</div>
                <div id="pending-transaction-amount">$0.00 en proceso de verificación</div>
              </div>
            </div>
            
            <div class="balance-actions">
              <button class="balance-btn" id="recharge-btn">
                <i class="fas fa-plus-circle"></i> Recargar Saldo
              </button>
              <button class="balance-btn" id="send-btn">
                <i class="fas fa-upload"></i> Retirar Dinero
              </button>
            </div>
          </div>
        </div>
        
        <!-- Banner de seguridad de dispositivo único -->
        <div class="security-notice-banner" id="security-device-notice">
          <div class="security-notice-icon">
            <i class="fas fa-lock"></i>
          </div>
          <div class="security-notice-content">
            <div class="security-notice-title">Acceso Exclusivo a este Dispositivo</div>
            <div class="security-notice-text">Por su seguridad, su saldo y transacciones solo están disponibles en este dispositivo donde ha iniciado sesión.</div>
          </div>
        </div>
        
        <!-- Verification Banner (if not verified) -->
        <div class="verify-banner" id="dashboard-verify-banner" style="display: none;">
          <div class="verify-icon">
            <i class="fas fa-id-card"></i>
          </div>
          <div class="verify-content">
            <div class="verify-title">Verificación de Identidad Requerida</div>
            <div class="verify-text">Para una mayor seguridad y acceso completo a todas las funciones, verifique su identidad.</div>
          </div>
          <button class="verify-action" id="dashboard-verify-action">Verificar</button>
        </div>

       <!-- NUEVA IMPLEMENTACIÓN: Verification Processing Banner -->
<div class="verification-processing-banner" id="verification-processing-banner">
  <div class="verification-processing-icon" id="verification-processing-icon">
    <i class="fas fa-id-card"></i>
  </div>
  <div class="verification-processing-content">
    <div class="verification-processing-title" id="verification-processing-title">Verificando Documentos</div>
    <div class="verification-processing-text" id="verification-processing-text">Estamos revisando su documentación. Este proceso puede tardar unos minutos.</div>
    
    <!-- Status Items -->
    <div class="verification-status-items" id="verification-status-items" style="display: none;">
      <div class="verification-status-item" id="status-documents">
        <div class="status-icon-container">
          <i class="fas fa-check-circle status-icon success"></i>
        </div>
        <div class="status-text">
          <div class="status-label">Documentos de Identidad</div>
          <div class="status-sublabel">Verificados y aprobados</div>
        </div>
      </div>
      
      <div class="verification-status-item" id="status-bank">
        <div class="status-icon-container">
          <div class="status-spinner"></div>
        </div>
        <div class="status-text">
          <div class="status-label">Debes registrar y validar tu cuenta bancaria para habilitar los retiros</div>
          <div class="status-sublabel">Pendiente de verificación</div>
        </div>
      </div>
    </div>
  </div>
  <div class="verification-processing-spinner" id="main-processing-spinner"></div>
  <a href="https://wa.me/+17373018059" class="verification-support-btn" target="_blank">
    <i class="fab fa-whatsapp"></i> Soporte
  </a>
</div>

        <!-- First Recharge Banner (if no recharges yet) -->
        <div class="first-recharge-banner" id="first-recharge-banner" style="display: none;">
          <div class="first-recharge-icon">
            <i class="fas fa-credit-card"></i>
          </div>
          <div class="first-recharge-content">
            <div class="first-recharge-title">¡Haz tu primera recarga!</div>
            <div class="first-recharge-text">Comienza a utilizar todos los servicios recargando con tarjeta de crédito.</div>
          </div>
          <button class="first-recharge-action" id="first-recharge-action">Recargar</button>
        </div>
        
        <!-- Recent Transactions -->
        <div class="card">
          <div class="section-title" style="margin-bottom: 0.5rem;">
            <i class="fas fa-history"></i> Transacciones Recientes
            <a href="#" id="view-all-transactions">Ver todas</a>
          </div>
          
          <div class="transaction-list" id="recent-transactions">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>
        
        <!-- Contact Section -->
        <div class="card">
          <div class="section-title" style="margin-bottom: 1rem;">
            <i class="fas fa-headset"></i> Soporte y Ayuda
          </div>
          
          <div class="contact-options">
            <a href="https://wa.me/+17373018059" class="contact-option" target="_blank">
              <div class="contact-icon whatsapp">
                <i class="fab fa-whatsapp"></i>
              </div>
              <div class="contact-content">
                <div class="contact-title">WhatsApp</div>
                <div class="contact-description">Atención 24/7 vía chat</div>
              </div>
            </a>
            
            <a href="mailto:contactcenter@visa.com" class="contact-option">
              <div class="contact-icon email">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="contact-content">
                <div class="contact-title">Correo Electrónico</div>
                <div class="contact-description">contactcenter@visa.com</div>
              </div>
            </a>

            <a href="fororemeex.html" class="contact-option">
              <div class="contact-icon chat">
                <i class="fas fa-comments"></i>
              </div>
              <div class="contact-content">
                <div class="contact-title">Chat con Usuarios</div>
                <div class="contact-description">Conéctate con la comunidad</div>
              </div>
            </a>
          
            <a href="opinionesremeex.html" class="contact-option">
              <div class="contact-icon reviews">
                <i class="fas fa-star"></i>
              </div>
              <div class="contact-content">
                <div class="contact-title">Opiniones</div>
                <div class="contact-description">Experiencias de usuarios</div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav" id="bottom-nav" style="display: none;">
    <div class="nav-item" data-section="services">
      <div class="nav-icon"><i class="fas fa-list-alt"></i></div>
      <div class="nav-label">Servicios</div>
    </div>
    
    <div class="nav-item" data-section="cards">
      <div class="nav-icon"><i class="fas fa-credit-card"></i></div>
      <div class="nav-label">Tarjetas</div>
    </div>
    
    <div class="nav-item active" data-section="home">
      <div class="nav-icon"><i class="fas fa-home"></i></div>
      <div class="nav-label">Inicio</div>
    </div>
    
    <div class="nav-item" data-section="messages">
      <div class="nav-icon"><i class="fas fa-envelope"></i></div>
      <div class="nav-label">Mensajes</div>
    </div>

    <div class="nav-item" data-section="support">
      <div class="nav-icon"><i class="fas fa-headset"></i></div>
      <div class="nav-label">Soporte</div>
    </div>

    <div class="nav-item" data-section="settings">
      <div class="nav-icon"><i class="fas fa-cog"></i></div>
      <div class="nav-label">Ajustes</div>
    </div>
  </nav>

  <!-- Support Overlay -->
  <div class="support-overlay" id="support-overlay">
    <div class="support-container">
      <div class="support-header">
        <div class="support-title">Soporte</div>
        <div class="support-close" id="support-close"><i class="fas fa-times"></i></div>
      </div>
      <div class="support-options">
        <a href="https://wa.me/+17373018059" class="support-option" target="_blank">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
        <a href="#" class="support-option" id="support-livechat">
          <i class="fas fa-comments"></i> Chat en vivo
        </a>
        <a href="mailto:contactcenter@visa.com" class="support-option">
          <i class="fas fa-envelope"></i> Email
        </a>
      </div>
    </div>
  </div>

  <!-- Service Overlay -->
  <div class="service-overlay" id="service-overlay">
    <div class="service-container">
      <div class="service-header">
        <div class="service-title">Servicios</div>
        <div class="service-close" id="service-close"><i class="fas fa-times"></i></div>
      </div>
      <div class="service-grid">
        <div class="service-item" id="service-bills">
          <div class="service-icon bills">
            <i class="fas fa-file-invoice"></i>
          </div>
          <div class="service-name">Pago de Servicios</div>
          <div class="service-description">Luz, agua, teléfono</div>
        </div>
        
        <div class="service-item" id="service-dollar">
          <div class="service-icon dollar">
            <i class="fas fa-dollar-sign"></i>
          </div>
          <div class="service-name">Cuenta en Dólares</div>
          <div class="service-description">Apertura inmediata</div>
        </div>
        
        <div class="service-item" id="service-zelle">
          <div class="service-icon zelle">
            <i class="fas fa-university"></i>
          </div>
          <div class="service-name">Activar Zelle</div>
          <div class="service-description">Pagos internacionales</div>
        </div>
        
        <div class="service-item" id="service-exchange">
          <div class="service-icon exchange">
            <i class="fas fa-exchange-alt"></i>
          </div>
          <div class="service-name">Cambio de Divisas</div>
          <div class="service-description">Mejores tasas</div>
        </div>
        
        <div class="service-item" id="service-reviews">
          <div class="service-icon reviews">
            <i class="fas fa-star"></i>
          </div>
          <div class="service-name">Opiniones</div>
          <div class="service-description">Experiencias de usuarios</div>
        </div>
        
        <div class="service-item" id="service-chat">
          <div class="service-icon chat">
            <i class="fas fa-comments"></i>
          </div>
          <div class="service-name">Chat en Vivo</div>
          <div class="service-description">Soporte 24/7</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Cards Overlay -->
  <div class="cards-overlay" id="cards-overlay">
    <div class="card-container">
      <div class="card-header">
        <div class="card-title">Tarjeta Virtual VISA</div>
        <div class="card-close" id="card-close"><i class="fas fa-times"></i></div>
      </div>
      
      <div class="virtual-card">
        <div class="card-logo">
          <img src="https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/chip.png" class="card-chip" alt="Chip de tarjeta">
          <img src="https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/visa.png" class="card-brand" alt="Logo de Visa">
        </div>
        
        <div class="card-number">•••• •••• •••• ••••</div>
        
        <div class="card-details">
          <div style="opacity: 0.7;">Verificación requerida</div>
        </div>
      </div>
      
      <div class="card-apps">
        <div class="card-app"><i class="fab fa-amazon"></i></div>
        <div class="card-app"><i class="fab fa-apple"></i></div>
        <div class="card-app"><i class="fab fa-paypal"></i></div>
        <div class="card-app"><i class="fab fa-spotify"></i></div>
        <div class="card-app"><i class="fab fa-google-play"></i></div>
        <div class="card-app"><i class="fab fa-netflix"></i></div>
      </div>
      
      <div class="card-text">
        Para obtener su tarjeta virtual VISA y poder realizar compras en línea de forma segura, necesita verificar su identidad. Una vez verificado, podrá generar tarjetas virtuales para usar en Amazon, PayPal, Binance, Zinli y otras plataformas.
      </div>
      
      <button class="btn btn-primary" id="verify-for-card">
        <i class="fas fa-id-card"></i> Verificar mi Identidad
      </button>
    </div>
  </div>

  <!-- Messages Overlay -->
  <div class="messages-overlay" id="messages-overlay">
    <div class="messages-container">
      <div class="messages-header">
        <div class="messages-title">Notificaciones</div>
        <div class="messages-close" id="messages-close"><i class="fas fa-times"></i></div>
      </div>
      
      <div class="message-item">
        <div class="message-icon welcome">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="message-content">
          <div class="message-title">Bienvenido a REMEEX</div>
          <div class="message-text">¡Su cuenta ha sido creada con éxito! Comience a disfrutar de nuestros servicios de forma inmediata.</div>
          <div class="message-time">Hoy, 10:30 AM</div>
        </div>
      </div>
      
      <div class="message-item">
        <div class="message-icon security">
          <i class="fas fa-lock"></i>
        </div>
        <div class="message-content">
          <div class="message-title">Acceso exclusivo a este dispositivo</div>
          <div class="message-text">Por su seguridad, su saldo y transacciones solo están disponibles en el dispositivo donde ha iniciado sesión.</div>
          <div class="message-time">Hoy, 10:31 AM</div>
        </div>
      </div>
      
      <div class="message-item">
        <div class="message-icon verify">
          <i class="fas fa-exclamation-circle"></i>
        </div>
        <div class="message-content">
          <div class="message-title">Verificación pendiente</div>
          <div class="message-text">Para desbloquear todas las funcionalidades y aumentar sus límites de transacción, complete la verificación de su identidad.</div>
          <div class="message-time">Hoy, 10:32 AM</div>
        </div>
      </div>
      
      <div class="message-item">
        <div class="message-icon security">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="message-content">
          <div class="message-title">Seguridad de su cuenta</div>
          <div class="message-text">Para mayor seguridad, le recomendamos activar la autenticación de dos factores en su perfil.</div>
          <div class="message-time">Hoy, 10:35 AM</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Overlay -->
  <div class="settings-overlay" id="settings-overlay">
    <div class="settings-container">
      <div class="settings-header">
        <div class="settings-title">Configuración</div>
        <div class="settings-close" id="settings-close"><i class="fas fa-times"></i></div>
      </div>
      
      <div class="card" style="margin-bottom: 1rem;">
        <div class="section-title" style="margin-bottom: 1rem;">
          <i class="fas fa-user"></i> Información de Cuenta
        </div>
        
        <div class="form-group">
          <label class="form-label" for="settings-name">Nombre Completo</label>
          <input type="text" class="form-control" id="settings-name" disabled>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="settings-email">Correo Electrónico</label>
          <input type="email" class="form-control" id="settings-email" disabled>
        </div>
      </div>
      
      <div class="card" style="margin-bottom: 1rem;">
        <div class="section-title" style="margin-bottom: 1rem;">
          <i class="fas fa-bell"></i> Notificaciones
        </div>
        
        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div>Notificaciones por correo</div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
          
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div>Notificaciones por SMS</div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
          
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div>Alertas de seguridad</div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
      </div>
      
      <div class="card" style="margin-bottom: 1rem;">
        <div class="section-title" style="margin-bottom: 1rem;">
          <i class="fas fa-shield-alt"></i> Seguridad
        </div>
        
        <div style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1rem;">
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div>Autenticación de dos factores</div>
            <label class="switch">
              <input type="checkbox">
              <span class="slider round"></span>
            </label>
          </div>
          
          <div style="display: flex; align-items: center; justify-content: space-between;">
            <div>Notificaciones de inicio de sesión</div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <button class="btn btn-primary" id="verify-identity-btn">
          <i class="fas fa-id-card"></i> Verificar mi Identidad
        </button>
      </div>

      <!-- NUEVA IMPLEMENTACIÓN: Botones de Verificación y Activación -->
      <div class="card" style="margin-bottom: 1rem;">
        <div class="section-title" style="margin-bottom: 1rem;">
          <i class="fas fa-cogs"></i> Gestión de Cuenta
        </div>
        
        <div class="settings-buttons">
          <button class="settings-nav-btn" id="verification-nav-btn">
            <div class="settings-nav-icon verification">
              <i class="fas fa-id-card"></i>
            </div>
            <div class="settings-nav-content">
              <div class="settings-nav-title">Verificación</div>
              <div class="settings-nav-description">Verificar identidad y documentos</div>
            </div>
          </button>
          
          <button class="settings-nav-btn" id="activation-nav-btn">
            <div class="settings-nav-icon activation">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="settings-nav-content">
              <div class="settings-nav-title">Activación</div>
              <div class="settings-nav-description">Activar servicios y funciones</div>
            </div>
          </button>
        </div>
      </div>

      <button class="btn btn-primary" id="logout-btn" style="margin-top: 1rem;">
        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
      </button>
    </div>
  </div>

  <!-- Recharge Container -->
  <div class="recharge-container" id="recharge-container">
    <div class="section-title" style="margin-bottom: 1.5rem; display: flex; align-items: center;">
      <i class="fas fa-arrow-left" id="recharge-back" style="cursor: pointer; margin-right: 1rem;"></i>
      <span>Recargar Saldo</span>
    </div>
    
    <div class="security-badge" style="margin-bottom: 1.5rem;">
      <div class="security-badge-icon">
        <i class="fas fa-lock"></i>
      </div>
      <div class="security-badge-content">
        <div class="security-badge-title">Transacción Segura</div>
        <div class="security-badge-text">Todos los pagos están protegidos con cifrado SSL</div>
      </div>
    </div>

    <div class="payment-method-tabs">
      <div class="payment-method-tab active" data-target="card-payment">Tarjeta de Crédito</div>
      <div class="payment-method-tab" data-target="bank-payment">Transferencia Bancaria</div>
      <div class="payment-method-tab" data-target="mobile-payment">Pago Móvil</div>
    </div>

    <!-- Credit Card Payment Method -->
    <div class="payment-method-content active" id="card-payment">
      <div class="card">
        <div style="margin-bottom: 1.25rem; text-align: center;">
          <div style="font-size: 0.8rem; color: var(--neutral-600); margin-bottom: 0.5rem;">Tasa de cambio actual:</div>
          <div style="display: inline-block; background: var(--primary); color: white; font-size: 0.8rem; font-weight: 600; padding: 0.5rem 0.75rem; border-radius: var(--radius-md);">
            <span id="card-exchange-rate-display">1 USD = 133.34 Bs | 1 USD = 0.94 EUR</span>
          </div>
        </div>

        <!-- Saved Card Container (initially hidden) -->
        <div class="saved-card-container" id="saved-card-container">
          <div class="saved-card">
            <div class="saved-card-icon">
              <i class="fab fa-cc-visa"></i>
            </div>
            <div class="saved-card-details">
              <div class="saved-card-number">•••• •••• •••• 3009</div>
              <div class="saved-card-type">VISA</div>
            </div>
            <div class="saved-card-use">
              <input type="checkbox" id="use-saved-card" class="saved-card-checkbox" checked>
              <label for="use-saved-card">Usar esta tarjeta</label>
            </div>
          </div>
          <!-- Botón para pagar directamente con tarjeta guardada -->
          <button class="saved-card-pay-btn" id="saved-card-pay-btn" disabled>
            <i class="fas fa-credit-card"></i> Seleccione un monto
          </button>
        </div>
        
        <div class="section-title" style="margin-bottom: 0.5rem; font-size: 0.9rem;">
          <i class="fas fa-money-bill"></i> Seleccione un Monto
        </div>
        
        <select class="amount-select" id="card-amount-select">
          <option value="" selected disabled>-- Seleccione un monto --</option>
          <option value="500" data-bs="66670" data-eur="470">$500 ≈ Bs 66.670,00 ≈ €470,00</option>
          <option value="1000" data-bs="133340" data-eur="940">$1.000 ≈ Bs 133.340,00 ≈ €940,00</option>
          <option value="1500" data-bs="200010" data-eur="1410">$1.500 ≈ Bs 200.010,00 ≈ €1.410,00</option>
          <option value="2000" data-bs="266680" data-eur="1880">$2.000 ≈ Bs 266.680,00 ≈ €1.880,00</option>
          <option value="3000" data-bs="400020" data-eur="2820">$3.000 ≈ Bs 400.020,00 ≈ €2.820,00</option>
          <option value="4000" data-bs="533360" data-eur="3760">$4.000 ≈ Bs 533.360,00 ≈ €3.760,00</option>
          <option value="5000" data-bs="666700" data-eur="4700">$5.000 ≈ Bs 666.700,00 ≈ €4.700,00</option>
          <option value="6000" data-bs="800040" data-eur="5640">$6.000 ≈ Bs 800.040,00 ≈ €5.640,00</option>
          <option value="7000" data-bs="933380" data-eur="6580">$7.000 ≈ Bs 933.380,00 ≈ €6.580,00</option>
          <option value="8000" data-bs="1066720" data-eur="7520">$8.000 ≈ Bs 1.066.720,00 ≈ €7.520,00</option>
        </select>
      </div>
      
      <div class="card" id="card-form-container" style="margin-top: 1.5rem;">
        <div class="section-title" style="margin-bottom: 1rem;">
          <i class="fas fa-credit-card"></i> Detalles de la Tarjeta
        </div>
        
        <div class="card-preview" id="card-preview">
          <div class="card-inner">
            <div class="card-front">
              <div class="card-logo">
                <img src="https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/chip.png" class="card-chip" alt="Chip de tarjeta">
                <img id="card-brand-logo" src="https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/visa.png" class="card-brand" alt="Logo de Visa">
              </div>
              
              <div class="card-number" id="card-number-display">•••• •••• •••• ••••</div>
              
              <div class="card-details">
                <div class="card-holder">
                  <div style="opacity: 0.7; font-size: 0.7rem; margin-bottom: 4px;">Titular</div>
                  <div id="card-holder-display">••••••• •••••••</div>
                </div>
                
                <div class="card-expiry">
                  <div style="text-align: right;">
                    <div style="opacity: 0.7; font-size: 0.7rem; margin-bottom: 4px;">Expira</div>
                    <div><span id="card-month-display">••</span>/<span id="card-year-display">••</span></div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card-back">
              <div class="card-stripe"></div>
              <div style="padding: 0 1.25rem;">
                <div style="font-size: 0.7rem; margin-bottom: 0.5rem;">CVV</div>
                <div class="card-cvv" id="card-cvv-display">•••</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="card-form">
          <div class="form-group">
            <label class="form-label" for="cardName">Titular de la Tarjeta</label>
            <input type="text" class="form-control" id="cardName" placeholder="Nombre como aparece en la tarjeta" aria-describedby="card-name-error">
            <div class="error-message" id="card-name-error">Por favor, introduce el nombre del titular.</div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="cardNumber">Número de Tarjeta</label>
            <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" aria-describedby="card-number-error">
            <div class="error-message" id="card-number-error">Número de tarjeta no válido.</div>
          </div>
          
          <div class="card-row">
            <div class="card-col">
              <label class="form-label">Fecha de Expiración</label>
              <div style="display: flex; gap: 0.5rem;">
                <select class="form-control" id="cardMonth" aria-describedby="card-date-error">
                  <option value="" disabled selected>Mes</option>
                  <option value="01">01</option>
                  <option value="02">02</option>
                  <option value="03">03</option>
                  <option value="04">04</option>
                  <option value="05">05</option>
                  <option value="06">06</option>
                  <option value="07">07</option>
                  <option value="08">08</option>
                  <option value="09">09</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select>
                
                <select class="form-control" id="cardYear" aria-describedby="card-date-error">
                  <option value="" disabled selected>Año</option>
                  <option value="2025">2025</option>
                  <option value="2026">2026</option>
                  <option value="2027">2027</option>
                  <option value="2028">2028</option>
                  <option value="2029">2029</option>
                  <option value="2030">2030</option>
                </select>
              </div>
              <div class="error-message" id="card-date-error">Por favor, selecciona una fecha válida.</div>
            </div>
            
            <div class="card-col" style="max-width: 120px;">
              <label class="form-label" for="cardCvv">CVV</label>
              <input type="password" class="form-control" id="cardCvv" placeholder="•••" maxlength="3" aria-describedby="card-cvv-error">
              <div class="error-message" id="card-cvv-error">CVV inválido.</div>
            </div>
          </div>
          
          <div style="display: flex; align-items: center; margin-top: 1rem;">
            <input type="checkbox" id="save-card" style="margin-right: 0.5rem;">
            <label for="save-card" style="font-size: 0.85rem; color: var(--neutral-700);">Guardar esta tarjeta para futuras recargas</label>
          </div>
          
          <button class="btn btn-primary" id="submit-payment" disabled style="margin-top: 1.5rem;">
            <i class="fas fa-credit-card"></i> Seleccione un monto
          </button>
        </div>
      </div>
    </div>

    <!-- Bank Transfer Payment Method -->
    <div class="payment-method-content" id="bank-payment">
      <div class="card">
        <div style="margin-bottom: 1.25rem; text-align: center;">
          <div style="font-size: 0.8rem; color: var(--neutral-600); margin-bottom: 0.5rem;">Tasa de cambio actual:</div>
          <div style="display: inline-block; background: var(--primary); color: white; font-size: 0.8rem; font-weight: 600; padding: 0.5rem 0.75rem; border-radius: var(--radius-md);">
            <span id="bank-exchange-rate-display">1 USD = 133.34 Bs | 1 USD = 0.94 EUR</span>
          </div>
        </div>
        
        <div class="section-title" style="margin-bottom: 0.5rem;">
          <i class="fas fa-money-bill"></i> Seleccione un Monto
        </div>
        
        <select class="amount-select" id="bank-amount-select">
          <option value="" selected disabled>-- Seleccione un monto --</option>
          <option value="25" data-bs="3334" data-eur="23.5">$25 ≈ Bs 3.334,00 ≈ €23,50</option>
          <option value="30" data-bs="4000" data-eur="28.2">$30 ≈ Bs 4.000,00 ≈ €28,20</option>
          <option value="40" data-bs="5334" data-eur="37.6">$40 ≈ Bs 5.334,00 ≈ €37,60</option>
          <option value="50" data-bs="6667" data-eur="47">$50 ≈ Bs 6.667,00 ≈ €47,00</option>
          <option value="100" data-bs="13334" data-eur="94">$100 ≈ Bs 13.334,00 ≈ €94,00</option>
          <option value="200" data-bs="26668" data-eur="188">$200 ≈ Bs 26.668,00 ≈ €188,00</option>
          <option value="250" data-bs="33335" data-eur="235">$250 ≈ Bs 33.335,00 ≈ €235,00</option>
          <option value="400" data-bs="53336" data-eur="376">$400 ≈ Bs 53.336,00 ≈ €376,00</option>
          <option value="500" data-bs="66670" data-eur="470">$500 ≈ Bs 66.670,00 ≈ €470,00</option>
        </select>
        
        <div class="section-title" style="margin-top: 1.5rem; margin-bottom: 1rem;">
          <i class="fas fa-university"></i> Datos Bancarios
        </div>
        
        <div class="bank-details">
          <div class="bank-detail-row">
            <div class="bank-detail-label">Banco:</div>
            <div class="bank-detail-value">
              Banco Venezolano de Crédito
              <div class="copy-btn" data-copy="Banco Venezolano de Crédito"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">Titular:</div>
            <div class="bank-detail-value">
              Global VISA Venezuela
              <div class="copy-btn" data-copy="Global VISA Venezuela"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">RIF:</div>
            <div class="bank-detail-value">
              J407502646
              <div class="copy-btn" data-copy="J407502646"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">Cuenta Corriente:</div>
            <div class="bank-detail-value">
              Disponible al activar su cuenta
              <div class="copy-btn" data-copy="No disponible"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">Concepto:</div>
            <div class="bank-detail-value">
              4454651
              <div class="copy-btn" data-copy="4454651"><i class="far fa-copy"></i></div>
            </div>
          </div>
        </div>
        
        <div class="bank-warning">
          <div class="bank-warning-title">
            <i class="fas fa-exclamation-triangle"></i> Importante
          </div>
          <div class="bank-warning-content">
            Asegúrese de realizar la transferencia <strong>únicamente</strong> al Banco Venezolano de Crédito. No confundir con Banco Nacional de Crédito ni Banco de Venezuela. Una vez realizada la transferencia, complete el formulario a continuación.
          </div>
        </div>
        
        <div class="section-title" style="margin-top: 1.5rem; margin-bottom: 1rem;">
          <i class="fas fa-upload"></i> Comprobante de Pago
        </div>
        
        <div class="receipt-upload" id="receipt-upload">
          <i class="fas fa-cloud-upload-alt"></i>
          <div class="receipt-upload-title">Subir Comprobante</div>
          <div class="receipt-upload-subtitle">Haga clic aquí para cargar su comprobante de pago<br>Formatos aceptados: JPG, PNG, PDF (máx. 5MB)</div>
          <input type="file" id="receipt-file" accept="image/jpeg,image/png,application/pdf" style="display: none;">
        </div>
        
        <div class="receipt-preview" id="receipt-preview">
          <div class="receipt-preview-container">
            <div class="receipt-preview-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <div class="receipt-preview-content">
              <div class="receipt-preview-name" id="receipt-filename">comprobante.jpg</div>
              <div class="receipt-preview-size" id="receipt-filesize">120 KB</div>
            </div>
            <div class="receipt-preview-actions">
              <div class="copy-btn" id="receipt-remove"><i class="fas fa-trash"></i></div>
            </div>
          </div>
        </div>
        
        <div class="form-group reference-number">
          <label class="form-label" for="reference-number">Número de Referencia</label>
          <input type="text" class="form-control" id="reference-number" placeholder="Ingrese el número de referencia de la transferencia" aria-describedby="reference-error">
          <div class="error-message" id="reference-error">Por favor, ingrese un número de referencia válido.</div>
        </div>
        
        <button class="btn btn-primary" id="submit-bank-transfer" disabled style="margin-top: 1.5rem;">
          <i class="fas fa-paper-plane"></i> Seleccione un monto
        </button>
      </div>
    </div>

    <!-- Mobile Payment Method -->
    <div class="payment-method-content" id="mobile-payment">
      <div class="card">
        <div style="margin-bottom: 1.25rem; text-align: center;">
          <div style="font-size: 0.8rem; color: var(--neutral-600); margin-bottom: 0.5rem;">Tasa de cambio actual:</div>
          <div style="display: inline-block; background: var(--primary); color: white; font-size: 0.8rem; font-weight: 600; padding: 0.5rem 0.75rem; border-radius: var(--radius-md);">
            <span id="mobile-exchange-rate-display">1 USD = 133.34 Bs | 1 USD = 0.94 EUR</span>
          </div>
        </div>
        
        <!-- Mensaje de éxito para datos personalizados de pago móvil -->
        <div class="mobile-payment-success" id="mobile-payment-success" style="display: flex; align-items: flex-start; gap: 0.8rem;">
          <div class="mobile-payment-success-icon">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="mobile-payment-success-content">
            <div class="mobile-payment-success-title">¡Felicidades! Tus datos para recargar tu cuenta de Remeex VISA.</div>
            <div class="mobile-payment-success-text">Haz tu primera recarga por 25 USD para culminar tu verificación! Ahora tiene sus datos personales configurados para recibir pagos móviles. Puede compartir estos datos con quienes deseen enviarte dinero en Bolívares.</div>
          </div>
        </div>
        
        <div class="section-title" style="margin-bottom: 0.5rem;">
          <i class="fas fa-money-bill"></i> Seleccione un Monto
        </div>
        
        <select class="amount-select" id="mobile-amount-select">
          <option value="" selected disabled>-- Seleccione un monto --</option>
          <option value="25" data-bs="3334" data-eur="23.5">$25 ≈ Bs 3.334,00 ≈ €23,50</option>
          <option value="30" data-bs="4000" data-eur="28.2">$30 ≈ Bs 4.000,00 ≈ €28,20</option>
          <option value="40" data-bs="5334" data-eur="37.6">$40 ≈ Bs 5.334,00 ≈ €37,60</option>
          <option value="50" data-bs="6667" data-eur="47">$50 ≈ Bs 6.667,00 ≈ €47,00</option>
          <option value="100" data-bs="13334" data-eur="94">$100 ≈ Bs 13.334,00 ≈ €94,00</option>
          <option value="200" data-bs="26668" data-eur="188">$200 ≈ Bs 26.668,00 ≈ €188,00</option>
          <option value="250" data-bs="33335" data-eur="235">$250 ≈ Bs 33.335,00 ≈ €235,00</option>
          <option value="400" data-bs="53336" data-eur="376">$400 ≈ Bs 53.336,00 ≈ €376,00</option>
          <option value="500" data-bs="66670" data-eur="470">$500 ≈ Bs 66.670,00 ≈ €470,00</option>
        </select>
        
        <div class="section-title" style="margin-top: 1.5rem; margin-bottom: 1rem;">
          <i class="fas fa-mobile-alt"></i> Datos de Pago Móvil (Acreditación Inmediata)
        </div>
        
        <div class="bank-details">
          <div class="bank-detail-row">
            <div class="bank-detail-label">Banco:</div>
            <div class="bank-detail-value">
              Banco Venezolano de Crédito (0104)
              <div class="copy-btn" data-copy="Banco Venezolano de Crédito (0104)"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">Titular:</div>
            <div class="bank-detail-value" id="mobile-payment-name">
              <span id="mobile-payment-name-value">Verificación Pendiente</span>
              <div class="copy-btn" data-copy="Verificación Pendiente"><i class="far fa-copy"></i></div>
            </div>
          </div>

          <div class="bank-detail-row">
            <div class="bank-detail-label">RIF/Cédula:</div>
            <div class="bank-detail-value" id="mobile-payment-rif">
              <span id="mobile-payment-rif-value">Verificación Pendiente</span>
              <div class="copy-btn" data-copy="Verificación Pendiente"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">Teléfono:</div>
            <div class="bank-detail-value" id="mobile-payment-phone">
              <span id="mobile-payment-phone-value">Verificación Pendiente</span>
              <div class="copy-btn" data-copy="Verificación Pendiente"><i class="far fa-copy"></i></div>
            </div>
          </div>
          
          <div class="bank-detail-row">
            <div class="bank-detail-label">Concepto:</div>
            <div class="bank-detail-value">
              4454651
              <div class="copy-btn" data-copy="4454651"><i class="far fa-copy"></i></div>
            </div>
          </div>
        </div>
        
        <!-- Contenedor para el mensaje de soporte que aparecerá después de 5 minutos -->
        <div class="support-needed-container" id="support-needed-container">
          <div class="support-needed-header">
            <div class="support-needed-icon">
              <i class="fas fa-headset"></i>
            </div>
            <div>
              <div class="support-needed-title">Soporte adicional requerido</div>
              <div class="support-needed-subtitle">Para completar esta transacción</div>
            </div>
          </div>
          <div class="support-needed-content">
            Para validar este pago móvil necesitamos confirmar algunos datos de seguridad adicionales. Nuestro equipo está disponible 24/7 para asistirle y procesar su solicitud en menos de 5 minutos.
          </div>
          <a href="https://wa.me/+17373018059" class="whatsapp-support-btn" target="_blank">
            <i class="fab fa-whatsapp"></i> Contactar Soporte por WhatsApp
          </a>
        </div>
        
        <div class="bank-warning">
          <div class="bank-warning-title">
            <i class="fas fa-exclamation-triangle"></i> Importante
          </div>
          <div class="bank-warning-content">
            Asegúrese de realizar el pago móvil a través del <strong>Banco Venezolano de Crédito (0104)</strong> y no a otro banco. Una vez realizado el pago, complete el formulario a continuación.
          </div>
        </div>
        
        <div class="section-title" style="margin-top: 1.5rem; margin-bottom: 1rem;">
          <i class="fas fa-upload"></i> Comprobante de Pago
        </div>
        
        <div class="receipt-upload" id="mobile-receipt-upload">
          <i class="fas fa-cloud-upload-alt"></i>
          <div class="receipt-upload-title">Subir Comprobante</div>
          <div class="receipt-upload-subtitle">Haga clic aquí para cargar una captura de su pago móvil<br>Formatos aceptados: JPG, PNG, PDF (máx. 5MB)</div>
          <input type="file" id="mobile-receipt-file" accept="image/jpeg,image/png,application/pdf" style="display: none;">
        </div>
        
        <div class="receipt-preview" id="mobile-receipt-preview">
          <div class="receipt-preview-container">
            <div class="receipt-preview-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <div class="receipt-preview-content">
              <div class="receipt-preview-name" id="mobile-receipt-filename">comprobante.jpg</div>
              <div class="receipt-preview-size" id="mobile-receipt-filesize">120 KB</div>
            </div>
            <div class="receipt-preview-actions">
              <div class="copy-btn" id="mobile-receipt-remove"><i class="fas fa-trash"></i></div>
            </div>
          </div>
        </div>
        
        <div class="form-group reference-number">
          <label class="form-label" for="mobile-reference-number">Número de Referencia</label>
          <input type="text" class="form-control" id="mobile-reference-number" placeholder="Ingrese el número de referencia del pago móvil" aria-describedby="mobile-reference-error">
          <div class="error-message" id="mobile-reference-error">Por favor, ingrese un número de referencia válido.</div>
        </div>
        
        <button class="btn btn-primary" id="submit-mobile-payment" disabled style="margin-top: 1.5rem;">
          <i class="fas fa-paper-plane"></i> Seleccione un monto
        </button>
      </div>
    </div>
  </div>

  <!-- Transfer Container (iframe embed) -->
  <div class="transfer-container" id="transfer-container">
    <div class="section-title" style="margin-bottom: 1.5rem; display: flex; align-items: center;">
      <i class="fas fa-arrow-left" id="transfer-back" style="cursor: pointer; margin-right: 1rem;"></i>
      <span>Retiro de Fondos</span>
    </div>
    <iframe id="transfer-frame"></iframe>
<template id="transfer-template" style="display:none;">
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>REMEEX - Retiro de Fondos</title>
  <link rel="icon" href="https://w7.pngwing.com/pngs/400/28/png-transparent-credit-card-computer-icons-visa-electron-bank-curio-blue-text-rectangle-thumbnail.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/v-mask@2.3.0/dist/v-mask.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.4/dist/gsap.min.js"></script>

  <style>
    :root {
      /* Paleta de colores moderna basada en estilo Revolut/N26 */
      --primary: #1a1f71;
      --primary-dark: #0c1045;
      --primary-light: #3244b6;
      --secondary: #00579f;
      --accent: #f7b600;
      --success: #00d34d;
      --danger: #ff4d4d;
      --warning: #ffad33;
      --info: #0095ff;
      --neutral-100: #ffffff;
      --neutral-200: #f5f7fa;
      --neutral-300: #eaecf0;
      --neutral-400: #d0d5dd;
      --neutral-500: #9da4b4;
      --neutral-600: #6e7891;
      --neutral-700: #4f5d75;
      --neutral-800: #293249;
      --neutral-900: #1a1f37;

      /* Sombras y efectos */
      --shadow-sm: 0 1px 3px rgba(16, 24, 40, 0.1);
      --shadow-md: 0 4px 8px -2px rgba(16, 24, 40, 0.1), 0 2px 4px -2px rgba(16, 24, 40, 0.06);
      --shadow-lg: 0 12px 16px -4px rgba(16, 24, 40, 0.08), 0 4px 6px -2px rgba(16, 24, 40, 0.03);
      --shadow-xl: 0 20px 24px -4px rgba(16, 24, 40, 0.08), 0 8px 8px -4px rgba(16, 24, 40, 0.03);
      
      /* Border radius */
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      
      /* Transiciones */
      --transition-fast: all 0.2s ease;
      --transition-base: all 0.3s ease;
      --transition-slow: all 0.5s ease;
      
      /* Gradientes de tarjeta */
      --card-gradient: linear-gradient(135deg, #1a1f71 0%, #0c1045 100%);
      --success-gradient: linear-gradient(135deg, #00c057 0%, #00a346 100%);
      
      /* Animaciones */
      --animation-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--neutral-200);
      color: var(--neutral-900);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      height: 100vh;
      margin: 0;
      position: relative;
    }
    
    /* Scrollbars */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--neutral-200);
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--neutral-500);
      border-radius: var(--radius-full);
    }
    
    /* Header */
    .app-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.6rem 1rem;
      background: var(--neutral-100);
      border-bottom: 1px solid var(--neutral-300);
      box-shadow: var(--shadow-sm);
      z-index: 1000;
      height: 60px;
    }
    
    .header-brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .header-brand img {
      height: 32px;
      width: auto;
    }
    
    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .header-action-btn {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--neutral-200);
      color: var(--neutral-700);
      border: none;
      cursor: pointer;
      transition: var(--transition-base);
      position: relative;
    }
    
    .header-action-btn:hover {
      background: var(--neutral-300);
      color: var(--neutral-900);
    }
    
    .notification-badge {
      position: absolute;
      top: -2px;
      right: -2px;
      background: var(--danger);
      color: white;
      border-radius: var(--radius-full);
      font-size: 0.6rem;
      width: 16px;
      height: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }
    
    /* Badge de usuarios conectados */
    .users-online-badge {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.25rem 0.5rem;
      background: rgba(26, 31, 113, 0.08);
      border-radius: var(--radius-md);
      font-size: 0.7rem;
      color: var(--primary);
      font-weight: 500;
      white-space: nowrap;
    }
    
    .users-online-badge i {
      font-size: 0.7rem;
    }
    
    .pulse-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--success);
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(0, 211, 77, 0.7);
      }
      
      70% {
        transform: scale(1);
        box-shadow: 0 0 0 4px rgba(0, 211, 77, 0);
      }
      
      100% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(0, 211, 77, 0);
      }
    }
    
    /* Tarjeta de saldo */
    .balance-card {
      background: var(--card-gradient);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      color: white;
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
      margin-bottom: 1.25rem;
      transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
    }
    
    .balance-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-xl);
    }
    
    .balance-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      animation: shine 3s infinite;
    }
    
    @keyframes shine {
      100% { left: 200%; }
    }
    
    .card-decoration {
      position: absolute;
      right: -50px;
      bottom: -50px;
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      z-index: 1;
    }
    
    .card-decoration:nth-child(2) {
      left: -30px;
      top: -30px;
      width: 150px;
      height: 150px;
    }
    
    .balance-content {
      position: relative;
      z-index: 2;
    }
    
    .balance-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    
    .balance-label {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 0.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .balance-label i {
      font-size: 0.9rem;
    }
    
    .balance-amount {
      font-size: clamp(1.5rem, 5vw, 2.25rem);
      font-weight: 700;
      margin: 0.5rem 0 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: nowrap;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .currency-flag {
      width: 20px;
      height: 14px;
      border-radius: 2px;
      object-fit: cover;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      flex-shrink: 0;
    }
    
    .balance-equivalents {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }
    
    .balance-equivalent {
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-md);
      padding: 0.4rem 0.6rem;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      white-space: nowrap;
    }
    
    .exchange-rate {
      background: rgba(255, 255, 255, 0.15);
      border-radius: var(--radius-md);
      padding: 0.4rem 0.6rem;
      font-size: 0.75rem;
      margin-bottom: 0.75rem;
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }
    
    .balance-date {
      font-size: 0.7rem;
      opacity: 0.7;
      margin-bottom: 1rem;
    }
    
    .balance-actions {
      display: flex;
      gap: 0.75rem;
      margin-top: 0.75rem;
    }
    
    .balance-btn {
      flex: 1;
      border: none;
      border-radius: var(--radius-md);
      height: 42px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.8rem;
      background: rgba(255,255,255,0.15);
      color: white;
      cursor: pointer;
      transition: all 0.3s var(--animation-bounce);
      backdrop-filter: blur(5px);
      white-space: nowrap;
    }
    
    .balance-btn:hover {
      background: rgba(255,255,255,0.25);
      transform: translateY(-3px);
    }
    
    .balance-btn:active {
      transform: translateY(0);
    }
    
    .balance-btn i {
      margin-right: 6px;
      font-size: 0.9rem;
    }
    
    /* Layout del Dashboard */
    .app-container {
      padding-top: 70px;
      padding-bottom: 70px;
      max-width: 100%;
      margin: 0 auto;
      height: 100vh;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
    }
    
    .dashboard-content {
      padding: 0.75rem;
      max-width: 1200px;
      margin: 0 auto;
    }
   
    /* Secciones */
    .section-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--neutral-900);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .section-title i {
      margin-right: 0.5rem;
      color: var(--primary);
    }
    
    .section-title a {
      font-size: 0.7rem;
      color: var(--primary);
      text-decoration: none;
    }
    
    /* Tarjetas */
    .card {
      background: var(--neutral-100);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      padding: 1rem;
      margin-bottom: 1.25rem;
      transition: transform 0.3s var(--animation-bounce), box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    /* Navegación Inferior */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--neutral-100);
      display: flex;
      justify-content: space-around;
      padding: 0.5rem 0;
      box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
      z-index: 900;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.25rem;
      padding: 0.4rem;
      border-radius: var(--radius-md);
      transition: var(--transition-base);
      cursor: pointer;
      flex: 1;
      text-decoration: none;
      color: var(--neutral-600);
    }
    
    .nav-item.active {
      color: var(--primary);
    }
    
    .nav-icon {
      font-size: 1.1rem;
      transition: transform 0.3s var(--animation-bounce);
    }
    
    .nav-item:hover .nav-icon {
      transform: translateY(-3px);
    }
    
    .nav-label {
      font-size: 0.6rem;
      font-weight: 600;
    }

    /* Contenedor de Retiro */
    .withdrawal-container {
      padding: 1rem;
      padding-top: 70px;
      padding-bottom: 70px;
      max-width: 800px;
      margin: 0 auto;
    }
    
    /* Timeline */
    .timeline-container {
      position: relative;
      margin: 1.5rem 0;
      padding: 0 1rem;
    }
    
    .timeline {
      display: flex;
      justify-content: space-between;
      position: relative;
      margin-bottom: 2rem;
    }
    
    .timeline::before {
      content: '';
      position: absolute;
      top: 1.25rem;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--neutral-400);
      z-index: 1;
    }
    
    .timeline-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 2;
      width: 25%;
    }
    
    .timeline-icon {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: var(--radius-full);
      background: var(--neutral-300);
      color: var(--neutral-600);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      margin-bottom: 0.5rem;
      box-shadow: var(--shadow-sm);
    }
    
    .timeline-step.active .timeline-icon {
      background: var(--primary);
      color: white;
    }
    
    .timeline-step.completed .timeline-icon {
      background: var(--success);
      color: white;
    }
    
    .timeline-label {
      font-size: 0.7rem;
      text-align: center;
      color: var(--neutral-600);
      max-width: 80px;
      line-height: 1.2;
    }
    
    .timeline-step.active .timeline-label {
      color: var(--primary);
      font-weight: 600;
    }
    
    .timeline-step.completed .timeline-label {
      color: var(--success);
      font-weight: 600;
    }
    
    /* Progreso entre pasos de timeline */
    .timeline-progress {
      position: absolute;
      top: 1.25rem;
      left: 0;
      height: 3px;
      background: var(--success);
      z-index: 1;
      transition: width 0.5s ease;
    }
    
    /* Estilos de Formulario */
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-label {
      display: block;
      font-size: 0.8rem;
      font-weight: 500;
      color: var(--neutral-700);
      margin-bottom: 0.5rem;
    }
    
    .form-control {
      width: 100%;
      height: 48px;
      padding: 0 1rem;
      border: 1px solid var(--neutral-400);
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      color: var(--neutral-900);
      background: var(--neutral-100);
      transition: var(--transition-base);
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15);
    }
    
    .error-message {
      font-size: 0.7rem;
      color: var(--danger);
      margin-top: 0.5rem;
      display: none;
    }
    
    /* Etiqueta de ayuda */
    .help-text {
      font-size: 0.7rem;
      color: var(--neutral-600);
      margin-top: 0.5rem;
    }
    
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 48px;
      padding: 0 1.5rem;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 0.9rem;
      border: none;
      cursor: pointer;
      transition: all 0.3s var(--animation-bounce);
    }
    
    .btn-primary {
      background: var(--primary);
      color: white;
      width: 100%;
    }
    
    .btn-primary:hover {
      background: var(--primary-light);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .btn-outline {
      background: transparent;
      border: 1px solid var(--primary);
      color: var(--primary);
    }
    
    .btn-outline:hover {
      background: rgba(26, 31, 113, 0.05);
      transform: translateY(-3px);
    }
    
    .btn:disabled {
      background: var(--neutral-400);
      color: var(--neutral-600);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .btn i {
      margin-right: 0.5rem;
      font-size: 0.9rem;
    }
    
    /* Métodos de Pago */
    .method-options {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .method-option {
      flex: 1;
      min-width: 100px;
      background: var(--neutral-200);
      border: 2px solid var(--neutral-300);
      border-radius: var(--radius-md);
      padding: 1rem;
      cursor: pointer;
      transition: var(--transition-base);
      text-align: center;
    }
    
    .method-option:hover {
      background: var(--neutral-100);
      border-color: var(--neutral-400);
      transform: translateY(-3px);
      box-shadow: var(--shadow-sm);
    }
    
    .method-option.active {
      background: var(--neutral-100);
      border-color: var(--primary);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .method-icon {
      font-size: 1.5rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    
    .method-label {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--neutral-800);
    }
    
    .method-description {
      font-size: 0.7rem;
      color: var(--neutral-600);
      margin-top: 0.25rem;
    }
    
    /* Selección de Banco */
    .bank-selection {
      display: none;
      margin-top: 1.5rem;
    }
    
    .bank-selection.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    /* Nueva grilla de logos de bancos */
    .bank-logo-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-top: 1rem;
    }
    
    @media (max-width: 768px) {
      .bank-logo-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    @media (max-width: 480px) {
      .bank-logo-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    
    .bank-logo-item {
      background: var(--neutral-200);
      border: 2px solid var(--neutral-300);
      border-radius: var(--radius-md);
      padding: 1rem 0.75rem;
      cursor: pointer;
      transition: var(--transition-base);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    
    .bank-logo-item:hover {
      background: var(--neutral-100);
      border-color: var(--neutral-400);
      transform: translateY(-3px);
      box-shadow: var(--shadow-sm);
    }
    
    .bank-logo-item.active {
      background: var(--neutral-100);
      border-color: var(--primary);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .bank-logo-container {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.5rem;
    }
    
    .bank-logo {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    .bank-name {
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--neutral-800);
      margin-top: 0.5rem;
    }
    
    /* Detalles de la Cuenta */
    .account-details {
      margin-top: 1.5rem;
      display: none;
    }
    
    .account-details.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    /* Badge de Seguridad */
    .security-badge {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: rgba(26, 31, 113, 0.05);
      border-radius: var(--radius-md);
      padding: 0.75rem;
      margin-bottom: 1.25rem;
    }
    
    .security-badge-icon {
      width: 30px;
      height: 30px;
      background: var(--primary);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.9rem;
      flex-shrink: 0;
    }
    
    .security-badge-content {
      flex: 1;
      min-width: 0;
    }
    
    .security-badge-title {
      font-weight: 600;
      font-size: 0.8rem;
      color: var(--neutral-900);
      margin-bottom: 0.125rem;
    }
    
    .security-badge-text {
      font-size: 0.7rem;
      color: var(--neutral-600);
      white-space: normal;
    }
    
    /* Banner de Verificación Mejorado */
    .verify-banner {
      background: linear-gradient(135deg, var(--info) 0%, #0077cc 100%);
      border-radius: var(--radius-md);
      padding: 1rem;
      display: flex;
      align-items: flex-start;
      gap: 0.8rem;
      margin: 1.25rem 0;
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
    }
    
    .verify-banner::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      pointer-events: none;
    }
    
    .verify-icon {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--info);
      font-size: 1.1rem;
      flex-shrink: 0;
      box-shadow: var(--shadow-md);
    }
    
    .verify-content {
      flex: 1;
      min-width: 0;
    }
    
    .verify-title {
      font-weight: 600;
      color: white;
      margin-bottom: 0.25rem;
      font-size: 1rem;
    }
    
    .verify-text {
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.85rem;
      margin-bottom: 0.5rem;
    }
    
    .verify-benefits {
      margin-top: 0.75rem;
    }
    
    .verify-benefit-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.3rem;
      color: white;
      font-size: 0.8rem;
    }
    
    .verify-benefit-item i {
      color: #f7b600;
      font-size: 0.9rem;
    }
    
    .verify-action {
      background: white;
      color: var(--info);
      font-weight: 600;
      font-size: 0.8rem;
      padding: 0.5rem 1rem;
      border-radius: var(--radius-md);
      flex-shrink: 0;
      transition: all 0.3s var(--animation-bounce);
      cursor: pointer;
      border: none;
      white-space: nowrap;
      box-shadow: var(--shadow-md);
      margin-top: 0.75rem;
    }
    
    .verify-action:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
      background: #f8f9fa;
    }

    /* Detalles del Banco */
    .bank-details {
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 1.1rem;
      margin: 1.25rem 0;
    }
    
    .bank-detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--neutral-300);
    }
    
    .bank-detail-row:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    
    .bank-detail-label {
      font-size: 0.8rem;
      color: var(--neutral-600);
      flex-shrink: 0;
      margin-right: 0.5rem;
    }
    
    .bank-detail-value {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--neutral-900);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-align: right;
      word-break: break-word;
      flex-grow: 1;
    }
    
    .copy-btn {
      background: var(--neutral-300);
      color: var(--neutral-700);
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-full);
      cursor: pointer;
      transition: var(--transition-base);
      flex-shrink: 0;
    }
    
    .copy-btn:hover {
      background: var(--primary);
      color: white;
    }
    
    /* Notificaciones Toast */
    .toast-container {
      position: fixed;
      top: 70px;
      right: 16px;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .toast {
      background: var(--neutral-900);
      color: white;
      border-radius: var(--radius-md);
      padding: 0.75rem 1rem;
      min-width: 250px;
      max-width: 320px;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      animation: slideInRight 0.3s ease, fadeOut 0.3s ease 3s forwards;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--danger);
    }
    
    .toast.warning {
      border-left: 4px solid var(--warning);
    }
    
    .toast.info {
      border-left: 4px solid var(--info);
    }
    
    .toast-icon {
      flex-shrink: 0;
    }
    
    .toast-content {
      flex: 1;
      min-width: 0;
    }
    
    .toast-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.2rem;
    }
    
    .toast-message {
      font-size: 0.75rem;
      opacity: 0.9;
      word-wrap: break-word;
    }
    
    .toast-close {
      color: var(--neutral-400);
      cursor: pointer;
      transition: var(--transition-base);
      flex-shrink: 0;
    }
    
    .toast-close:hover {
      color: white;
    }
    
    /* Sección de Contacto */
    .contact-options {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 1.25rem;
    }
    
    .contact-option {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.9rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      transition: all 0.3s ease;
      text-decoration: none;
      color: var(--neutral-900);
    }
    
    .contact-option:hover {
      background: var(--neutral-300);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .contact-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      flex-shrink: 0;
      color: white;
    }
    
    .contact-icon.whatsapp {
      background: #25D366;
    }
    
    .contact-icon.email {
      background: var(--primary);
    }

    .contact-icon.chat {
      background: var(--info);
    }

    .contact-icon.reviews {
      background: var(--warning);
    }
    
    .contact-content {
      flex: 1;
      min-width: 0;
    }
    
    .contact-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.2rem;
    }
    
    .contact-description {
      font-size: 0.75rem;
      color: var(--neutral-600);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Cargando */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1100;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
      margin-bottom: 1.5rem;
    }
    
    .loading-text {
      color: white;
      font-size: 1rem;
      margin-bottom: 1.5rem;
      font-weight: 500;
    }
    
    .progress-bar-container {
      width: 80%;
      max-width: 280px;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-full);
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background: white;
      width: 0%;
      border-radius: var(--radius-full);
      transition: width 0.3s ease;
    }

    /* Modal de Verificación Mejorado */
    .verification-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1100;
    }
    
    .verification-card {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 500px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .verification-header {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    
    .verification-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    
    .verification-subtitle {
      font-size: 0.85rem;
      color: var(--neutral-600);
    }
    
    .verification-steps {
      margin-bottom: 1.5rem;
    }
    
    .verification-step {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.25rem;
      background: var(--neutral-200);
      padding: 1rem;
      border-radius: var(--radius-md);
    }
    
    .verification-step-number {
      width: 24px;
      height: 24px;
      border-radius: var(--radius-full);
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
      flex-shrink: 0;
    }
    
    .verification-step-content {
      flex: 1;
    }
    
    .verification-step-title {
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--neutral-900);
      margin-bottom: 0.25rem;
    }
    
    .verification-step-description {
      font-size: 0.8rem;
      color: var(--neutral-600);
    }
    
    .verification-actions {
      display: flex;
      gap: 1rem;
    }
    
    /* Nueva sección de Transacciones en Proceso */
    .pending-transactions {
      margin-top: 2rem;
    }
    
    .pending-transaction-item {
      display: flex;
      align-items: center;
      padding: 1rem;
      margin-bottom: 0.75rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      border-left: 4px solid var(--warning);
    }
    
    .pending-transaction-icon {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--warning);
      margin-right: 1rem;
      flex-shrink: 0;
    }
    
    .pending-transaction-content {
      flex: 1;
    }
    
    .pending-transaction-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.25rem;
    }
    
    .pending-transaction-info {
      font-size: 0.75rem;
      color: var(--neutral-600);
    }
    
    .pending-transaction-amount {
      font-weight: 700;
      font-size: 0.9rem;
      color: var(--neutral-900);
      margin-left: 1rem;
    }
    
    /* Historial de Transacciones */
    .transaction-history {
      margin-top: 2rem;
    }
    
    .transaction-history-item {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      margin-bottom: 0.75rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      border-left: 4px solid var(--success);
    }
    
    .transaction-history-icon {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--success);
      margin-right: 1rem;
      flex-shrink: 0;
    }
    
    .transaction-history-content {
      flex: 1;
    }
    
    .transaction-history-title {
      font-weight: 600;
      font-size: 0.85rem;
      margin-bottom: 0.25rem;
    }
    
    .transaction-history-info {
      font-size: 0.75rem;
      color: var(--neutral-600);
    }
    
    .transaction-history-date {
      font-size: 0.7rem;
      color: var(--neutral-500);
      margin-top: 0.2rem;
    }
    
    .transaction-history-amount {
      font-weight: 700;
      font-size: 0.85rem;
      color: var(--neutral-900);
      margin-left: 1rem;
    }
    
    /* Tabs de navegación */
    .tabs-container {
      margin: 1.5rem 0;
    }
    
    .tabs-header {
      display: flex;
      border-bottom: 1px solid var(--neutral-300);
      margin-bottom: 1rem;
    }
    
    .tab-item {
      padding: 0.75rem 1rem;
      font-size: 0.85rem;
      font-weight: 500;
      color: var(--neutral-600);
      border-bottom: 2px solid transparent;
      cursor: pointer;
      transition: var(--transition-base);
    }
    
    .tab-item.active {
      color: var(--primary);
      border-bottom-color: var(--primary);
      font-weight: 600;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }

    /* Modal de Recibo de Retiro */
    .receipt-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1100;
    }
    
    .receipt-card {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 380px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .receipt-header {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    
    .receipt-logo {
      height: 45px;
      width: auto;
      margin-bottom: 1rem;
    }
    
    .receipt-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--neutral-900);
      margin-bottom: 0.5rem;
    }
    
    .receipt-subtitle {
      font-size: 0.85rem;
      color: var(--neutral-600);
    }
    
    .receipt-amount {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
      margin: 1rem 0;
      text-align: center;
    }
    
    .receipt-details {
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      padding: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .receipt-detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.75rem;
      font-size: 0.85rem;
    }
    
    .receipt-detail-row:last-child {
      margin-bottom: 0;
    }
    
    .receipt-detail-label {
      color: var(--neutral-600);
    }
    
    .receipt-detail-value {
      color: var(--neutral-900);
      font-weight: 500;
    }
    
    .receipt-message {
      text-align: center;
      font-size: 0.85rem;
      color: var(--neutral-600);
      margin-bottom: 1.5rem;
    }
    
    .receipt-actions {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .receipt-share {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .receipt-share-btn {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--neutral-200);
      color: var(--neutral-600);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-base);
    }
    
    .receipt-share-btn:hover {
      background: var(--neutral-300);
      transform: translateY(-3px);
    }

    /* Modal de Información de Seguridad */
    .security-info-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1200;
    }
    
    .security-info-content {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 600px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
    }
    
    .security-info-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--neutral-800);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      cursor: pointer;
      z-index: 10;
    }
    
    .faq-container {
      margin: 1.5rem 0;
    }
    
    .faq-item {
      border-bottom: 1px solid var(--neutral-300);
      margin-bottom: 0.5rem;
    }
    
    .faq-header {
      padding: 1rem 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      font-weight: 600;
      color: var(--neutral-800);
    }
    
    .faq-content {
      padding: 0 0 1rem 0;
      color: var(--neutral-600);
      display: none;
      font-size: 0.9rem;
      line-height: 1.5;
    }
    
    .info-link {
      color: var(--primary);
      text-decoration: underline;
      cursor: pointer;
    }
    
    /* Estilo para badges de información */
    .info-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      font-size: 0.7rem;
      margin-left: 0.5rem;
      cursor: pointer;
    }

    /* Tiempo restante antes de redirección por inactividad */
    .time-remaining {
      position: fixed;
      bottom: 80px;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 0.75rem;
      color: var(--neutral-500);
      padding: 0.5rem;
      background: var(--neutral-200);
      z-index: 899;
    }
    
    .time-remaining-progress {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 2px;
      background: var(--primary);
      transition: width 1s linear;
    }
    
    /* Estados de transacción mejorados */
    .status-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.3rem 0.5rem;
      border-radius: var(--radius-md);
      font-size: 0.7rem;
      font-weight: 600;
    }
    
    .status-badge.pending {
      background: rgba(255, 173, 51, 0.1);
      color: var(--warning);
    }
    
    .status-badge.verified {
      background: rgba(0, 211, 77, 0.1);
      color: var(--success);
    }
    
    .status-badge.processing {
      background: rgba(0, 149, 255, 0.1);
      color: var(--info);
    }
    
    .status-badge.rejected {
      background: rgba(255, 77, 77, 0.1);
      color: var(--danger);
    }
    
    /* Animaciones */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes scaleIn {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; visibility: hidden; }
    }
    
    /* Nuevos estilos - Prueba social y elementos visuales */
    .social-proof {
      margin: 1.25rem 0;
      padding: 1rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
    }
    
    .testimonial-container {
      position: relative;
      margin-top: 1rem;
      overflow: hidden;
    }
    
    .testimonial-slider {
      display: flex;
      transition: transform 0.5s ease;
    }
    
    .testimonial {
      min-width: 100%;
      padding: 0.75rem;
      box-sizing: border-box;
    }
    
    .testimonial-content {
      background: white;
      padding: 1rem;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-sm);
      font-size: 0.85rem;
      color: var(--neutral-700);
      position: relative;
    }
    
    .testimonial-content::before {
      content: '\201C';
      font-size: 2rem;
      color: var(--primary-light);
      opacity: 0.2;
      position: absolute;
      top: 5px;
      left: 10px;
      line-height: 1;
    }
    
    .testimonial-author {
      display: flex;
      align-items: center;
      margin-top: 0.75rem;
      gap: 0.5rem;
    }
    
    .testimonial-avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--primary-light);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.7rem;
    }
    
    .testimonial-name {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--neutral-800);
    }
    
    .testimonial-date {
      font-size: 0.7rem;
      color: var(--neutral-500);
      margin-left: auto;
    }
    
    .stats-container {
      display: flex;
      justify-content: space-around;
      margin: 1rem 0;
      text-align: center;
    }
    
    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .stat-value {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary);
    }
    
    .stat-label {
      font-size: 0.7rem;
      color: var(--neutral-600);
      margin-top: 0.25rem;
    }

    .live-indicator {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      font-size: 0.7rem;
      color: var(--success);
      font-weight: 500;
    }
    
    .live-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--success);
      animation: pulse 1.5s infinite;
    }

    .last-step-banner {
      background: linear-gradient(45deg, var(--success) 0%, #88de7c 100%);
      color: white;
      padding: 1rem;
      border-radius: var(--radius-md);
      margin: 1.25rem 0;
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-md);
    }

    .last-step-content {
      position: relative;
      z-index: 2;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .last-step-icon {
      width: 60px;
      height: 60px;
      flex-shrink: 0;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-md);
    }

    .last-step-icon img {
      width: 70%;
      height: auto;
    }

    .last-step-text {
      flex: 1;
    }

    .last-step-title {
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 0.5rem;
    }

    .progress-visualization {
      position: relative;
      height: 10px;
      background: var(--neutral-200);
      border-radius: var(--radius-full);
      margin: 2rem 0 1rem;
      overflow: hidden;
    }
    
    .progress-bar-custom {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
      border-radius: var(--radius-full);
      transition: width 1s ease;
    }
    
    .progress-icon {
      position: absolute;
      top: -10px;
      left: 0;
      transform: translateX(-50%);
      width: 30px;
      height: 30px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-md);
      transition: left 1s ease;
    }
    
    .progress-icon img {
      width: 80%;
      height: auto;
    }
    
    .progress-steps {
      display: flex;
      justify-content: space-between;
      margin-top: 1.5rem;
      position: relative;
    }
    
    .progress-step {
      text-align: center;
      flex: 1;
      position: relative;
    }
    
    .progress-step::before {
      content: '';
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 8px;
      background: var(--neutral-300);
      border-radius: 50%;
      transition: background-color 0.3s ease;
    }
    
    .progress-step.active::before {
      background: var(--primary);
    }
    
    .progress-step.completed::before {
      background: var(--success);
    }
    
    .progress-step-label {
      font-size: 0.7rem;
      color: var(--neutral-600);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 5px;
    }
    
    .progress-step.active .progress-step-label {
      color: var(--primary);
      font-weight: 500;
    }
    
    .progress-step.completed .progress-step-label {
      color: var(--success);
      font-weight: 500;
    }
    
    .progress-step-info {
      margin-top: 0.5rem;
      font-size: 0.7rem;
      color: var(--neutral-500);
    }
    
    /* Nuevas clases para la guía de verificación mejorada */
    .verification-guide-enhanced {
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e7ec 100%);
      border-radius: var(--radius-md);
      padding: 1.25rem;
      margin: 1.5rem 0;
      border-left: 4px solid var(--primary);
      position: relative;
      box-shadow: var(--shadow-md);
      overflow: hidden;
      animation: pulse-border 2s infinite;
    }
    
    @keyframes pulse-border {
      0% { border-left-color: var(--primary); }
      50% { border-left-color: var(--info); }
      100% { border-left-color: var(--primary); }
    }
    
    .verification-guide-enhanced::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 120px;
      height: 120px;
      background: radial-gradient(circle, rgba(26, 31, 113, 0.05) 0%, rgba(26, 31, 113, 0) 70%);
      border-radius: 50%;
    }
    
    .verification-guide-enhanced-title {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin-bottom: 1.2rem;
      font-weight: 700;
      color: var(--primary);
      font-size: 1.1rem;
    }
    
    .verification-guide-enhanced-title i {
      color: var(--primary);
      font-size: 1.3rem;
    }
    
    .verification-guide-steps {
      margin-left: 0.5rem;
      counter-reset: step-counter;
    }
    
    .verification-guide-step {
      position: relative;
      padding-left: 2.5rem;
      padding-bottom: 1rem;
      margin-bottom: 1rem;
      border-left: 2px dashed var(--neutral-400);
    }
    
    .verification-guide-step:last-child {
      border-left: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    
    .verification-guide-step::before {
      counter-increment: step-counter;
      content: counter(step-counter);
      position: absolute;
      left: -12px;
      top: 0;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.8rem;
    }
    
    .verification-guide-step-title {
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--neutral-800);
      margin-bottom: 0.4rem;
    }
    
    .verification-guide-step-description {
      font-size: 0.85rem;
      color: var(--neutral-700);
      margin-bottom: 0.5rem;
      line-height: 1.4;
    }
    
    .verification-guide-step-note {
      font-size: 0.8rem;
      color: var(--info);
      font-style: italic;
      line-height: 1.4;
    }
    
    .verification-guide-footer {
      margin-top: 1.25rem;
      padding-top: 1rem;
      border-top: 1px solid var(--neutral-300);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
      color: var(--primary);
      font-weight: 500;
    }
    
    .verification-amount-highlight {
      font-weight: 700;
      color: var(--primary);
      background: rgba(26, 31, 113, 0.1);
      padding: 0.2rem 0.4rem;
      border-radius: var(--radius-sm);
      white-space: nowrap;
    }
    
    /* Custom checkbox para confirmación de lectura */
    .checkbox-container {
      display: flex;
      align-items: flex-start;
      gap: 0.8rem;
      margin: 1rem 0;
      padding: 0.8rem;
      border-radius: var(--radius-md);
      background: rgba(0, 149, 255, 0.05);
      transition: background-color 0.3s ease;
    }
    
    .checkbox-container.checked {
      background: rgba(0, 211, 77, 0.1);
    }
    
    .checkbox-wrapper {
      position: relative;
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      margin-top: 0.1rem;
    }
    
    .verification-checkbox {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .checkbox-custom {
      position: absolute;
      top: 0;
      left: 0;
      width: 20px;
      height: 20px;
      border: 2px solid var(--neutral-400);
      border-radius: 4px;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .verification-checkbox:checked + .checkbox-custom {
      background: var(--success);
      border-color: var(--success);
    }
    
    .verification-checkbox:checked + .checkbox-custom::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 7px;
      width: 4px;
      height: 8px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
    
    .verification-checkbox:focus + .checkbox-custom {
      box-shadow: 0 0 0 3px rgba(0, 149, 255, 0.2);
    }
    
    .checkbox-label {
      font-size: 0.9rem;
      color: var(--neutral-700);
      line-height: 1.4;
    }
    
    /* Modal de confirmación */
    .confirmation-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1200;
    }
    
    .confirmation-card {
      background: white;
      border-radius: var(--radius-lg);
      width: 90%;
      max-width: 450px;
      padding: 1.5rem;
      animation: scaleIn 0.3s ease;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .confirmation-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--neutral-300);
    }
    
    .confirmation-icon {
      width: 60px;
      height: 60px;
      background: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.8rem;
      flex-shrink: 0;
    }
    
    .confirmation-title-container {
      flex: 1;
    }
    
    .confirmation-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.3rem;
    }
    
    .confirmation-subtitle {
      font-size: 0.9rem;
      color: var(--neutral-600);
    }
    
    .confirmation-content {
      margin-bottom: 1.5rem;
    }
    
    .confirmation-message {
      font-size: 0.95rem;
      color: var(--neutral-700);
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }
    
    .confirmation-step {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }
    
    .confirmation-step-number {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.85rem;
      flex-shrink: 0;
    }
    
    .confirmation-step-text {
      font-size: 0.9rem;
      color: var(--neutral-800);
      line-height: 1.4;
    }
    
    .confirmation-actions {
      display: flex;
      gap: 1rem;
      margin-top: 1.5rem;
    }
    
    .confirmation-btn {
      flex: 1;
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    .confirmation-btn-primary {
      background: var(--primary);
      color: white;
      border: none;
    }
    
    .confirmation-btn-primary:hover {
      background: var(--primary-light);
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
    }
    
    .confirmation-btn-secondary {
      background: transparent;
      border: 1px solid var(--neutral-400);
      color: var(--neutral-700);
    }
    
    .confirmation-btn-secondary:hover {
      background: var(--neutral-200);
      transform: translateY(-3px);
    }
    
    .funds-journey {
      position: relative;
      margin: 2rem 0;
    }
    
    .journey-visualization {
      display: flex;
      align-items: center;
      background: var(--neutral-200);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      position: relative;
      overflow: hidden;
    }
    
    .journey-from {
      position: relative;
      z-index: 2;
      flex-shrink: 0;
      text-align: center;
    }
    
    .journey-to {
      position: relative;
      z-index: 2;
      flex-shrink: 0;
      text-align: center;
    }
    
    .journey-path {
      flex: 1;
      height: 4px;
      background: var(--neutral-300);
      margin: 0 0.75rem;
      position: relative;
      z-index: 1;
      border-radius: var(--radius-full);
      overflow: hidden;
    }
    
    .journey-progress {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background: var(--success);
      width: 75%;
      border-radius: var(--radius-full);
    }
    
    .journey-icon {
      width: 50px;
      height: 50px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-md);
      margin: 0 auto 0.5rem;
    }
    
    .journey-icon img {
      width: 60%;
      height: auto;
    }
    
    .journey-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--neutral-800);
    }
    
    .journey-status {
      font-size: 0.7rem;
      color: var(--success);
      margin-top: 0.25rem;
    }
    
    .journey-checkpoint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
    }
    
    .journey-checkpoint-dot {
      width: 10px;
      height: 10px;
      background: var(--info);
      border-radius: 50%;
      margin: 0 auto;
      position: relative;
    }
    
    .journey-checkpoint-dot::before {
      content: '';
      position: absolute;
      top: -10px;
      left: -10px;
      width: 30px;
      height: 30px;
      background: rgba(0, 149, 255, 0.1);
      border-radius: 50%;
      z-index: -1;
    }
    
    .journey-checkpoint-label {
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.7rem;
      color: var(--info);
      white-space: nowrap;
      background: white;
      padding: 0.2rem 0.5rem;
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-sm);
    }
    
    .journey-money {
      position: absolute;
      top: 50%;
      left: 38%;
      transform: translate(-50%, -50%);
      animation: moveRight 3s ease-in-out infinite;
      z-index: 3;
    }
    
    .journey-money-icon {
      font-size: 1.2rem;
      color: var(--accent);
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
    }
    
    @keyframes moveRight {
      0% { left: 38%; }
      50% { left: 42%; }
      100% { left: 38%; }
    }
    
    /* Ajustes Responsivos */
    @media (min-width: 768px) {
      .withdrawal-container {
        padding: 1.5rem;
        padding-top: 80px;
        padding-bottom: 80px;
      }
      
      .timeline {
        margin-bottom: 3rem;
      }
      
      .timeline-icon {
        width: 3rem;
        height: 3rem;
        font-size: 1.25rem;
        margin-bottom: 0.75rem;
      }
      
      .timeline-label {
        font-size: 0.8rem;
        max-width: 100px;
      }
      
      .method-options {
        gap: 1.5rem;
      }
      
      .method-option {
        padding: 1.25rem;
      }
      
      .method-icon {
        font-size: 1.75rem;
      }
      
      .method-label {
        font-size: 0.9rem;
      }
      
      .method-description {
        font-size: 0.75rem;
      }
      
      .bank-logo-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    
    @media (max-width: 576px) {
      .section-title {
        font-size: 0.9rem;
      }
      
      .method-options {
        flex-direction: column;
      }
      
      .method-option {
        width: 100%;
      }
      
      .verify-banner {
        flex-direction: column;
        text-align: center;
        padding: 1rem;
      }
      
      .verify-icon {
        margin: 0 auto 0.5rem;
      }
      
      .verify-action {
        width: 100%;
        margin-top: 0.5rem;
      }
      
      .verification-actions {
        flex-direction: column;
      }
      
      .receipt-card {
        padding: 1rem;
      }
      
      .users-online-badge {
        display: none;
      }
      
      .withdrawal-container {
        padding-left: 0.75rem;
        padding-right: 0.75rem;
      }
      
      .bank-detail-row {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .bank-detail-value {
        margin-top: 0.25rem;
        width: 100%;
        justify-content: space-between;
      }
      
      .tabs-header {
        overflow-x: auto;
        white-space: nowrap;
        padding-bottom: 0.5rem;
      }
      
      .tab-item {
        padding: 0.75rem 0.5rem;
        font-size: 0.8rem;
      }
      
      .confirmation-actions {
        flex-direction: column;
      }
    }
    
    /* Soporte de imagen de fondo */
    .bg-image {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      opacity: 0.02;
      pointer-events: none;
      z-index: -1;
    }

    /* Nuevos botones de acción social */
    .social-action-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    
    .social-action-button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: white;
      border: 1px solid var(--neutral-300);
      border-radius: var(--radius-md);
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--neutral-800);
      text-decoration: none;
      transition: all 0.3s var(--animation-bounce);
      white-space: nowrap;
      box-shadow: var(--shadow-sm);
      flex: 1;
      justify-content: center;
    }
    
    .social-action-button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-md);
      background: var(--neutral-100);
      border-color: var(--primary);
      color: var(--primary);
    }
    
    .social-action-button i {
      font-size: 0.9rem;
      color: var(--primary);
    }
    
    /* Estilos para la navegación inferior mejorada */
    .bottom-nav {
      padding: 0.5rem 0.25rem;
    }
    
    .bottom-nav .nav-item {
      position: relative;
      padding: 0.5rem 0.25rem;
    }
    
    .bottom-nav .nav-icon {
      margin-bottom: 0.25rem;
      font-size: 1.2rem;
    }
    
    .bottom-nav .nav-label {
      font-size: 0.65rem;
    }
    
    /* Badge para notificaciones en nav */
    .nav-badge {
      position: absolute;
      top: 6px;
      right: calc(50% - 16px);
      background: var(--danger);
      color: white;
      font-size: 0.6rem;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }
    
    /* Soporte de idioma */
    .language-selector {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.35rem 0.5rem;
      background: var(--neutral-200);
      border-radius: var(--radius-md);
      font-size: 0.7rem;
      color: var(--neutral-700);
      cursor: pointer;
      transition: var(--transition-base);
    }
    
    .language-selector:hover {
      background: var(--neutral-300);
    }
    
    .language-selector i {
      font-size: 0.8rem;
    }
  </style>
</head>

<body>
  <!-- Fondo de soporte -->
  <div class="bg-image"></div>
  
  <!-- App Header -->
  <header class="app-header">
    <div class="header-brand">
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX">
    </div>
    
    <div class="header-actions">
      <div class="users-online-badge">
        <div class="pulse-dot"></div>
        <span id="users-online-count">124 usuarios conectados</span>
      </div>
      
      <button class="header-action-btn" id="notification-btn" aria-label="Notificaciones">
        <i class="fas fa-bell"></i>
        <span class="notification-badge">2</span>
      </button>
    </div>
  </header>

  <!-- Contenedor Principal -->
  <div class="withdrawal-container">
    <div class="section-title" style="margin-bottom: 1.5rem; display: flex; align-items: center;">
      <a href="recarga.html" style="color: var(--primary); text-decoration: none; display: flex; align-items: center;">
        <i class="fas fa-arrow-left" style="margin-right: 1rem;"></i>
      </a>
      <span>Retiro de Fondos</span>
    </div>
    
    <!-- Badge de Seguridad -->
    <div class="security-badge">
      <div class="security-badge-icon">
        <i class="fas fa-shield-alt"></i>
      </div>
      <div class="security-badge-content">
        <div class="security-badge-title">Transferencia Segura</div>
        <div class="security-badge-text">Todas tus transacciones están protegidas con certificados de seguridad</div>
      </div>
    </div>

    <!-- Tabs de Navegación -->
    <div class="tabs-container">
      <div class="tabs-header">
        <div class="tab-item active" data-tab="new-withdrawal">Crear Retiro</div>
        <div class="tab-item" data-tab="pending">Operaciones Pendientes</div>
        <div class="tab-item" data-tab="history">Historial</div>
      </div>
      
      <!-- Tab 1: Crear Nuevo Retiro -->
      <div class="tab-content active" id="new-withdrawal-tab">
        <!-- Timeline del Proceso de Retiro -->
        <div class="timeline-container">
          <div class="timeline">
            <div class="timeline-progress" id="timeline-progress" style="width: 25%;"></div>
            
            <div class="timeline-step active" id="step-create">
              <div class="timeline-icon">
                <i class="fas fa-edit"></i>
              </div>
              <div class="timeline-label">Crear Orden</div>
            </div>
            
            <div class="timeline-step" id="step-verify">
              <div class="timeline-icon">
                <i class="fas fa-shield-alt"></i>
              </div>
              <div class="timeline-label">Verificar Cuenta</div>
            </div>
            
            <div class="timeline-step" id="step-process">
              <div class="timeline-icon">
                <i class="fas fa-cog"></i>
              </div>
              <div class="timeline-label">Procesando</div>
            </div>
            
            <div class="timeline-step" id="step-complete">
              <div class="timeline-icon">
                <i class="fas fa-check"></i>
              </div>
              <div class="timeline-label">Completado</div>
            </div>
          </div>
        </div>

        <!-- Tarjetas de Saldo -->
        <div class="card">
          <div class="section-title" style="margin-bottom: 0.5rem;">
            <i class="fas fa-wallet"></i> Saldo Disponible
            <span class="info-badge" id="info-balance-badge" title="Información sobre tu saldo"><i class="fas fa-info"></i></span>
          </div>
          
          <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;">
            <div style="flex: 1; min-width: 200px; background: var(--primary); color: white; padding: 1rem; border-radius: var(--radius-md); position: relative; overflow: hidden;">
              <div style="position: absolute; right: -20px; bottom: -20px; width: 100px; height: 100px; border-radius: 50%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);"></div>
              
              <div style="position: relative; z-index: 2;">
                <div style="font-size: 0.8rem; opacity: 0.8; margin-bottom: 0.5rem;">Saldo Total</div>
                <div style="font-size: 1.75rem; font-weight: 700; margin-bottom: 0.5rem;" id="total-balance">Bs 0,00</div>
                <div style="font-size: 0.8rem; opacity: 0.8;" id="balance-equivalents">≈ $0.00 | ≈ €0.00</div>
              </div>
            </div>
            
            <div style="flex: 1; min-width: 200px; background: var(--neutral-200); padding: 1rem; border-radius: var(--radius-md);">
              <div style="font-size: 0.8rem; color: var(--neutral-600); margin-bottom: 0.5rem;">Cantidad a Retirar</div>
              <div style="position: relative;">
                <input type="text" class="form-control" id="withdrawal-amount" placeholder="0,00" style="padding-left: 2.5rem; font-size: 1.25rem; font-weight: 600;">
                <div style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); font-weight: 600; color: var(--neutral-800);">Bs</div>
              </div>
              <div style="font-size: 0.75rem; color: var(--neutral-500); margin-top: 0.5rem; text-align: right;" id="amount-equivalents">≈ $0.00 | ≈ €0.00</div>
            </div>
          </div>
          
          <div style="font-size: 0.75rem; color: var(--neutral-600); margin-bottom: 1rem; text-align: center;">
            Tasa: <span id="exchange-rate-display">1 USD = 114,45 Bs | 1 USD = 0,94 EUR</span>
          </div>
        </div>
        
        <!-- Visualización del Progreso de los Fondos -->
        <div class="funds-journey">
          <div class="journey-visualization">
            <div class="journey-from">
              <div class="journey-icon">
                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX VISA">
              </div>
              <div class="journey-label">REMEEX VISA</div>
              <div class="journey-status">Listo para enviar</div>
            </div><div class="journey-path">
              <div class="journey-progress" id="journey-progress-bar"></div>
              <div class="journey-checkpoint">
                <div class="journey-checkpoint-dot"></div>
                <div class="journey-checkpoint-label">Verificación</div>
              </div>
              <div class="journey-money" id="journey-money-animation">
                <div class="journey-money-icon">
                  <i class="fas fa-dollar-sign"></i>
                </div>
              </div>
            </div>
            
            <div class="journey-to">
              <div class="journey-icon" id="destination-bank-icon">
                <!-- El logo del banco seleccionado se cargará dinámicamente aquí -->
                <img src="https://e7.pngegg.com/pngimages/127/511/png-clipart-bank-computer-icons-bank-building-bank.png" alt="Tu Banco" id="destination-bank-logo">
              </div>
              <div class="journey-label" id="destination-bank-name">Tu Banco</div>
              <div class="journey-status">Esperando fondos</div>
            </div>
          </div>
        </div>

        <!-- Selección de Método de Retiro -->
        <div class="card">
          <div class="section-title" style="margin-bottom: 0.75rem;">
            <i class="fas fa-exchange-alt"></i> Método de Retiro
          </div>
          
          <div class="method-options">
            <div class="method-option active" data-method="mobile" data-limit="250000">
              <div class="method-icon">
                <i class="fas fa-mobile-alt"></i>
              </div>
              <div class="method-label">Pago Móvil</div>
              <div class="method-description">Límite: 250.000,00 Bs</div>
            </div>
            
            <div class="method-option" data-method="bank" data-limit="1000000">
              <div class="method-icon">
                <i class="fas fa-university"></i>
              </div>
              <div class="method-label">Transferencia Bancaria</div>
              <div class="method-description">Límite: 1.000.000,00 Bs</div>
            </div>
            
            <div class="method-option" data-method="international">
              <div class="method-icon">
                <i class="fas fa-globe"></i>
              </div>
              <div class="method-label">Transferencia Internacional</div>
              <div class="method-description">Sin límite</div>
            </div>
          </div>
          
          <!-- Formulario de Pago Móvil -->
          <div class="bank-selection active" id="mobile-payment-form">
            <div class="form-group">
              <label class="form-label">Banco Emisor <i class="fas fa-info-circle" style="color: var(--info); font-size: 0.75rem; cursor: pointer;" title="Selecciona el banco asociado a tu número de teléfono"></i></label>
              <p class="help-text">Selecciona el banco donde tienes registrado tu número de pago móvil</p>
              
              <!-- Grilla de Logos de Bancos -->
              <div class="bank-logo-grid" id="mobile-bank-grid">
                <!-- Los logos de bancos se cargarán dinámicamente por JavaScript -->
              </div>
              
              <input type="hidden" id="mobile-bank" name="mobile-bank" value="">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="mobile-number">Número de Teléfono</label>
              <input type="tel" class="form-control" id="mobile-number" placeholder="Ejemplo: 0414-1234567">
              <div class="error-message" id="mobile-number-error">Por favor, introduce un número de teléfono válido.</div>
              <div class="help-text">Introduce el número registrado en tu banco para pago móvil</div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="mobile-id">Cédula de Identidad</label>
              <input type="text" class="form-control" id="mobile-id" placeholder="Ejemplo: V-12345678">
              <div class="error-message" id="mobile-id-error">Por favor, introduce un número de cédula válido.</div>
              <div class="help-text">Debe ser tu propia cédula, igual a la registrada en el banco</div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="mobile-name">Nombre Completo</label>
              <input type="text" class="form-control" id="mobile-name" placeholder="Tal como aparece en tu banco">
              <div class="error-message" id="mobile-name-error">Por favor, introduce tu nombre completo.</div>
              <div class="help-text">Nombres y apellidos exactamente como aparecen en tu banco</div>
            </div>
          </div>
          
          <!-- Formulario de Transferencia Bancaria -->
          <div class="bank-selection" id="bank-transfer-form">
            <div class="form-group">
              <label class="form-label">Banco <i class="fas fa-info-circle" style="color: var(--info); font-size: 0.75rem; cursor: pointer;" title="Selecciona el banco donde tienes tu cuenta"></i></label>
              <p class="help-text">Selecciona el banco donde tienes tu cuenta bancaria</p>
              
              <!-- Grilla de Logos de Bancos -->
              <div class="bank-logo-grid" id="bank-name-grid">
                <!-- Los logos de bancos se cargarán dinámicamente por JavaScript -->
              </div>
              
              <input type="hidden" id="bank-name" name="bank-name" value="">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="account-type">Tipo de Cuenta</label>
              <select class="form-control" id="account-type">
                <option value="" disabled selected>Seleccione el tipo de cuenta</option>
                <option value="corriente">Corriente</option>
                <option value="ahorro">Ahorro</option>
              </select>
              <div class="help-text">Selecciona el tipo de cuenta bancaria que tienes</div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="account-number">Número de Cuenta</label>
              <input type="text" class="form-control" id="account-number" placeholder="Ejemplo: 0105-0000-00-0000000000">
              <div class="error-message" id="account-number-error">Por favor, introduce un número de cuenta válido.</div>
              <div class="help-text">Ingresa tu número de cuenta completo (20 dígitos)</div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="account-id">Cédula de Identidad</label>
              <input type="text" class="form-control" id="account-id" placeholder="Ejemplo: V-12345678">
              <div class="error-message" id="account-id-error">Por favor, introduce un número de cédula válido.</div>
              <div class="help-text">Debe ser tu propia cédula, igual a la registrada en el banco</div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="account-name">Nombre Completo</label>
              <input type="text" class="form-control" id="account-name" placeholder="Tal como aparece en tu banco">
              <div class="error-message" id="account-name-error">Por favor, introduce tu nombre completo.</div>
              <div class="help-text">Nombres y apellidos exactamente como aparecen en tu banco</div>
            </div>
          </div>
          
          <!-- Formulario de Transferencia Internacional -->
          <div class="bank-selection" id="international-transfer-form">
            <div class="form-group">
              <label class="form-label" for="int-method">Método de Envío Internacional</label>
              <select class="form-control" id="int-method">
                <option value="" disabled selected>Seleccione el método</option>
                <option value="zelle">Zelle</option>
                <option value="paypal">PayPal</option>
                <option value="wise">Wise (Transferwise)</option>
                <option value="swift">Transferencia SWIFT</option>
                <option value="crypto">Criptomonedas</option>
              </select>
              <div class="help-text">Selecciona el método que prefieres para recibir tus fondos</div>
            </div>
            
            <!-- Formularios específicos por método internacional -->
            <!-- Zelle -->
            <div class="form-group" id="zelle-form" style="display: none;">
              <label class="form-label" for="zelle-email">Correo Electrónico de Zelle</label>
              <input type="email" class="form-control" id="zelle-email" placeholder="correo@ejemplo.com">
              <div class="error-message" id="zelle-email-error">Por favor, introduce un correo electrónico válido.</div>
              <div class="help-text">El correo debe estar asociado a tu cuenta de Zelle</div>
            </div>
            
            <!-- PayPal -->
            <div class="form-group" id="paypal-form" style="display: none;">
              <label class="form-label" for="paypal-email">Correo Electrónico de PayPal</label>
              <input type="email" class="form-control" id="paypal-email" placeholder="correo@ejemplo.com">
              <div class="error-message" id="paypal-email-error">Por favor, introduce un correo electrónico válido.</div>
              <div class="help-text">El correo debe estar asociado a tu cuenta de PayPal</div>
            </div>
            
            <!-- SWIFT -->
            <div id="swift-form" style="display: none;">
              <div class="form-group">
                <label class="form-label" for="swift-bank">Nombre del Banco</label>
                <input type="text" class="form-control" id="swift-bank" placeholder="Nombre del banco">
                <div class="help-text">Nombre completo del banco receptor</div>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="swift-code">Código SWIFT/BIC</label>
                <input type="text" class="form-control" id="swift-code" placeholder="Ejemplo: BOFAUS3N">
                <div class="help-text">Código internacional de tu banco (8 o 11 caracteres)</div>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="swift-account">Número de Cuenta/IBAN</label>
                <input type="text" class="form-control" id="swift-account" placeholder="Número de cuenta o IBAN">
                <div class="help-text">Número de cuenta internacional o IBAN completo</div>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="swift-name">Nombre del Beneficiario</label>
                <input type="text" class="form-control" id="swift-name" placeholder="Nombre completo">
                <div class="help-text">Tu nombre completo tal como aparece en el banco</div>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="swift-address">Dirección del Beneficiario</label>
                <input type="text" class="form-control" id="swift-address" placeholder="Dirección completa">
                <div class="help-text">Tu dirección tal como está registrada en el banco</div>
              </div>
            </div>
            
            <!-- Crypto -->
            <div class="form-group" id="crypto-form" style="display: none;">
              <label class="form-label" for="crypto-currency">Seleccione Criptomoneda</label>
              <select class="form-control" id="crypto-currency">
                <option value="btc">Bitcoin (BTC)</option>
                <option value="eth">Ethereum (ETH)</option>
                <option value="usdt">Tether (USDT)</option>
                <option value="usdc">USD Coin (USDC)</option>
                <option value="bnb">Binance Coin (BNB)</option>
              </select>
              <div class="help-text">Selecciona la criptomoneda que deseas recibir</div>
              
              <label class="form-label" for="crypto-address" style="margin-top: 1rem;">Dirección de Billetera</label>
              <input type="text" class="form-control" id="crypto-address" placeholder="Dirección de tu billetera">
              <div class="error-message" id="crypto-address-error">Por favor, introduce una dirección de billetera válida.</div>
              <div class="help-text">Verifica que la dirección sea correcta antes de continuar</div>
            </div>
            
            <!-- Wise -->
            <div class="form-group" id="wise-form" style="display: none;">
              <label class="form-label" for="wise-email">Correo Electrónico de Wise</label>
              <input type="email" class="form-control" id="wise-email" placeholder="correo@ejemplo.com">
              <div class="error-message" id="wise-email-error">Por favor, introduce un correo electrónico válido.</div>
              <div class="help-text">El correo debe estar asociado a tu cuenta de Wise</div>
            </div>
          </div>
          
          <!-- Banner de Verificación Mejorado -->
          <div class="verify-banner" id="verify-banner" style="display: none;">
            <div class="verify-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div class="verify-content">
              <div class="verify-title">Último paso para desbloquear tus fondos</div>
              <div class="verify-text">Para garantizar la seguridad y que el dinero llegue correctamente, necesitamos confirmar que la cuenta bancaria es realmente tuya.</div>
              
              <div class="verify-benefits">
                <div class="verify-benefit-item">
                  <i class="fas fa-check-circle"></i>
                  <span>El depósito de verificación se agrega a tu saldo disponible</span>
                </div>
                <div class="verify-benefit-item">
                  <i class="fas fa-check-circle"></i>
                  <span>Proceso único por cuenta bancaria</span>
                </div>
                <div class="verify-benefit-item">
                  <i class="fas fa-check-circle"></i>
                  <span>+18.945 usuarios ya han completado este paso</span>
                </div>
              </div>
              
              <button class="verify-action" id="verify-now-btn">
                <i class="fas fa-shield-alt"></i> Verificar Ahora
              </button>
            </div>
          </div>

          <!-- Contenedor de Estado de Verificación -->
          <div id="verification-status-container" style="display: none; background: rgba(0, 149, 255, 0.1); border-radius: var(--radius-md); padding: 1rem; margin-top: 1rem; border-left: 4px solid var(--info);">
            <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
              <div style="color: var(--info); font-size: 1.2rem; margin-top: 0.1rem;">
                <i class="fas fa-clock"></i>
              </div>
              <div>
                <h3 style="font-size: 0.9rem; margin-bottom: 0.5rem; font-weight: 600; color: var(--info);">Verificación en Proceso</h3>
                <p style="font-size: 0.8rem; color: var(--neutral-700); margin-bottom: 0.5rem;">Tu depósito de verificación está siendo procesado. Este proceso normalmente toma unos minutos, pero puede demorar hasta 24 horas en algunos casos.</p>
                <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem; flex-wrap: wrap;">
                  <button class="btn btn-outline" id="verification-check-status-btn" style="font-size: 0.75rem; padding: 0 0.75rem; height: 36px;">
                    <i class="fas fa-sync-alt"></i> Verificar Estado
                  </button>
                  <button class="btn btn-outline" id="verification-contact-support-btn" style="font-size: 0.75rem; padding: 0 0.75rem; height: 36px;">
                    <i class="fas fa-headset"></i> Contactar Soporte
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Prueba Social -->
          <div class="social-proof">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.75rem;">
              <h3 style="font-size: 0.9rem; font-weight: 600; color: var(--neutral-800);">Lo que dicen nuestros usuarios</h3>
              <div class="live-indicator">
                <div class="live-dot"></div>
                <span>En tiempo real</span>
              </div>
            </div>
            
            <div class="stats-container">
              <div class="stat-item">
                <div class="stat-value" id="stat-usuarios">18.945</div>
                <div class="stat-label">Usuarios verificados</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="stat-retiros">2.349</div>
                <div class="stat-label">Retiros este mes</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="stat-tiempo">4min</div>
                <div class="stat-label">Tiempo promedio</div>
              </div>
            </div>
            
            <div class="testimonial-container">
              <div class="testimonial-slider" id="testimonial-slider">
                <div class="testimonial">
                  <div class="testimonial-content">
                    Proceso muy rápido y seguro. En menos de 5 minutos completé la verificación y pude retirar sin problemas.
                  </div>
                  <div class="testimonial-author">
                    <div class="testimonial-avatar">MG</div>
                    <div class="testimonial-name">María G.</div>
                    <div class="testimonial-date">Hace 2 días</div>
                  </div>
                </div>
                
                <div class="testimonial">
                  <div class="testimonial-content">
                    Al principio dudaba de hacer el depósito de verificación, pero ahora entiendo que era necesario. El dinero se sumó a mi saldo y todo perfecto.
                  </div>
                  <div class="testimonial-author">
                    <div class="testimonial-avatar">JR</div>
                    <div class="testimonial-name">Juan R.</div>
                    <div class="testimonial-date">Hace 5 días</div>
                  </div>
                </div>
                
                <div class="testimonial">
                  <div class="testimonial-content">
                    Excelente servicio, el soporte me ayudó en todo momento. Muy recomendado para quienes buscan seguridad en sus transferencias.
                  </div>
                  <div class="testimonial-author">
                    <div class="testimonial-avatar">LP</div>
                    <div class="testimonial-name">Laura P.</div>
                    <div class="testimonial-date">Hace 1 semana</div>
                  </div>
                </div>
                
                <!-- Nuevos testimonios añadidos -->
                <div class="testimonial">
                  <div class="testimonial-content">
                    Tenía dudas sobre el proceso, pero el depósito en bolívares fue sumado inmediatamente a mi saldo en dólares. ¡Recomendado!
                  </div>
                  <div class="testimonial-author">
                    <div class="testimonial-avatar">CA</div>
                    <div class="testimonial-name">Carlos A.</div>
                    <div class="testimonial-date">Hace 3 días</div>
                  </div>
                </div>
                
                <div class="testimonial">
                  <div class="testimonial-content">
                    Retiré varios miles de bolívares a mi banco sin ningún problema después de verificar mi cuenta. El soporte técnico respondió todas mis dudas.
                  </div>
                  <div class="testimonial-author">
                    <div class="testimonial-avatar">RV</div>
                    <div class="testimonial-name">Rodrigo V.</div>
                    <div class="testimonial-date">Hace 6 días</div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Nuevos botones de acción social -->
            <div class="social-action-buttons">
              <a href="opinionesremeex.html" class="social-action-button">
                <i class="fas fa-star"></i> Ver más opiniones
              </a>
              <a href="fororemeex.html" class="social-action-button">
                <i class="fas fa-comments"></i> Foro en vivo
              </a>
            </div>
          </div>

          <!-- NUEVA Guía de Verificación Destacada -->
          <div class="verification-guide-enhanced" id="verification-guide-enhanced">
            <div class="verification-guide-enhanced-title">
              <i class="fas fa-shield-alt"></i>
              <span>Cómo completar la verificación de tu cuenta</span>
            </div>
            
            <div class="verification-guide-steps">
              <div class="verification-guide-step">
                <div class="verification-guide-step-title">Dirígete al Panel Principal</div>
                <div class="verification-guide-step-description">Presiona el botón <strong>"Recargar Saldo"</strong> en la pantalla principal de tu cuenta REMEEX.</div>
              </div>
              
              <div class="verification-guide-step">
                <div class="verification-guide-step-title">Selecciona Pago Móvil</div>
                <div class="verification-guide-step-description">Utiliza <strong>la misma cuenta bancaria</strong> que registraste para retiros. Esto es esencial para que podamos verificar que la cuenta te pertenece.</div>
              </div>
              
              <div class="verification-guide-step">
                <div class="verification-guide-step-title">Realiza el depósito de verificación</div>
                <div class="verification-guide-step-description">Deposita <span class="verification-amount-highlight">Bs 2.845,50</span> (equivalente a $25 USD) desde tu cuenta personal.</div>
                <div class="verification-guide-step-note">Este monto se agrega automáticamente a tu saldo disponible. No es una comisión.</div>
              </div>
              
              <div class="verification-guide-step">
                <div class="verification-guide-step-title">Verifica tus datos</div>
                <div class="verification-guide-step-description">Asegúrate que el nombre y cédula de identidad sean exactamente los mismos que usaste aquí para registrar tu cuenta bancaria.</div>
              </div>
              
              <div class="verification-guide-step">
                <div class="verification-guide-step-title">¡Completo!</div>
                <div class="verification-guide-step-description">Tu cuenta quedará verificada y el monto depositado se agregará a tu saldo disponible en dólares usando la tasa de cambio vigente.</div>
              </div>
            </div>
            
            <div class="verification-guide-footer">
              <i class="fas fa-info-circle"></i>
              <span>La verificación es un proceso único que protege tus fondos y confirma la titularidad de tu cuenta bancaria.</span>
            </div>
            
            <!-- NUEVO: Checkbox de confirmación de lectura -->
            <div class="checkbox-container" id="verification-checkbox-container">
              <div class="checkbox-wrapper">
                <input type="checkbox" id="verification-confirmation-checkbox" class="verification-checkbox">
                <span class="checkbox-custom"></span>
              </div>
              <label class="checkbox-label" for="verification-confirmation-checkbox">
                He leído y entiendo que debo realizar un depósito de verificación de <strong>Bs 2.845,50</strong> (equivalente a $25 USD) para completar mi retiro. Este monto se sumará a mi saldo disponible.
              </label>
            </div>
          </div>

          <button class="btn btn-primary" id="submit-withdrawal" style="margin-top: 1.5rem;" disabled>
            <i class="fas fa-paper-plane"></i> Solicitar Retiro
          </button>
          
          <!-- Información de Verificación con botón añadido -->
          <div style="margin-top: 1.5rem; padding: 1rem; background-color: rgba(26, 31, 113, 0.05); border-radius: var(--radius-md); display: flex; align-items: flex-start; gap: 0.75rem;">
            <i class="fas fa-info-circle" style="color: var(--primary); font-size: 1.2rem; margin-top: 0.1rem;"></i>
            <div>
              <p style="font-size: 0.85rem; color: var(--neutral-700); margin-bottom: 0.5rem;">Para tu seguridad, todos los retiros se procesan únicamente a cuentas verificadas y que estén a <strong>tu nombre</strong>. No se permiten transferencias a cuentas de terceros.</p>
              <div style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 0.5rem;">
                <a href="#" class="info-link" id="show-security-info">¿Por qué necesito verificar mi cuenta?</a>
                <a href="dudas.html" class="btn btn-outline" style="font-size: 0.75rem; padding: 0 0.75rem; height: 36px; margin-top: -0.5rem;">
                  <i class="fas fa-question-circle"></i> Más preguntas y respuestas
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Tab 2: Operaciones Pendientes -->
      <div class="tab-content" id="pending-tab">
        <div class="pending-transactions" id="pending-transactions-container">
          <div style="text-align: center; margin: 2rem 0; color: var(--neutral-600); display: none;" id="no-pending-message">
            <i class="fas fa-check-circle" style="font-size: 2.5rem; color: var(--neutral-400); margin-bottom: 1rem; display: block;"></i>
            <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">No tienes operaciones pendientes</h3>
            <p style="font-size: 0.85rem;">Todas tus transacciones han sido procesadas</p>
          </div>
          
          <!-- Lista de operaciones pendientes (se populará dinámicamente) -->
          <div id="pending-transactions-list">
            <!-- Ejemplo de operación pendiente -->
            <div class="pending-transaction-item">
              <div class="pending-transaction-icon">
                <i class="fas fa-clock"></i>
              </div>
              <div class="pending-transaction-content">
                <div class="pending-transaction-title">Retiro a Banco de Venezuela</div>
                <div class="pending-transaction-info">
                  <div class="status-badge pending">Pendiente de Verificación</div>
                  <div style="margin-top: 0.35rem; font-size: 0.75rem;">Orden #RET-12345 • 07/05/2025</div>
                </div>
              </div>
              <div class="pending-transaction-amount">Bs 5.000,00</div>
            </div>
            
            <div class="pending-transaction-item">
              <div class="pending-transaction-icon">
                <i class="fas fa-sync-alt"></i>
              </div>
              <div class="pending-transaction-content">
                <div class="pending-transaction-title">Retiro a PayPal</div>
                <div class="pending-transaction-info">
                  <div class="status-badge processing">Procesando</div>
                  <div style="margin-top: 0.35rem; font-size: 0.75rem;">Orden #RET-12346 • 06/05/2025</div>
                </div>
              </div>
              <div class="pending-transaction-amount">$25,00</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Tab 3: Historial -->
      <div class="tab-content" id="history-tab">
        <div class="transaction-history" id="transaction-history-container">
          <div style="text-align: center; margin: 2rem 0; color: var(--neutral-600); display: none;" id="no-history-message">
            <i class="fas fa-history" style="font-size: 2.5rem; color: var(--neutral-400); margin-bottom: 1rem; display: block;"></i>
            <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">No tienes operaciones anteriores</h3>
            <p style="font-size: 0.85rem;">Aquí aparecerán tus transacciones completadas</p>
          </div>
          
          <!-- Lista de historial de transacciones (se populará dinámicamente) -->
          <div id="transaction-history-list">
            <!-- Ejemplo de historial -->
            <div class="transaction-history-item">
              <div class="transaction-history-icon">
                <i class="fas fa-check"></i>
              </div>
              <div class="transaction-history-content">
                <div class="transaction-history-title">Retiro a Pago Móvil</div>
                <div class="transaction-history-info">
                  <div class="status-badge verified">Completado</div>
                  <div style="margin-top: 0.35rem; font-size: 0.75rem;">Banesco • 0414-1234567</div>
                </div>
                <div class="transaction-history-date">05/05/2025 • 15:30</div>
              </div>
              <div class="transaction-history-amount">Bs 3.500,00</div>
            </div>
            
            <div class="transaction-history-item">
              <div class="transaction-history-icon">
                <i class="fas fa-times"></i>
              </div>
              <div class="transaction-history-content">
                <div class="transaction-history-title">Retiro a Banco Provincial</div>
                <div class="transaction-history-info">
                  <div class="status-badge rejected">Rechazado</div>
                  <div style="margin-top: 0.35rem; font-size: 0.75rem;">Cuenta no verificada</div>
                </div>
                <div class="transaction-history-date">01/05/2025 • 09:45</div>
              </div>
              <div class="transaction-history-amount">Bs 10.000,00</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navegación Inferior Rediseñada -->
    <nav class="bottom-nav">
      <a href="#" class="nav-item active" id="nav-create-withdrawal">
        <div class="nav-icon"><i class="fas fa-plus-circle"></i></div>
        <div class="nav-label">Crear Retiro</div>
      </a>
      
      <a href="#" class="nav-item" id="nav-pending-operations">
        <div class="nav-icon"><i class="fas fa-clock"></i></div>
        <div class="nav-label">Pendientes</div>
        <span class="nav-badge">2</span>
      </a>
      
      <a href="#" class="nav-item" id="nav-history">
        <div class="nav-icon"><i class="fas fa-history"></i></div>
        <div class="nav-label">Historial</div>
      </a>
      
      <a href="fororemeex.html" class="nav-item">
        <div class="nav-icon"><i class="fas fa-comments"></i></div>
        <div class="nav-label">Foro</div>
      </a>

      <a href="#" class="nav-item" id="nav-support">
        <div class="nav-icon"><i class="fas fa-headset"></i></div>
        <div class="nav-label">Soporte</div>
      </a>
    </nav>

    <!-- Soporte y Ayuda (se mostrará cuando se presione el botón de soporte) -->
    <div id="support-container" style="display: none; position: fixed; bottom: 65px; left: 0; right: 0; background: white; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); z-index: 899; padding: 1rem; border-top-left-radius: var(--radius-lg); border-top-right-radius: var(--radius-lg); animation: slideInUp 0.3s ease;">
      <div class="section-title" style="margin-bottom: 1rem; display: flex; align-items: center; justify-content: space-between;">
        <span><i class="fas fa-headset"></i> Soporte y Ayuda</span>
        <button id="close-support" style="background: none; border: none; font-size: 1.2rem; color: var(--neutral-700); cursor: pointer;">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="contact-options">
        <a href="https://wa.me/+17373018059" class="contact-option" target="_blank">
          <div class="contact-icon whatsapp">
            <i class="fab fa-whatsapp"></i>
          </div>
          <div class="contact-content">
            <div class="contact-title">WhatsApp</div>
            <div class="contact-description">Atención inmediata las 24 horas</div>
          </div>
        </a>
        
        <a href="mailto:soporte@remeex.com" class="contact-option">
          <div class="contact-icon email">
            <i class="fas fa-envelope"></i>
          </div>
          <div class="contact-content">
            <div class="contact-title">Correo Electrónico</div>
            <div class="contact-description">soporte@remeex.com</div>
          </div>
        </a>

        <a href="#" class="contact-option" id="faq-btn">
          <div class="contact-icon reviews">
            <i class="fas fa-question-circle"></i>
          </div>
          <div class="contact-content">
            <div class="contact-title">Preguntas Frecuentes</div>
            <div class="contact-description">Resuelve tus dudas rápidamente</div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- Modal de Información de Seguridad -->
  <div class="security-info-container" id="security-info-modal">
    <div class="security-info-content">
      <button class="security-info-close" id="close-security-info">
        <i class="fas fa-times"></i>
      </button>
      <h2 style="font-size: 1.5rem; color: var(--primary); margin-bottom: 1rem; text-align: center;">
        Verificación de Seguridad: Protegiendo Tu Dinero
      </h2>
      
      <p style="margin-bottom: 1rem; line-height: 1.6;">
        Entendemos que la verificación puede generar dudas. Sin embargo, esta medida de seguridad es fundamental para proteger tus fondos y asegurar que solo tú puedas retirar dinero a tu cuenta bancaria.
      </p>
      
      <div class="faq-container">
        <div class="faq-item">
          <div class="faq-header">
            ¿Por qué necesito verificar mi cuenta bancaria?
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="faq-content">
            La verificación es la forma más segura de confirmar que la cuenta bancaria a la que quieres enviar tus fondos es realmente tuya. Al hacer un depósito desde tu banco hacia Remeex VISA, nos demuestras que eres tú quien controla esa cuenta. Esto previene que alguien intente desviar tu dinero a una cuenta fraudulenta y es una práctica común en plataformas financieras seguras a nivel internacional.
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-header">
            ¿Perderé el dinero del depósito de verificación?
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="faq-content">
            ¡Absolutamente NO! El depósito de verificación NO es una comisión ni un cobro. Es únicamente un depósito que se suma completamente a tu saldo disponible en tu cuenta Remeex VISA en el mismo instante en que lo recibimos. El monto en bolívares se convierte automáticamente a dólares según la tasa de cambio vigente y sigue siendo tu dinero, listo para usarse o retirarse cuando lo desees.
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-header">
            ¿Tendré que hacer este depósito cada vez que quiera retirar dinero?
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="faq-content">
            No, el proceso de verificación se realiza UNA SOLA VEZ por cada cuenta bancaria que desees registrar. Una vez que tu cuenta bancaria está verificada, podrás realizar retiros a esa cuenta de manera rápida y sencilla, sin tener que repetir el proceso. Si en el futuro deseas agregar otra cuenta bancaria diferente, deberás verificarla por separado.
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-header">
            ¿Por qué no se permiten transferencias a cuentas de terceros?
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="faq-content">
            Por razones de seguridad y para cumplir con las regulaciones bancarias internacionales contra el lavado de dinero (AML) y las políticas de Conozca a su Cliente (KYC), todas las transacciones deben realizarse únicamente entre cuentas que pertenezcan a la misma persona. Esto protege tanto a ti como a nosotros de posibles fraudes, y es un estándar en los servicios financieros globales.
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-header">
            ¿Qué medidas de seguridad utiliza Remeex VISA?
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="faq-content">
            Utilizamos múltiples capas de seguridad de nivel bancario, incluyendo encriptación de extremo a extremo, tokenización de datos sensibles, infraestructura segura con monitoreo constante, y cumplimos con todas las normativas internacionales de seguridad de datos financieros (KYC y AML).
          </div>
        </div>
        
        <div class="faq-item">
          <div class="faq-header">
            ¿Cuánto tiempo tarda en procesarse la verificación?
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="faq-content">
            Una vez que realizas el depósito desde tu banco, generalmente se refleja en tu saldo de Remeex VISA casi instantáneamente o en cuestión de pocos minutos. Tan pronto recibimos la confirmación, tu cuenta queda verificada y los fondos aparecen disponibles en tu saldo. En casos muy raros, dependiendo de la conexión entre bancos, podría demorar un poco más.
          </div>
        </div>
      </div>
      
      <div style="margin-top: 1.5rem; text-align: center;">
        <p style="font-size: 0.9rem; font-weight: 600; color: var(--primary); margin-bottom: 1rem;">
          Tu seguridad es nuestra máxima prioridad
        </p>
        <div style="display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;">
          <button class="btn btn-primary" id="close-security-info-btn" style="max-width: 250px;">
            Entendido
          </button>
          <a href="dudas.html" class="btn btn-outline" style="max-width: 250px;">
            <i class="fas fa-question-circle"></i> Ver más preguntas frecuentes
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Recibo de Retiro -->
  <div class="receipt-overlay" id="receipt-modal">
    <div class="receipt-card">
      <div class="receipt-header">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX" class="receipt-logo">
        <div class="receipt-title">Orden de Retiro Creada</div>
        <div class="receipt-subtitle">Tu solicitud ha sido registrada con éxito</div>
      </div>
      
      <div class="receipt-amount" id="receipt-amount">Bs 0,00</div>
      
      <div class="receipt-details">
        <div class="receipt-detail-row">
          <div class="receipt-detail-label">Número de Orden:</div>
          <div class="receipt-detail-value" id="receipt-order">RET-12345</div>
        </div>
        
        <div class="receipt-detail-row">
          <div class="receipt-detail-label">Fecha:</div>
          <div class="receipt-detail-value" id="receipt-date">7 de Mayo de 2025</div>
        </div>
        
        <div class="receipt-detail-row">
          <div class="receipt-detail-label">Método:</div>
          <div class="receipt-detail-value" id="receipt-method">Pago Móvil</div>
        </div>
        
        <div class="receipt-detail-row">
          <div class="receipt-detail-label">Destino:</div>
          <div class="receipt-detail-value" id="receipt-destination">0424-1234567</div>
        </div>
        
        <div class="receipt-detail-row">
          <div class="receipt-detail-label">Estado:</div>
          <div class="receipt-detail-value">
            <div class="status-badge pending">Pendiente de Verificación</div>
          </div>
        </div>
      </div>
      
      <div style="background: var(--neutral-200); border-radius: var(--radius-md); padding: 0.75rem; margin: 1rem 0; border-left: 3px solid var(--info);">
        <p style="font-size: 0.8rem; color: var(--neutral-700);">
          <i class="fas fa-info-circle" style="color: var(--info);"></i>
          Para completar tu retiro, necesitamos verificar que la cuenta bancaria te pertenece.
        </p>
      </div>
      
      <div class="receipt-actions">
        <button class="btn btn-primary" id="verify-from-receipt">
          <i class="fas fa-shield-alt"></i> Verificar Ahora
        </button>
        
        <button class="btn btn-outline" id="close-receipt">
          <i class="fas fa-times"></i> Cerrar
        </button>
      </div>
      
      <div class="receipt-share" style="margin-top: 1.5rem;">
        <a href="#" class="receipt-share-btn" id="share-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
        <a href="#" class="receipt-share-btn" id="share-email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="#" class="receipt-share-btn" id="share-download">
          <i class="fas fa-download"></i>
        </a>
      </div>
    </div>
  </div>

  <!-- NUEVO: Modal de Confirmación de Verificación -->
  <div class="confirmation-modal" id="verification-confirmation-modal">
    <div class="confirmation-card">
      <div class="confirmation-header">
        <div class="confirmation-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="confirmation-title-container">
          <div class="confirmation-title">Un paso más</div>
          <div class="confirmation-subtitle">Verificación de cuenta necesaria</div>
        </div>
      </div>
      
      <div class="confirmation-content">
        <div class="confirmation-message">
          Para poder completar tu solicitud de retiro, necesitamos confirmar que la cuenta bancaria es tuya. Este es un proceso único de seguridad.
        </div>
        
        <div class="confirmation-step">
          <div class="confirmation-step-number">1</div>
          <div class="confirmation-step-text">
            Te dirigiremos a la página de <strong>Recargar Saldo</strong> para realizar un depósito de verificación de <strong>Bs 2.845,50</strong> ($25 USD).
          </div>
        </div>
        
        <div class="confirmation-step">
          <div class="confirmation-step-number">2</div>
          <div class="confirmation-step-text">
            Este depósito se sumará automáticamente a tu saldo disponible.
          </div>
        </div>
        
        <div class="confirmation-step">
          <div class="confirmation-step-number">3</div>
          <div class="confirmation-step-text">
            Al verificar tu cuenta, podrás retirar fondos sin limitaciones en el futuro.
          </div>
        </div>
      </div>
      
      <div class="confirmation-actions">
        <button class="confirmation-btn confirmation-btn-primary" id="confirmation-proceed-btn">
          <i class="fas fa-check-circle"></i> Entiendo, continuar
        </button>
        <button class="confirmation-btn confirmation-btn-secondary" id="confirmation-cancel-btn">
          <i class="fas fa-times-circle"></i> Cancelar
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="spinner"></div>
    <div class="loading-text" id="loading-text">Procesando tu solicitud...</div>
    <div class="progress-bar-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
  </div>

  <!-- Contenedor de Toast -->
  <div class="toast-container" id="toast-container"></div>
  
  <!-- Tiempo restante antes de redirección por inactividad -->
  <div class="time-remaining" id="time-remaining" style="display: none;">
    <div>Sesión inactiva. Redirigiendo en <span id="redirect-countdown">60</span> segundos</div>
    <div class="time-remaining-progress" id="time-remaining-progress"></div>
  </div>

  <!-- Script -->
  <script>
    // Configuración de valores constantes con tasa de cambio centralizada
    const CONFIG = {
      EXCHANGE_RATES: {
        USD_TO_BS: 134.24,  // Tasa centralizada
        USD_TO_EUR: 0.94
      },
      STORAGE_KEYS: {
        USER_DATA: 'remeexUserData',
        BALANCE: 'remeexBalance',
        TRANSACTIONS: 'remeexTransactions',
        VERIFICATION: 'remeexVerificationStatus',
        TRANSFER_DATA: 'remeexTransferData',
        REFERRER: 'remeexReferrer',
        TRANSACTION_HISTORY: 'remeexTransactionHistory',
        PENDING_TRANSACTIONS: 'remeexPendingTransactions',
        VERIFICATION_CONFIRMATION: 'remeexVerificationConfirmed' // NUEVO: guarda si el usuario confirmó la verificación
      },
      LIMITS: {
        MOBILE: 250000, // 250,000 Bs
        BANK: 1000000 // 1,000,000 Bs
      },
      BANKS: {
        NACIONAL: [
          { id: 'banco-venezuela', name: 'Banco de Venezuela', logo: 'https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png' },
          { id: 'banco-venezolano', name: 'Banco Venezolano de Crédito', logo: 'https://www.venezolano.com/images/galeria/108_1.png' },
          { id: 'banco-mercantil', name: 'Banco Mercantil', logo: 'https://files.socialgest.net/mybio/5f529398b36f8_1599247256.png' },
          { id: 'banco-provincial', name: 'Banco Provincial', logo: 'https://upload.wikimedia.org/wikipedia/commons/d/d4/BBVAprovinciallogo.svg' },
          { id: 'banco-bancaribe', name: 'Banco del Caribe (Bancaribe)', logo: 'https://d3olc33sy92l9e.cloudfront.net/wp-content/themes/bancaribe/images/Bancaribe-LogotipoTurquesa.png' },
          { id: 'banco-exterior', name: 'Banco Exterior', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/Banco-Exterior-VE-logo.png/183px-Banco-Exterior-VE-logo.png' },
          { id: 'banco-caroni', name: 'Banco Caroní', logo: 'https://e7.pngegg.com/pngimages/127/511/png-clipart-bank-computer-icons-bank-building-bank.png' },
          { id: 'banco-banesco', name: 'Banesco', logo: 'https://banesco-prod-2020.s3.amazonaws.com/wp-content/themes/banescocontigo/assets/images/header/logo.svg.gzip' },
          { id: 'banco-sofitasa', name: 'Banco Sofitasa', logo: 'https://www.sofitasa.com/assets/img/nuevo_logo.png' },
          { id: 'banco-plaza', name: 'Banco Plaza', logo: 'https://plazacdn.s3.amazonaws.com/wp-content/themes/bancoplaza/imagenes/logobancoplaza-2.png' },
          { id: 'banco-bancofc', name: 'Banco Fondo Común', logo: 'https://www.bfc.com.ve/wp-content/uploads/2021/01/logofos.png' },
          { id: 'banco-100banco', name: '100% Banco', logo: 'https://www.100x100banco.com/img/logo.png' },
          { id: 'banco-tesoro', name: 'Banco del Tesoro', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Logo_Banco_del_Tesoro.jpg/320px-Logo_Banco_del_Tesoro.jpg' },
          { id: 'banco-bancrecer', name: 'Bancrecer', logo: 'https://www.bancrecer.com.ve/images/img/bancrecer-logo.png' },
          { id: 'banco-activo', name: 'Banco Activo', logo: 'https://www.bancoactivo.com/logo.svg' },
          { id: 'banco-bancamiga', name: 'Bancamiga', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a3/Bancamiga.png/320px-Bancamiga.png' },
          { id: 'banco-bicentenario', name: 'Banco Bicentenario', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/BancoDigitaldelosTrabajadores.png/320px-BancoDigitaldelosTrabajadores.png' },
          { id: 'banco-bnc', name: 'Banco Nacional de Crédito', logo: 'https://www.bncenlinea.com/images/default-source/misc/BNCLogo_rebrand.png' },
          { id: 'banco-bcv', name: 'Banco Central de Venezuela', logo: 'https://www.bcv.org.ve/sites/default/files/default_images/logo_bcv-04_2.png' }
        ],
        INTERNACIONAL: [
          { id: 'bank-america', name: 'Bank of America', logo: 'https://1000logos.net/wp-content/uploads/2016/10/Bank-of-America-Logo.png' },
          { id: 'chase-bank', name: 'Chase Bank', logo: 'https://download.logo.wine/logo/Chase_Bank/Chase_Bank-Logo.wine.png' },
          { id: 'bancolombia', name: 'Bancolombia', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Logo_Bancolombia.svg/2000px-Logo_Bancolombia.svg.png' },
          { id: 'western-union', name: 'Western Union', logo: 'https://logos-world.net/wp-content/uploads/2023/03/Western-Union-Logo.png' }
        ],
        FINTECH: [
          { id: 'zinli', name: 'Zinli', logo: 'https://images.seeklogo.com/logo-png/41/1/zinli-logo-png_seeklogo-411354.png' },
          { id: 'paypal', name: 'PayPal', logo: 'https://upload.wikimedia.org/wikipedia/commons/a/a4/Paypal_2014_logo.png' },
          { id: 'binance', name: 'Binance', logo: 'https://www.logo.wine/a/logo/Binance/Binance-Logo.wine.svg' },
          { id: 'airtm', name: 'AirTM', logo: 'https://brandlogovector.com/wp-content/uploads/2023/08/Airtm-Logo-PNG.png' },
          { id: 'zoom', name: 'Zoom', logo: 'https://zoom.red/wp-content/uploads/2021/01/Logo-Zoom-Registrado.png' },
          { id: 'zelle', name: 'Zelle', logo: 'https://download.logo.wine/logo/Zelle_(payment_service)/Zelle_(payment_service)-Logo.wine.png' },
          { id: 'venmo', name: 'Venmo', logo: 'https://logos-world.net/wp-content/uploads/2021/12/Venmo-Logo.png' },
          { id: 'nequi', name: 'Nequi', logo: 'https://images.seeklogo.com/logo-png/40/1/nequi-logo-png_seeklogo-404357.png' },
          { id: 'wise', name: 'Wise', logo: 'https://icon2.cleanpng.com/lnd/20250116/qj/27d09a29b3056c595b6e2d995a15b5.webp' },
          { id: 'revolut', name: 'Revolut', logo: 'https://e7.pngegg.com/pngimages/739/64/png-clipart-revolut-black-new-logo-tech-companies.png' },
          { id: 'eldorado', name: 'El Dorado', logo: 'https://eldorado.io/static/f4ed8a521b10baed657858830cac133c/58556/logo.webp' },
          { id: 'ubii', name: 'Ubii Pagos', logo: 'https://www.ubiipagos.com/img/new-home/ubiipagos_logo_home_dark.svg' }
        ]
      },
      INACTIVITY_TIMEOUT: 120, // 2 minutos de inactividad antes de redirección
      VERIFICATION_CODE: Math.floor(10000 + Math.random() * 90000), // Código de verificación aleatorio
      VERIFICATION_AMOUNT_USD: 25, // Monto de verificación en USD
      get VERIFICATION_AMOUNT_BS() {
        // Calcula el monto de verificación en Bs basado en la tasa de cambio actualizada
        return (this.VERIFICATION_AMOUNT_USD * this.EXCHANGE_RATES.USD_TO_BS).toFixed(2);
      }
    };

    // Variables globales
    let currentUser = {
      name: '',
      email: '',
      balance: {
        usd: 0,
        bs: 0,
        eur: 0
      },
      isVerified: false
    };

    let selectedMethod = 'mobile';
    let activeUsersCount = 0;
    let withdrawalAmount = 0;
    let withdrawalAmountUsd = 0;
    let withdrawalAmountEur = 0;
    let userLastActivity = Date.now();
    let inactivityTimer = null;
    let inactivityCountdown = CONFIG.INACTIVITY_TIMEOUT;
    let verificationInProgress = false;
    let selectedBank = {
      mobile: null,
      bank: null
    };
    
    // NUEVO: Verificar si el usuario ha leído y aceptado la verificación
    let userHasConfirmedVerification = false;
    
    // Datos de transacciones para almacenar historial
    let transactionHistory = [];
    let pendingTransactions = [];
    let testimonialIndex = 0;
    let testimonialInterval = null;
    
    // DOM Ready
    document.addEventListener('DOMContentLoaded', function() {
      // Iniciar aplicación
      initApp();
      
      // Configurar event listeners
      setupEventListeners();
      
      // Cargar datos del usuario
      loadUserDataFromSession();
      
      // Llenar grillas de logos de bancos
      populateBankLogos();
      
      // Configurar timer de inactividad
      setupInactivityTimer();
      
      // Cargar historial de transacciones
      loadTransactionHistory();
      
      // Iniciar slider de testimonios
      startTestimonialSlider();
      
      // Actualizar estadísticas en tiempo real
      startLiveStatsUpdates();
      
      // Inicializar visualización de flujo de fondos
      updateFundsJourney();
      
      // Actualizar monto de verificación en la guía
      updateVerificationAmountInGuide();
      
      // NUEVO: Configurar checkbox de verificación
      setupVerificationCheckbox();
      
      // NUEVO: Hacer scroll automáticamente a la guía de verificación
      setTimeout(function() {
        const verificationGuide = document.getElementById('verification-guide-enhanced');
        if (verificationGuide && !userHasConfirmedVerification) {
          verificationGuide.scrollIntoView({ behavior: 'smooth', block: 'center' });
          // Resaltar el elemento con un destello
          highlightElement(verificationGuide);
        }
      }, 500);
      
      // Configurar la navegación inferior rediseñada
      setupBottomNav();
    });
    
    // Configurar la navegación inferior rediseñada
    function setupBottomNav() {
      // Manejar clic en navegación inferior
      document.getElementById('nav-create-withdrawal').addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelector('.tab-item[data-tab="new-withdrawal"]').click();
        updateActiveNavItem('nav-create-withdrawal');
      });
      
      document.getElementById('nav-pending-operations').addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelector('.tab-item[data-tab="pending"]').click();
        updateActiveNavItem('nav-pending-operations');
      });
      
      document.getElementById('nav-history').addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelector('.tab-item[data-tab="history"]').click();
        updateActiveNavItem('nav-history');
      });
      
      document.getElementById('nav-support').addEventListener('click', function(e) {
        e.preventDefault();
        toggleSupportContainer();
        updateActiveNavItem('nav-support');
      });
      
      // Cerrar panel de soporte
      document.getElementById('close-support').addEventListener('click', function() {
        document.getElementById('support-container').style.display = 'none';
        updateActiveNavItem('nav-create-withdrawal');
      });
      
      // Sincronizar tabs con navegación
      document.querySelectorAll('.tab-item').forEach(tab => {
        tab.addEventListener('click', function() {
          const tabId = this.getAttribute('data-tab');
          if (tabId === 'new-withdrawal') {
            updateActiveNavItem('nav-create-withdrawal');
          } else if (tabId === 'pending') {
            updateActiveNavItem('nav-pending-operations');
          } else if (tabId === 'history') {
            updateActiveNavItem('nav-history');
          }
        });
      });
    }
    
    // Alternar panel de soporte
    function toggleSupportContainer() {
      const supportContainer = document.getElementById('support-container');
      if (supportContainer.style.display === 'block') {
        supportContainer.style.display = 'none';
      } else {
        supportContainer.style.display = 'block';
      }
    }
    
    // Actualizar ítem activo en navegación
    function updateActiveNavItem(activeId) {
      document.querySelectorAll('.bottom-nav .nav-item').forEach(item => {
        item.classList.remove('active');
      });
      document.getElementById(activeId).classList.add('active');
    }
    
    // NUEVO: Resaltar un elemento con un efecto de destello
    function highlightElement(element) {
      // Guardar el color de fondo original
      const originalBackground = element.style.background;
      
      // Crear una animación de destello
      element.style.transition = 'background 1s ease';
      element.style.background = 'rgba(26, 31, 113, 0.2)';
      
      // Restaurar el color original después de un tiempo
      setTimeout(function() {
        element.style.background = originalBackground;
      }, 1000);
    }
    
    // NUEVO: Configurar checkbox de verificación
    function setupVerificationCheckbox() {
      const checkbox = document.getElementById('verification-confirmation-checkbox');
      const submitBtn = document.getElementById('submit-withdrawal');
      const checkboxContainer = document.getElementById('verification-checkbox-container');
      
      if (checkbox && submitBtn) {
        // Verificar si el usuario ya ha confirmado previamente
        try {
          userHasConfirmedVerification = sessionStorage.getItem(CONFIG.STORAGE_KEYS.VERIFICATION_CONFIRMATION) === 'true';
          
          if (userHasConfirmedVerification) {
            checkbox.checked = true;
            submitBtn.disabled = false;
            
            if (checkboxContainer) {
              checkboxContainer.classList.add('checked');
            }
          }
        } catch (e) {
          console.error('Error al cargar confirmación de verificación:', e);
        }
        
        // Event listener para el checkbox
        checkbox.addEventListener('change', function() {
          submitBtn.disabled = !this.checked;
          
          // Actualizar estado de checkbox container
          if (checkboxContainer) {
            if (this.checked) {
              checkboxContainer.classList.add('checked');
            } else {
              checkboxContainer.classList.remove('checked');
            }
          }
          
          // Guardar preferencia del usuario
          try {
            userHasConfirmedVerification = this.checked;
            sessionStorage.setItem(CONFIG.STORAGE_KEYS.VERIFICATION_CONFIRMATION, this.checked);
          } catch (e) {
            console.error('Error al guardar confirmación de verificación:', e);
          }
          
          // Mostrar un toast al marcar el checkbox
          if (this.checked) {
            showToast('success', 'Confirmado', 'Has confirmado que entiendes el proceso de verificación');
          }
        });
      }
    }
    
    // Inicialización de la aplicación
    function initApp() {
      // Configurar contadores aleatorios
      updateOnlineUsersCount();
      
      // Generar código de verificación aleatorio
      generateVerificationCode();
      
      // Actualizar fecha en el recibo
      updateReceiptDate();
    }
    
    // Actualizar monto de verificación en la guía
    function updateVerificationAmountInGuide() {
      // Formatear monto en Bs para mostrar en la guía
      const verificationAmountBs = formatNumberWithCommas(CONFIG.VERIFICATION_AMOUNT_BS);
      
      // Actualizar todos los montos de verificación en la página
      const verificationAmountElements = document.querySelectorAll('.verification-amount-highlight');
      verificationAmountElements.forEach(element => {
        element.textContent = `Bs ${verificationAmountBs}`;
      });
      
      // Actualizar el texto del checkbox de confirmación
      const checkboxLabel = document.querySelector('.checkbox-label');
      if (checkboxLabel) {
        checkboxLabel.innerHTML = `He leído y entiendo que debo realizar un depósito de verificación de <strong>Bs ${verificationAmountBs}</strong> (equivalente a $${CONFIG.VERIFICATION_AMOUNT_USD} USD) para completar mi retiro. Este monto se sumará a mi saldo disponible.`;
      }
      
      // Actualizar texto en el modal de confirmación
      const confirmationStepText = document.querySelector('.confirmation-step-text strong:last-child');
      if (confirmationStepText) {
        confirmationStepText.textContent = `Bs ${verificationAmountBs}`;
      }
    }
    
    // Iniciar slider de testimonios
    function startTestimonialSlider() {
      testimonialInterval = setInterval(function() {
        const slider = document.getElementById('testimonial-slider');
        if (!slider) return;
        
        const testimonials = slider.querySelectorAll('.testimonial');
        if (!testimonials.length) return;
        
        testimonialIndex = (testimonialIndex + 1) % testimonials.length;
        slider.style.transform = `translateX(-${testimonialIndex * 100}%)`;
      }, 5000);
    }
    
    // Actualizar estadísticas en tiempo real
    function startLiveStatsUpdates() {
      setInterval(function() {
        // Aumentar aleatoriamente el número de usuarios verificados
        const usuariosElement = document.getElementById('stat-usuarios');
        if (usuariosElement) {
          const currentUsuarios = parseInt(usuariosElement.textContent.replace(/\./g, ''));
          const newUsuarios = currentUsuarios + Math.floor(Math.random() * 3);
          usuariosElement.textContent = formatThousands(newUsuarios);
        }
        
        // Aumentar aleatoriamente el número de retiros
        const retirosElement = document.getElementById('stat-retiros');
        if (retirosElement) {
          const currentRetiros = parseInt(retirosElement.textContent.replace(/\./g, ''));
          const newRetiros = currentRetiros + Math.floor(Math.random() * 2);
          retirosElement.textContent = formatThousands(newRetiros);
        }
      }, 20000);
    }
    
    // Formatear números con separadores de miles
    function formatThousands(number) {
      return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }
    
    // Cargar historial de transacciones
    function loadTransactionHistory() {
      try {
        // Cargar historial de sessionStorage
        const historyJson = sessionStorage.getItem(CONFIG.STORAGE_KEYS.TRANSACTION_HISTORY);
        if (historyJson) {
          transactionHistory = JSON.parse(historyJson);
        } else {
          // Crear historial de ejemplo solo si no existe
          transactionHistory = [
            {
              id: 'RET-54321',
              amount: 3500,
              method: 'mobile',
              destination: '0414-1234567',
              bankName: 'Banesco',
              status: 'completed',
              date: '2025-05-05T15:30:00',
              formattedDate: '05/05/2025 • 15:30'
            },
            {
              id: 'RET-54322',
              amount: 10000,
              method: 'bank',
              destination: '****1234',
              bankName: 'Banco Provincial',
              status: 'rejected',
              reason: 'Cuenta no verificada',
              date: '2025-05-01T09:45:00',
              formattedDate: '01/05/2025 • 09:45'
            }
          ];
          
          // Guardar en sessionStorage
          sessionStorage.setItem(CONFIG.STORAGE_KEYS.TRANSACTION_HISTORY, JSON.stringify(transactionHistory));
        }
        
        // Cargar transacciones pendientes
        const pendingJson = sessionStorage.getItem(CONFIG.STORAGE_KEYS.PENDING_TRANSACTIONS);
        if (pendingJson) {
          pendingTransactions = JSON.parse(pendingJson);
        } else {
          // Crear pendientes de ejemplo solo si no existe
          pendingTransactions = [
            {
              id: 'RET-12345',
              amount: 5000,
              method: 'mobile',
              destination: '0424-7654321',
              bankName: 'Banco de Venezuela',
              status: 'pending_verification',
              date: '2025-05-07T10:15:00',
              formattedDate: '07/05/2025'
            },
            {
              id: 'RET-12346',
              amount: 25,
              method: 'international',
              destination: 'usuario@ejemplo.com',
              bankName: 'PayPal',
              status: 'processing',
              date: '2025-05-06T14:30:00',
              formattedDate: '06/05/2025'
            }
          ];
          
          // Guardar en sessionStorage
          sessionStorage.setItem(CONFIG.STORAGE_KEYS.PENDING_TRANSACTIONS, JSON.stringify(pendingTransactions));
        }
        
        // Actualizar UI con los datos cargados
        updateTransactionHistoryUI();
        updatePendingTransactionsUI();
        
        // Actualizar contador de notificaciones en la navegación inferior
        updateNavBadges();
        
      } catch (e) {
        console.error('Error al cargar historial de transacciones:', e);
      }
    }
    
    // Actualizar badges de notificación en la navegación
    function updateNavBadges() {
      const pendingCount = pendingTransactions.length;
      const navBadge = document.querySelector('.nav-badge');
      
      if (navBadge) {
        if (pendingCount > 0) {
          navBadge.textContent = pendingCount;
          navBadge.style.display = 'flex';
        } else {
          navBadge.style.display = 'none';
        }
      }
    }
    
    // Actualizar UI de historial de transacciones
    function updateTransactionHistoryUI() {
      const historyList = document.getElementById('transaction-history-list');
      const noHistoryMessage = document.getElementById('no-history-message');
      
      if (!historyList) return;
      
      // Limpiar lista actual
      historyList.innerHTML = '';
      
      // Mostrar mensaje si no hay historial
      if (transactionHistory.length === 0) {
        if (noHistoryMessage) noHistoryMessage.style.display = 'block';
        return;
      } else {
        if (noHistoryMessage) noHistoryMessage.style.display = 'none';
      }
      
      // Crear elementos de historial
      transactionHistory.forEach(transaction => {
        const transactionItem = document.createElement('div');
        transactionItem.className = 'transaction-history-item';
        
        // Icono según estado
        const iconClass = transaction.status === 'completed' ? 'fas fa-check' : 'fas fa-times';
        const statusText = transaction.status === 'completed' ? 'Completado' : 'Rechazado';
        const statusClass = transaction.status === 'completed' ? 'verified' : 'rejected';
        
        // Determinar título según método
        let titleText = '';
        if (transaction.method === 'mobile') {
          titleText = 'Retiro a Pago Móvil';
        } else if (transaction.method === 'bank') {
          titleText = `Retiro a ${transaction.bankName || 'Banco'}`;
        } else if (transaction.method === 'international') {
          titleText = `Retiro Internacional - ${transaction.bankName || ''}`;
        }
        
        transactionItem.innerHTML = `
          <div class="transaction-history-icon">
            <i class="${iconClass}"></i>
          </div>
          <div class="transaction-history-content">
            <div class="transaction-history-title">${titleText}</div>
            <div class="transaction-history-info">
              <div class="status-badge ${statusClass}">${statusText}</div>
              <div style="margin-top: 0.35rem; font-size: 0.75rem;">${transaction.bankName || ''} • ${transaction.destination || ''}</div>
              ${transaction.reason ? `<div style="margin-top: 0.25rem; font-size: 0.75rem; color: var(--danger);">${transaction.reason}</div>` : ''}
            </div>
            <div class="transaction-history-date">${transaction.formattedDate}</div>
          </div>
          <div class="transaction-history-amount">${formatCurrency(transaction.amount, transaction.method === 'international' ? 'usd' : 'bs')}</div>
        `;
        
        historyList.appendChild(transactionItem);
      });
    }
    
    // Actualizar UI de transacciones pendientes
    function updatePendingTransactionsUI() {
      const pendingList = document.getElementById('pending-transactions-list');
      const noPendingMessage = document.getElementById('no-pending-message');
      
      if (!pendingList) return;
      
      // Limpiar lista actual
      pendingList.innerHTML = '';
      
      // Mostrar mensaje si no hay pendientes
      if (pendingTransactions.length === 0) {
        if (noPendingMessage) noPendingMessage.style.display = 'block';
        return;
      } else {
        if (noPendingMessage) noPendingMessage.style.display = 'none';
      }
      
      // Crear elementos de transacciones pendientes
      pendingTransactions.forEach(transaction => {
        const pendingItem = document.createElement('div');
        pendingItem.className = 'pending-transaction-item';
        
        // Icono según estado
        let iconClass = 'fas fa-clock';
        let statusText = 'Pendiente';
        let statusClass = 'pending';
        
        if (transaction.status === 'pending_verification') {
          iconClass = 'fas fa-clock';
          statusText = 'Pendiente de Verificación';
          statusClass = 'pending';
        } else if (transaction.status === 'processing') {
          iconClass = 'fas fa-sync-alt';
          statusText = 'Procesando';
          statusClass = 'processing';
        }
        
        // Determinar título según método
        let titleText = '';
        if (transaction.method === 'mobile') {
          titleText = 'Retiro a Pago Móvil';
        } else if (transaction.method === 'bank') {
          titleText = `Retiro a ${transaction.bankName || 'Banco'}`;
        } else if (transaction.method === 'international') {
          titleText = `Retiro Internacional - ${transaction.bankName || ''}`;
        }
        
        pendingItem.innerHTML = `
          <div class="pending-transaction-icon">
            <i class="${iconClass}"></i>
          </div>
          <div class="pending-transaction-content">
            <div class="pending-transaction-title">${titleText}</div>
            <div class="pending-transaction-info">
              <div class="status-badge ${statusClass}">${statusText}</div>
              <div style="margin-top: 0.35rem; font-size: 0.75rem;">Orden #${transaction.id} • ${transaction.formattedDate}</div>
            </div>
          </div>
          <div class="pending-transaction-amount">${formatCurrency(transaction.amount, transaction.method === 'international' ? 'usd' : 'bs')}</div>
        `;
        
        pendingList.appendChild(pendingItem);
      });
      
      // Actualizar badges en navegación
      updateNavBadges();
    }
    
    // Agregar nueva transacción pendiente y actualizar UI
    function addPendingTransaction(transaction) {
      // Agregar a la lista
      pendingTransactions.unshift(transaction);
      
      // Guardar en sessionStorage
      try {
        sessionStorage.setItem(CONFIG.STORAGE_KEYS.PENDING_TRANSACTIONS, JSON.stringify(pendingTransactions));
      } catch (e) {
        console.error('Error al guardar transacción pendiente:', e);
      }
      
      // Actualizar UI
      updatePendingTransactionsUI();
    }
    
    // Configurar timer de inactividad
    function setupInactivityTimer() {
      // Reset timer cada vez que el usuario interactúa
      const userEvents = ['mousemove', 'mousedown', 'keypress', 'touchstart', 'scroll'];
      
      userEvents.forEach(event => {
        document.addEventListener(event, resetInactivityTimer);
      });
      
      // Iniciar timer de inactividad
      startInactivityTimer();
    }
    
    // Reiniciar timer de inactividad
    function resetInactivityTimer() {
      userLastActivity = Date.now();
      inactivityCountdown = CONFIG.INACTIVITY_TIMEOUT;
      
      // Ocultar contador si está visible
      const timeRemaining = document.getElementById('time-remaining');
      if (timeRemaining) timeRemaining.style.display = 'none';
      
      // Reiniciar timer
      if (inactivityTimer) {
        clearInterval(inactivityTimer);
      }
      startInactivityTimer();
    }
    
    // Iniciar timer de inactividad
    function startInactivityTimer() {
      inactivityTimer = setInterval(function() {
        const currentTime = Date.now();
        const timeSinceLastActivity = (currentTime - userLastActivity) / 1000; // en segundos
        
        if (timeSinceLastActivity >= CONFIG.INACTIVITY_TIMEOUT) {
          clearInterval(inactivityTimer);
          redirectDueToInactivity();
        } else if (timeSinceLastActivity >= CONFIG.INACTIVITY_TIMEOUT - 60) { // Mostrar contador 60 segundos antes de redirección
          showInactivityCountdown(Math.floor(CONFIG.INACTIVITY_TIMEOUT - timeSinceLastActivity));
        }
      }, 1000);
    }
    
    // Mostrar cuenta regresiva de inactividad
    function showInactivityCountdown(seconds) {
      const timeRemaining = document.getElementById('time-remaining');
      const redirectCountdown = document.getElementById('redirect-countdown');
      const timeRemainingProgress = document.getElementById('time-remaining-progress');
      
      if (timeRemaining) timeRemaining.style.display = 'block';
      if (redirectCountdown) redirectCountdown.textContent = seconds;
      
      // Actualizar barra de progreso
      if (timeRemainingProgress) {
        const progressWidth = (seconds / 60) * 100;
        timeRemainingProgress.style.width = `${progressWidth}%`;
      }
    }
    
    // Redireccionar por inactividad
    function redirectDueToInactivity() {
      showToast('info', 'Sesión Inactiva', 'Redirigiendo a la página principal por inactividad...');
      
      setTimeout(function() {
        window.location.href = 'recarga.html';
      }, 2000);
    }

    // Generar código de verificación aleatorio
    function generateVerificationCode() {
      const verificationRef = document.getElementById('verification-reference');
      const verificationRefPagoMovil = document.getElementById('verification-reference-pago-movil');
      const receiptOrder = document.getElementById('receipt-order');
      
      const randomCode = CONFIG.VERIFICATION_CODE;
      
      if (verificationRef) verificationRef.textContent = randomCode;
      if (verificationRefPagoMovil) verificationRefPagoMovil.textContent = randomCode;
      if (receiptOrder) receiptOrder.textContent = `RET-${randomCode}`;
      
      // Actualizar los atributos data-copy de los botones de copia
      const copyBtn = document.getElementById('reference-copy-btn');
      if (copyBtn) copyBtn.setAttribute('data-copy', `VER${randomCode}`);
      
      const copyBtnPagoMovil = document.getElementById('reference-pago-movil-copy-btn');
      if (copyBtnPagoMovil) copyBtnPagoMovil.setAttribute('data-copy', `VER${randomCode}`);
    }

    // Actualizar fecha en el recibo
    function updateReceiptDate() {
      const receiptDate = document.getElementById('receipt-date');
      
      const date = new Date();
      const options = { day: 'numeric', month: 'long', year: 'numeric' };
      const formattedDate = date.toLocaleDateString('es-ES', options);
      
      if (receiptDate) receiptDate.textContent = formattedDate;
    }

    // Cargar datos del usuario desde sessionStorage
    function loadUserDataFromSession() {
      // Constantes para claves de sessionStorage
      const STORAGE_KEYS = {
        BALANCE: 'remeexSessionBalance',
        EXCHANGE_RATE: 'remeexSessionExchangeRate',
        TRANSFER_DATA: 'remeexTransferData',
        VERIFICATION_STATUS: 'remeexVerificationStatus'
      };
      
      // Recuperar balance y tasa de cambio
      try {
        // Recuperar balance
        const balanceJson = sessionStorage.getItem(STORAGE_KEYS.BALANCE);
        if (balanceJson) {
          const balance = JSON.parse(balanceJson);
          
          // Actualizar balance del usuario
          currentUser.balance = balance;
        }
        
        // Recuperar estado de verificación
        const verificationStatus = sessionStorage.getItem(STORAGE_KEYS.VERIFICATION_STATUS);
        if (verificationStatus) {
          currentUser.isVerified = verificationStatus === 'verified';
          verificationInProgress = verificationStatus === 'in_progress';
        }
        
        // Recuperar tasa de cambio
        const exchangeRateJson = sessionStorage.getItem(STORAGE_KEYS.EXCHANGE_RATE);
        if (exchangeRateJson) {
          const rates = JSON.parse(exchangeRateJson);
          
          // Actualizar tasas de cambio
          if (rates.USD_TO_BS) CONFIG.EXCHANGE_RATES.USD_TO_BS = rates.USD_TO_BS;
          if (rates.USD_TO_EUR) CONFIG.EXCHANGE_RATES.USD_TO_EUR = rates.USD_TO_EUR;
        }
        
        // Recuperar datos de transferencia si existen
        const transferDataJson = sessionStorage.getItem(STORAGE_KEYS.TRANSFER_DATA);
        if (transferDataJson) {
          const transferData = JSON.parse(transferDataJson);
          
          // Si hay un monto de transferencia guardado, rellenarlo
          if (transferData.amount) {
            const amountInput = document.getElementById('withdrawal-amount');
            if (amountInput) {
              amountInput.value = formatNumberWithCommas(transferData.amount);
              // Disparar evento input para calcular equivalentes
              const event = new Event('input');
              amountInput.dispatchEvent(event);
            }
          }
        }
      } catch (e) {
        console.error('Error al cargar datos de sesión:', e);
      }
      
      // Intentar cargar desde sessionStorage antiguo (compatibilidad)
      if (currentUser.balance.bs === 0) {
        const balanceData = sessionStorage.getItem(CONFIG.STORAGE_KEYS.BALANCE);
        const userData = sessionStorage.getItem(CONFIG.STORAGE_KEYS.USER_DATA);
        const verificationStatus = sessionStorage.getItem(CONFIG.STORAGE_KEYS.VERIFICATION);
        
        if (balanceData) {
          try {
            currentUser.balance = JSON.parse(balanceData);
          } catch (e) {
            console.error('Error al parsear datos de balance:', e);
          }
        }
        
        if (userData) {
          try {
            const user = JSON.parse(userData);
            currentUser.name = user.name || '';
            currentUser.email = user.email || '';
          } catch (e) {
            console.error('Error al parsear datos de usuario:', e);
          }
        }
        
        if (verificationStatus) {
          currentUser.isVerified = verificationStatus === 'verified';
          verificationInProgress = verificationStatus === 'in_progress';
        }
      }
      
      // Actualizar la interfaz con los datos cargados
      updateBalanceDisplay();
      
      // Si la verificación está en progreso, mostrar el contenedor de estado
      if (verificationInProgress) {
        const verificationStatusContainer = document.getElementById('verification-status-container');
        if (verificationStatusContainer) {
          verificationStatusContainer.style.display = 'block';
        }
        
        // Ocultar banner de verificación si está en progreso
        const verifyBanner = document.getElementById('verify-banner');
        if (verifyBanner) {
          verifyBanner.style.display = 'none';
        }
      } else if (!currentUser.isVerified) {
        // Mostrar banner de verificación si no está verificado
        const verifyBanner = document.getElementById('verify-banner');
        if (verifyBanner) {
          verifyBanner.style.display = 'flex';
        }
      }
    }

    // Configurar event listeners
    function setupEventListeners() {
      // Event listeners para pestañas
      setupTabsEventListeners();
      
      // Manejo de la cantidad a retirar
      setupAmountInput();
      
      // Selección de método de retiro
      setupMethodSelection();
      
      // Selección de logos de bancos
      setupBankLogoSelection();
      
      // Manejo del formulario internacional
      setupInternationalForm();
      
      // Botones de verificación
      setupVerificationButtons();
      
      // Botón de envío del formulario
      setupSubmitButton();
      
      // Botones de copia
      setupCopyButtons();
      
      // Botones del recibo
      setupReceiptButtons();
      
      // Botones de información de seguridad
      setupSecurityInfoButtons();
      
      // Botones de FAQ
      setupFaqButtons();
      
      // Botones de estado de verificación
      setupVerificationStatusButtons();
      
      // NUEVO: Configurar modal de confirmación
      setupConfirmationModal();
    }
    
    // NUEVO: Configurar modal de confirmación
    function setupConfirmationModal() {
      const modal = document.getElementById('verification-confirmation-modal');
      const proceedBtn = document.getElementById('confirmation-proceed-btn');
      const cancelBtn = document.getElementById('confirmation-cancel-btn');
      
      if (proceedBtn) {
        proceedBtn.addEventListener('click', function() {
          // Ocultar modal
          if (modal) modal.style.display = 'none';
          
          // Redirigir a página de recarga
          window.location.href = 'recarga.html';
        });
      }
      
      if (cancelBtn) {
        cancelBtn.addEventListener('click', function() {
          // Ocultar modal
          if (modal) modal.style.display = 'none';
        });
      }
    }
    
    // Configurar event listeners para pestañas
    function setupTabsEventListeners() {
      const tabItems = document.querySelectorAll('.tab-item');
      if (!tabItems.length) return;
      
      tabItems.forEach(tab => {
        tab.addEventListener('click', function() {
          // Desactivar todas las pestañas
          tabItems.forEach(item => {
            item.classList.remove('active');
          });
          
          // Activar la pestaña seleccionada
          this.classList.add('active');
          
          // Ocultar todos los contenidos de pestañas
          const tabContents = document.querySelectorAll('.tab-content');
          tabContents.forEach(content => {
            content.classList.remove('active');
          });
          
          // Mostrar el contenido de la pestaña seleccionada
          const tabId = this.getAttribute('data-tab');
          const activeContent = document.getElementById(`${tabId}-tab`);
          if (activeContent) {
            activeContent.classList.add('active');
          }
          
          // Actualizar navegación inferior
          if (tabId === 'new-withdrawal') {
            updateActiveNavItem('nav-create-withdrawal');
          } else if (tabId === 'pending') {
            updateActiveNavItem('nav-pending-operations');
          } else if (tabId === 'history') {
            updateActiveNavItem('nav-history');
          }
        });
      });
    }
    
    // Poblar grillas de logos de bancos
    function populateBankLogos() {
      const mobileBankGrid = document.getElementById('mobile-bank-grid');
      const bankNameGrid = document.getElementById('bank-name-grid');
      
      // Función para llenar la grilla con logos de bancos
      function fillBankGrid(grid, banks, type) {
        if (!grid) return;
        
        grid.innerHTML = '';
        
        // Mostrar solo los primeros 8 bancos por defecto
        const displayBanks = banks.slice(0, 8);
        
        displayBanks.forEach(bank => {
          const bankItem = document.createElement('div');
          bankItem.className = 'bank-logo-item';
          bankItem.setAttribute('data-bank-id', bank.id);
          bankItem.setAttribute('data-bank-name', bank.name);
          bankItem.setAttribute('data-bank-type', type);
          
          bankItem.innerHTML = `
            <div class="bank-logo-container">
              <img src="${bank.logo}" alt="${bank.name}" class="bank-logo">
            </div>
            <div class="bank-name">${bank.name}</div>
          `;
          
          grid.appendChild(bankItem);
        });
        
        // Agregar botón "Ver más bancos" si hay más de 8
        if (banks.length > 8) {
          const moreButton = document.createElement('div');
          moreButton.className = 'bank-logo-item';
          moreButton.style.background = 'var(--neutral-100)';
          moreButton.innerHTML = `
            <div class="bank-logo-container" style="color: var(--primary);">
              <i class="fas fa-ellipsis-h" style="font-size: 1.5rem;"></i>
            </div>
            <div class="bank-name">Ver más bancos</div>
          `;
          
          moreButton.addEventListener('click', function() {
            // Mostrar todos los bancos
            grid.innerHTML = '';
            
            banks.forEach(bank => {
              const bankItem = document.createElement('div');
              bankItem.className = 'bank-logo-item';
              bankItem.setAttribute('data-bank-id', bank.id);
              bankItem.setAttribute('data-bank-name', bank.name);
              bankItem.setAttribute('data-bank-type', type);
              
              bankItem.innerHTML = `
                <div class="bank-logo-container">
                  <img src="${bank.logo}" alt="${bank.name}" class="bank-logo">
                </div>
                <div class="bank-name">${bank.name}</div>
              `;
              
              grid.appendChild(bankItem);
            });
            
            // Agregar botón "Ver menos"
            const lessButton = document.createElement('div');
            lessButton.className = 'bank-logo-item';
            lessButton.style.background = 'var(--neutral-100)';
            lessButton.innerHTML = `
              <div class="bank-logo-container" style="color: var(--primary);">
                <i class="fas fa-chevron-up" style="font-size: 1.5rem;"></i>
              </div>
              <div class="bank-name">Ver menos</div>
            `;
            
            lessButton.addEventListener('click', function() {
              // Recargar los primeros 8 bancos
              fillBankGrid(grid, banks, type);
            });
            
            grid.appendChild(lessButton);
          });
          
          grid.appendChild(moreButton);
        }
      }
      
      // Llenar grids con bancos nacionales
      fillBankGrid(mobileBankGrid, CONFIG.BANKS.NACIONAL, 'mobile');
      fillBankGrid(bankNameGrid, CONFIG.BANKS.NACIONAL, 'bank');
    }
    
    // Configurar selección de logos de bancos
    function setupBankLogoSelection() {
      // Escuchar clicks en logo-items dentro de grillas de bancos
      document.addEventListener('click', function(e) {
        const logoItem = e.target.closest('.bank-logo-item');
        if (!logoItem) return;
        
        // Obtener tipo de banco (mobile o bank) y grilla correspondiente
        const bankType = logoItem.getAttribute('data-bank-type');
        const grid = logoItem.parentElement;
        
        // Si es botón de "Ver más" o "Ver menos", ignorar
        if (!logoItem.getAttribute('data-bank-id')) return;
        
        // Quitar clase active de todos los items en la grilla
        const items = grid.querySelectorAll('.bank-logo-item');
        items.forEach(item => {
          if (item.getAttribute('data-bank-id')) {
            item.classList.remove('active');
          }
        });
        
        // Agregar clase active al item seleccionado
        logoItem.classList.add('active');
        
        // Guardar selección en variable global
        const bankId = logoItem.getAttribute('data-bank-id');
        const bankName = logoItem.getAttribute('data-bank-name');
        
        selectedBank[bankType] = {
          id: bankId,
          name: bankName
        };
        
        // Actualizar input oculto correspondiente
        const inputId = bankType === 'mobile' ? 'mobile-bank' : 'bank-name';
        const hiddenInput = document.getElementById(inputId);
        if (hiddenInput) {
          hiddenInput.value = bankId;
        }
        
        // Actualizar visualización de flujo de fondos
        updateFundsJourney();
        
        // Mostrar toast de confirmación
        showToast('success', 'Banco Seleccionado', `Has seleccionado ${bankName}`);
      });
    }
    
    // Formatear número con separadores de miles (punto) y decimal (coma)
    function formatNumberWithCommas(number) {
      // Primero, convertir a string y eliminar caracteres no numéricos excepto el punto
      let value = number.toString().replace(/[^\d.]/g, '');
      
      // Si hay más de un punto decimal, dejar solo el primero
      const decimalPoints = value.match(/\./g);
      if (decimalPoints && decimalPoints.length > 1) {
        let firstDecimalIndex = value.indexOf('.');
        value = value.substring(0, firstDecimalIndex + 1) + 
                value.substring(firstDecimalIndex + 1).replace(/\./g, '');
      }
      
      // Separar parte entera y decimal
      let parts = value.split('.');
      let integerPart = parts[0];
      let decimalPart = parts.length > 1 ? parts[1] : '';
      
      // Limitar la parte decimal a 2 dígitos
      decimalPart = decimalPart.substring(0, 2);
      if (decimalPart.length < 2) {
        decimalPart = decimalPart.padEnd(2, '0');
      }
      
      // Agregar separadores de miles (punto) a la parte entera
      integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      
      // Unir con coma como separador decimal
      return integerPart + ',' + decimalPart;
    }
    
    // Parsear número desde formato con puntos y comas
    function parseFormattedNumber(formattedNumber) {
      if (!formattedNumber) return 0;
      
      // Eliminar todos los puntos (separadores de miles)
      let cleanNumber = formattedNumber.replace(/\./g, '');
      
      // Reemplazar la coma decimal por un punto
      cleanNumber = cleanNumber.replace(',', '.');
      
      // Convertir a número
      return parseFloat(cleanNumber) || 0;
    }
    
    // Configurar input de cantidad con formato automático
    function setupAmountInput() {
      const amountInput = document.getElementById('withdrawal-amount');
      if (amountInput) {
        // Al recibir el foco, seleccionar todo el texto
        amountInput.addEventListener('focus', function() {
          this.select();
        });
        
        // Manejar cambios en el input
        amountInput.addEventListener('input', function(e) {
          // Obtener el valor actual y la posición del cursor
          const cursorPosition = this.selectionStart;
          const currentValue = this.value;
          
          // Eliminar caracteres no numéricos excepto puntos y comas
          let cleanValue = currentValue.replace(/[^\d.,]/g, '');
          
          // Permitir solo un separador decimal
          if ((cleanValue.match(/,/g) || []).length > 1) {
            const firstCommaIndex = cleanValue.indexOf(',');
            cleanValue = cleanValue.substring(0, firstCommaIndex + 1) + 
                        cleanValue.substring(firstCommaIndex + 1).replace(/,/g, '');
          }
          
          // Convertir a formato numérico para cálculos
          withdrawalAmount = parseFormattedNumber(cleanValue);
          
          // Formatear con separadores de miles y decimales
          const formattedValue = formatNumberWithCommas(withdrawalAmount);
          
          // Actualizar el campo solo si hay un cambio real
          if (formattedValue !== currentValue) {
            this.value = formattedValue;
            
            // Ajustar posición del cursor para mantener usabilidad
            // Este cálculo es aproximado y puede necesitar ajustes
            const lengthDiff = formattedValue.length - currentValue.length;
            const newPosition = cursorPosition + lengthDiff;
            this.setSelectionRange(newPosition, newPosition);
          }
          
          // Calcular equivalentes en otras monedas
          withdrawalAmountUsd = withdrawalAmount / CONFIG.EXCHANGE_RATES.USD_TO_BS;
          withdrawalAmountEur = withdrawalAmountUsd * CONFIG.EXCHANGE_RATES.USD_TO_EUR;
          
          // Actualizar display de equivalentes
          updateEquivalentsDisplay();
          
          // Guardar monto en sessionStorage para recuperación
          saveTransferData();
        });
        
        // Inicializar campo con formato
        if (amountInput.value) {
          const formattedValue = formatNumberWithCommas(parseFormattedNumber(amountInput.value));
          amountInput.value = formattedValue;
        }
        
        // Trigger input event to initialize values
        const event = new Event('input');
        amountInput.dispatchEvent(event);
      }
    }
    
    // Guardar datos de transferencia para recuperación
    function saveTransferData() {
      const transferData = {
        amount: withdrawalAmount > 0 ? withdrawalAmount.toString() : '',
        method: selectedMethod
      };
      
      // Guardar en sessionStorage
      try {
        sessionStorage.setItem('remeexTransferData', JSON.stringify(transferData));
      } catch (e) {
        console.error('Error al guardar datos de transferencia:', e);
      }
    }

    // Actualizar display de equivalentes
    function updateEquivalentsDisplay() {
      const amountEquivalents = document.getElementById('amount-equivalents');
      
      if (amountEquivalents) {
        amountEquivalents.textContent = `≈ ${formatCurrency(withdrawalAmountUsd, 'usd')} | ≈ ${formatCurrency(withdrawalAmountEur, 'eur')}`;
      }
    }

    // Configurar selección de método
    function setupMethodSelection() {
      const methodOptions = document.querySelectorAll('.method-option');
      
      methodOptions.forEach(option => {
        option.addEventListener('click', function() {
          // Actualizar selección visual
          methodOptions.forEach(opt => opt.classList.remove('active'));
          this.classList.add('active');
          
          // Guardar método seleccionado
          selectedMethod = this.getAttribute('data-method');
          
          // Mostrar formulario correspondiente
          const forms = document.querySelectorAll('.bank-selection');
          forms.forEach(form => form.classList.remove('active'));
          
          const selectedForm = document.getElementById(`${selectedMethod}-transfer-form`);
          if (selectedForm) {
            selectedForm.classList.add('active');
          } else {
            document.getElementById('mobile-payment-form').classList.add('active');
          }
          
          // Verificar límites según método seleccionado
          checkWithdrawalLimits();
          
          // Actualizar visualización de flujo de fondos
          updateFundsJourney();
          
          // Guardar método en sessionStorage
          saveTransferData();
        });
      });
    }

    // Configurar formulario internacional
    function setupInternationalForm() {
      const intMethod = document.getElementById('int-method');
      
      if (intMethod) {
        intMethod.addEventListener('change', function() {
          // Ocultar todos los formularios
          document.getElementById('zelle-form').style.display = 'none';
          document.getElementById('paypal-form').style.display = 'none';
          document.getElementById('swift-form').style.display = 'none';
          document.getElementById('crypto-form').style.display = 'none';
          document.getElementById('wise-form').style.display = 'none';
          
          // Mostrar el formulario seleccionado
          const selectedForm = document.getElementById(`${this.value}-form`);
          if (selectedForm) {
            selectedForm.style.display = 'block';
          }
          
          // Actualizar visualización de flujo de fondos
          updateFundsJourney();
        });
      }
    }

    // Verificar límites de retiro
    function checkWithdrawalLimits() {
      const methodElement = document.querySelector(`.method-option[data-method="${selectedMethod}"]`);
      
      if (methodElement) {
        const limit = parseFloat(methodElement.getAttribute('data-limit')) || 0;
        
        if (limit > 0 && withdrawalAmount > limit) {
          showToast('warning', 'Límite Excedido', `El monto máximo para ${methodElement.querySelector('.method-label').textContent} es ${formatCurrency(limit, 'bs')}`);
          
          // Ajustar el monto al límite
          const amountInput = document.getElementById('withdrawal-amount');
          if (amountInput) {
            amountInput.value = formatNumberWithCommas(limit);
            
            // Disparar evento de input para actualizar equivalentes
            const event = new Event('input');
            amountInput.dispatchEvent(event);
          }
        }
      }
    }

    // Configurar botones de verificación
    function setupVerificationButtons() {
      // Botón de verificar ahora en el banner
      const verifyNowBtn = document.getElementById('verify-now-btn');
      if (verifyNowBtn) {
        verifyNowBtn.addEventListener('click', function() {
          showVerificationConfirmation();
        });
      }
      
      // Botón de verificar desde el recibo
      const verifyFromReceipt = document.getElementById('verify-from-receipt');
      if (verifyFromReceipt) {
        verifyFromReceipt.addEventListener('click', function() {
          const receiptModal = document.getElementById('receipt-modal');
          if (receiptModal) receiptModal.style.display = 'none';
          showVerificationConfirmation();
        });
      }
    }
    
    // NUEVO: Mostrar modal de confirmación de verificación
    function showVerificationConfirmation() {
      const modal = document.getElementById('verification-confirmation-modal');
      if (modal) {
        modal.style.display = 'flex';
      } else {
        // Fallback si no existe el modal
        window.location.href = 'recarga.html';
      }
    }

    // Configurar botones de información de seguridad
    function setupSecurityInfoButtons() {
      // Botón para mostrar modal de información de seguridad
      const showSecurityInfoBtn = document.getElementById('show-security-info');
      const securityInfoModal = document.getElementById('security-info-modal');
      
      if (showSecurityInfoBtn && securityInfoModal) {
        showSecurityInfoBtn.addEventListener('click', function(e) {
          e.preventDefault();
          securityInfoModal.style.display = 'flex';
        });
      }
      
      // Botones para cerrar modal de información de seguridad
      const closeSecurityInfoBtns = [
        document.getElementById('close-security-info'),
        document.getElementById('close-security-info-btn')
      ];
      
      closeSecurityInfoBtns.forEach(btn => {
        if (btn) {
          btn.addEventListener('click', function() {
            if (securityInfoModal) {
              securityInfoModal.style.display = 'none';
            }
          });
        }
      });
      
      // Botón de información sobre balance
      const infoBalanceBadge = document.getElementById('info-balance-badge');
      if (infoBalanceBadge) {
        infoBalanceBadge.addEventListener('click', function() {
          showToast('info', 'Saldo Disponible', 'Este es tu saldo total disponible para retiro. Los montos se actualizan automáticamente según la tasa de cambio actual.');
        });
      }
    }
    
    // Configurar botones de FAQ
    function setupFaqButtons() {
      // Alternar visibilidad del contenido de FAQ
      const faqHeaders = document.querySelectorAll('.faq-header');
      
      faqHeaders.forEach(header => {
        header.addEventListener('click', function() {
          const content = this.nextElementSibling;
          const icon = this.querySelector('i.fas');
          
          // Toggle content
          if (content.style.display === 'block') {
            content.style.display = 'none';
            if (icon) icon.className = 'fas fa-chevron-down';
          } else {
            content.style.display = 'block';
            if (icon) icon.className = 'fas fa-chevron-up';
          }
        });
      });
      
      // Botón FAQ en las opciones de contacto
      const faqBtn = document.getElementById('faq-btn');
      const securityInfoModal = document.getElementById('security-info-modal');
      
      if (faqBtn && securityInfoModal) {
        faqBtn.addEventListener('click', function(e) {
          e.preventDefault();
          securityInfoModal.style.display = 'flex';
        });
      }
    }

    // Configurar botones de estado de verificación
    function setupVerificationStatusButtons() {
      const checkStatusBtn = document.getElementById('verification-check-status-btn');
      const contactSupportBtn = document.getElementById('verification-contact-support-btn');
      
      if (checkStatusBtn) {
        checkStatusBtn.addEventListener('click', function() {
          showLoading('Verificando el estado de tu proceso...');
          
          setTimeout(() => {
            hideLoading();
            showToast('info', 'Estado de Verificación', 'Tu verificación sigue en proceso. Por favor, espera un poco más.');
          }, 2000);
        });
      }
      
      if (contactSupportBtn) {
        contactSupportBtn.addEventListener('click', function() {
          // Abrir WhatsApp con mensaje predefinido
          const message = encodeURIComponent(`Hola, he realizado mi depósito de verificación con referencia VER${CONFIG.VERIFICATION_CODE} y estoy consultando el estado del proceso.`);
          window.open(`https://wa.me/+17373018059?text=${message}`, '_blank');
        });
      }
    }

    // Configurar botón de envío
    function setupSubmitButton() {
      const submitBtn = document.getElementById('submit-withdrawal');
      
      if (submitBtn) {
        submitBtn.addEventListener('click', function() {
          // Validar monto
          if (withdrawalAmount <= 0) {
            showToast('error', 'Monto Inválido', 'Por favor ingresa un monto mayor a cero.');
            return;
          }
          
          // Validar saldo suficiente
          if (withdrawalAmount > currentUser.balance.bs) {
            showToast('error', 'Saldo Insuficiente', 'No tienes fondos suficientes para realizar este retiro.');
            return;
          }
          
          // Validar límites
          checkWithdrawalLimits();
          
          // Validar banco seleccionado
          if (!validateBankSelected()) {
            return;
          }
          
          // Validar datos según método seleccionado
          if (!validateFormData()) {
            return;
          }
          
          // Mostrar loading
          showLoading('Procesando tu solicitud...');
          
          // Simular progreso
          simulateProcessing(function() {
            // Crear nueva transacción pendiente
            const newTransaction = createTransactionObject();
            
            // Agregar a la lista de pendientes
            addPendingTransaction(newTransaction);
            
            // Actualizar recibo
            updateReceiptData();
            
            // Mostrar recibo
            const receiptModal = document.getElementById('receipt-modal');
            if (receiptModal) receiptModal.style.display = 'flex';
            
            // Mostrar banner de verificación si no está verificado y no está en proceso
            if (!currentUser.isVerified && !verificationInProgress) {
              const verifyBanner = document.getElementById('verify-banner');
              if (verifyBanner) verifyBanner.style.display = 'flex';
            }
            
            // Actualizar timeline
            const timelineProgress = document.getElementById('timeline-progress');
            if (timelineProgress) timelineProgress.style.width = '50%';
            
            document.getElementById('step-create').classList.remove('active');
            document.getElementById('step-create').classList.add('completed');
            document.getElementById('step-verify').classList.add('active');
            
            // Cambiar a la pestaña de operaciones pendientes
            const pendingTab = document.querySelector('.tab-item[data-tab="pending"]');
            if (pendingTab) {
              pendingTab.click();
            }
            
            // Actualizar navegación
            updateActiveNavItem('nav-pending-operations');
          });
        });
      }
    }
    
    // Crear objeto de transacción
    function createTransactionObject() {
      const transactionId = `RET-${CONFIG.VERIFICATION_CODE}`;
      const date = new Date();
      const formattedDate = date.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' });
      
      let destination = '';
      let bankName = '';
      
      // Obtener destino y banco según método
      if (selectedMethod === 'mobile') {
        const mobileNumber = document.getElementById('mobile-number');
        if (mobileNumber) destination = mobileNumber.value;
        
        if (selectedBank.mobile) {
          bankName = selectedBank.mobile.name;
        }
      } else if (selectedMethod === 'bank') {
        const accountNumber = document.getElementById('account-number');
        if (accountNumber) {
          const plainAccount = accountNumber.value.replace(/\D/g, '');
          destination = '****' + plainAccount.slice(-4);
        }
        
        if (selectedBank.bank) {
          bankName = selectedBank.bank.name;
        }
      } else if (selectedMethod === 'international') {
        const intMethod = document.getElementById('int-method');
        if (intMethod) {
          bankName = getInternationalMethodName(intMethod.value);
          
          // Determinar destino según método internacional
          switch(intMethod.value) {
            case 'zelle':
              const zelleEmail = document.getElementById('zelle-email');
              if (zelleEmail) destination = zelleEmail.value;
              break;
              
            case 'paypal':
              const paypalEmail = document.getElementById('paypal-email');
              if (paypalEmail) destination = paypalEmail.value;
              break;
              
            case 'wise':
              const wiseEmail = document.getElementById('wise-email');
              if (wiseEmail) destination = wiseEmail.value;
              break;
              
            case 'swift':
              const swiftAccount = document.getElementById('swift-account');
              if (swiftAccount) {
                const account = swiftAccount.value;
                if (account.length > 10) {
                  destination = account.substring(0, 6) + '...' + account.slice(-4);
                } else {
                  destination = account;
                }
              }
              break;
              
            case 'crypto':
              const cryptoAddress = document.getElementById('crypto-address');
              const cryptoCurrency = document.getElementById('crypto-currency');
              
              if (cryptoAddress) {
                const address = cryptoAddress.value;
                if (address.length > 15) {
                  destination = `${address.substring(0, 6)}...${address.slice(-6)}`;
                } else {
                  destination = address;
                }
              }
              
              if (cryptoCurrency) {
                const currencyText = getCryptoNameById(cryptoCurrency.value);
                bankName = currencyText;
              }
              break;
          }
        }
      }
      
      return {
        id: transactionId,
        amount: selectedMethod === 'international' ? withdrawalAmountUsd : withdrawalAmount,
        method: selectedMethod,
        destination: destination,
        bankName: bankName,
        status: currentUser.isVerified ? 'processing' : 'pending_verification',
        date: date.toISOString(),
        formattedDate: formattedDate
      };
    }
    
    // Validar que se ha seleccionado un banco
    function validateBankSelected() {
      // Para método móvil
      if (selectedMethod === 'mobile') {
        if (!selectedBank.mobile) {
          showToast('error', 'Banco Requerido', 'Por favor, selecciona tu banco para pago móvil.');
          return false;
        }
      }
      
      // Para método de transferencia bancaria
      if (selectedMethod === 'bank') {
        if (!selectedBank.bank) {
          showToast('error', 'Banco Requerido', 'Por favor, selecciona el banco donde tienes tu cuenta.');
          return false;
        }
      }
      
      return true;
    }
    
    // Mostrar loading con progreso
    function showLoading(message = 'Procesando tu solicitud...') {
      const loadingOverlay = document.getElementById('loading-overlay');
      const loadingText = document.getElementById('loading-text');
      const progressBar = document.getElementById('progress-bar');
      
      if (loadingText) loadingText.textContent = message;
      if (progressBar) progressBar.style.width = '0%';
      if (loadingOverlay) loadingOverlay.style.display = 'flex';
    }
    
    // Ocultar loading
    function hideLoading() {
      const loadingOverlay = document.getElementById('loading-overlay');
      if (loadingOverlay) loadingOverlay.style.display = 'none';
    }
    
    // Simular procesamiento con progreso
    function simulateProcessing(callback) {
      const progressBar = document.getElementById('progress-bar');
      const loadingText = document.getElementById('loading-text');
      
      let width = 0;
      const interval = setInterval(function() {
        if (width >= 100) {
          clearInterval(interval);
          hideLoading();
          if (callback) callback();
        } else {
          width += 2;
          if (progressBar) progressBar.style.width = width + '%';
          
          // Actualizar texto según progreso
          if (loadingText) {
            if (width < 30) {
              loadingText.textContent = "Validando datos...";
            } else if (width < 60) {
              loadingText.textContent = "Preparando orden de retiro...";
            } else if (width < 90) {
              loadingText.textContent = "Verificando disponibilidad...";
            } else {
              loadingText.textContent = "¡Casi listo!";
            }
          }
        }
      }, 30);
    }

    // Validar datos del formulario
    function validateFormData() {
      let isValid = true;
      
      // Validar según método seleccionado
      if (selectedMethod === 'mobile') {
        const mobileNumber = document.getElementById('mobile-number');
        const mobileId = document.getElementById('mobile-id');
        const mobileName = document.getElementById('mobile-name');
        
        const numberError = document.getElementById('mobile-number-error');
        const idError = document.getElementById('mobile-id-error');
        const nameError = document.getElementById('mobile-name-error');
        
        // Reset errors
        if (numberError) numberError.style.display = 'none';
        if (idError) idError.style.display = 'none'; if (nameError) nameError.style.display = 'none';
        
        if (!mobileNumber || !mobileNumber.value) {
          if (numberError) numberError.style.display = 'block';
          isValid = false;
        } else if (!/^0[412][0-9]{8,9}$/.test(mobileNumber.value.replace(/\D/g, ''))) {
          if (numberError) {
            numberError.textContent = 'El número debe comenzar con 04XX y tener 10-11 dígitos.';
            numberError.style.display = 'block';
          }
          isValid = false;
        }
        
        if (!mobileId || !mobileId.value) {
          if (idError) idError.style.display = 'block';
          isValid = false;
        } else if (!/^[VEJPvejp][-.\s]?\d{6,9}$/.test(mobileId.value)) {
          if (idError) {
            idError.textContent = 'Formato de cédula inválido (ej: V-12345678).';
            idError.style.display = 'block';
          }
          isValid = false;
        }
        
        if (!mobileName || !mobileName.value || mobileName.value.trim().length < 5) {
          if (nameError) nameError.style.display = 'block';
          isValid = false;
        }
      } else if (selectedMethod === 'bank') {
        const accountType = document.getElementById('account-type');
        const accountNumber = document.getElementById('account-number');
        const accountId = document.getElementById('account-id');
        const accountName = document.getElementById('account-name');
        
        const accountNumberError = document.getElementById('account-number-error');
        const accountIdError = document.getElementById('account-id-error');
        const accountNameError = document.getElementById('account-name-error');
        
        // Reset errors
        if (accountNumberError) accountNumberError.style.display = 'none';
        if (accountIdError) accountIdError.style.display = 'none';
        if (accountNameError) accountNameError.style.display = 'none';
        
        // Validar tipo de cuenta
        if (!accountType || accountType.value === '') {
          showToast('error', 'Tipo de Cuenta Requerido', 'Por favor, selecciona el tipo de cuenta.');
          isValid = false;
        }
        
        // Validar número de cuenta
        if (!accountNumber || !accountNumber.value) {
          if (accountNumberError) accountNumberError.style.display = 'block';
          isValid = false;
        } else if (!/^\d{20}$/.test(accountNumber.value.replace(/\D/g, ''))) {
          if (accountNumberError) {
            accountNumberError.textContent = 'El número de cuenta debe tener 20 dígitos.';
            accountNumberError.style.display = 'block';
          }
          isValid = false;
        }
        
        // Validar cédula
        if (!accountId || !accountId.value) {
          if (accountIdError) accountIdError.style.display = 'block';
          isValid = false;
        } else if (!/^[VEJPvejp][-.\s]?\d{6,9}$/.test(accountId.value)) {
          if (accountIdError) {
            accountIdError.textContent = 'Formato de cédula inválido (ej: V-12345678).';
            accountIdError.style.display = 'block';
          }
          isValid = false;
        }
        
        // Validar nombre
        if (!accountName || !accountName.value || accountName.value.trim().length < 5) {
          if (accountNameError) accountNameError.style.display = 'block';
          isValid = false;
        }
      } else if (selectedMethod === 'international') {
        const intMethod = document.getElementById('int-method');
        
        if (!intMethod || intMethod.value === '') {
          showToast('error', 'Método Requerido', 'Por favor, selecciona el método de envío internacional.');
          isValid = false;
        } else {
          // Validar según el método internacional seleccionado
          switch(intMethod.value) {
            case 'zelle':
              const zelleEmail = document.getElementById('zelle-email');
              const zelleEmailError = document.getElementById('zelle-email-error');
              
              if (zelleEmailError) zelleEmailError.style.display = 'none';
              
              if (!zelleEmail || !zelleEmail.value) {
                if (zelleEmailError) zelleEmailError.style.display = 'block';
                isValid = false;
              } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(zelleEmail.value)) {
                if (zelleEmailError) {
                  zelleEmailError.textContent = 'Por favor, introduce un correo electrónico válido.';
                  zelleEmailError.style.display = 'block';
                }
                isValid = false;
              }
              break;
              
            case 'paypal':
              const paypalEmail = document.getElementById('paypal-email');
              const paypalEmailError = document.getElementById('paypal-email-error');
              
              if (paypalEmailError) paypalEmailError.style.display = 'none';
              
              if (!paypalEmail || !paypalEmail.value) {
                if (paypalEmailError) paypalEmailError.style.display = 'block';
                isValid = false;
              } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(paypalEmail.value)) {
                if (paypalEmailError) {
                  paypalEmailError.textContent = 'Por favor, introduce un correo electrónico válido.';
                  paypalEmailError.style.display = 'block';
                }
                isValid = false;
              }
              break;
              
            case 'wise':
              const wiseEmail = document.getElementById('wise-email');
              const wiseEmailError = document.getElementById('wise-email-error');
              
              if (wiseEmailError) wiseEmailError.style.display = 'none';
              
              if (!wiseEmail || !wiseEmail.value) {
                if (wiseEmailError) wiseEmailError.style.display = 'block';
                isValid = false;
              } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(wiseEmail.value)) {
                if (wiseEmailError) {
                  wiseEmailError.textContent = 'Por favor, introduce un correo electrónico válido.';
                  wiseEmailError.style.display = 'block';
                }
                isValid = false;
              }
              break;
              
            case 'swift':
              // Validar campos SWIFT/BIC
              const swiftBank = document.getElementById('swift-bank');
              const swiftCode = document.getElementById('swift-code');
              const swiftAccount = document.getElementById('swift-account');
              const swiftName = document.getElementById('swift-name');
              
              if (!swiftBank || !swiftBank.value) {
                showToast('error', 'Nombre del Banco Requerido', 'Por favor, ingresa el nombre del banco.');
                isValid = false;
              }
              
              if (!swiftCode || !swiftCode.value) {
                showToast('error', 'Código SWIFT Requerido', 'Por favor, ingresa el código SWIFT/BIC.');
                isValid = false;
              }
              
              if (!swiftAccount || !swiftAccount.value) {
                showToast('error', 'Número de Cuenta Requerido', 'Por favor, ingresa el número de cuenta o IBAN.');
                isValid = false;
              }
              
              if (!swiftName || !swiftName.value) {
                showToast('error', 'Nombre del Beneficiario Requerido', 'Por favor, ingresa el nombre del beneficiario.');
                isValid = false;
              }
              break;
              
            case 'crypto':
              const cryptoAddress = document.getElementById('crypto-address');
              const cryptoAddressError = document.getElementById('crypto-address-error');
              
              if (cryptoAddressError) cryptoAddressError.style.display = 'none';
              
              if (!cryptoAddress || !cryptoAddress.value) {
                if (cryptoAddressError) cryptoAddressError.style.display = 'block';
                isValid = false;
              }
              break;
          }
        }
      }
      
      return isValid;
    }

    // Actualizar datos del recibo
    function updateReceiptData() {
      const receiptAmount = document.getElementById('receipt-amount');
      const receiptMethod = document.getElementById('receipt-method');
      const receiptDestination = document.getElementById('receipt-destination');
      
      if (receiptAmount) receiptAmount.textContent = formatCurrency(withdrawalAmount, 'bs');
      
      if (receiptMethod) {
        switch(selectedMethod) {
          case 'mobile':
            receiptMethod.textContent = 'Pago Móvil';
            
            const mobileNumber = document.getElementById('mobile-number');
            
            if (receiptDestination && mobileNumber) {
              // Obtener nombre del banco seleccionado
              const bankName = selectedBank.mobile ? selectedBank.mobile.name : 'Banco';
              receiptDestination.textContent = `${mobileNumber.value} (${bankName})`;
            }
            break;
            
          case 'bank':
            receiptMethod.textContent = 'Transferencia Bancaria';
            
            const accountNumber = document.getElementById('account-number');
            
            if (receiptDestination && accountNumber) {
              // Obtener nombre del banco seleccionado
              const bankText = selectedBank.bank ? selectedBank.bank.name : 'Banco';
              
              // Formatear número de cuenta para mostrar solo últimos 4 dígitos
              let maskedAccount = '';
              if (accountNumber.value) {
                const plainAccount = accountNumber.value.replace(/\D/g, '');
                maskedAccount = '****' + plainAccount.slice(-4);
              }
              
              receiptDestination.textContent = `${maskedAccount} (${bankText})`;
            }
            break;
            
          case 'international':
            const intMethod = document.getElementById('int-method');
            
            if (intMethod) {
              // Obtener texto del método seleccionado
              const methodText = getInternationalMethodName(intMethod.value);
              
              if (receiptMethod) receiptMethod.textContent = methodText;
              
              // Determinar destino según método internacional
              if (receiptDestination) {
                switch(intMethod.value) {
                  case 'zelle':
                    const zelleEmail = document.getElementById('zelle-email');
                    if (zelleEmail) receiptDestination.textContent = zelleEmail.value;
                    break;
                    
                  case 'paypal':
                    const paypalEmail = document.getElementById('paypal-email');
                    if (paypalEmail) receiptDestination.textContent = paypalEmail.value;
                    break;
                    
                  case 'wise':
                    const wiseEmail = document.getElementById('wise-email');
                    if (wiseEmail) receiptDestination.textContent = wiseEmail.value;
                    break;
                    
                  case 'swift':
                    const swiftAccount = document.getElementById('swift-account');
                    if (swiftAccount) {
                      // Mostrar los primeros 6 caracteres y los últimos 4
                      const account = swiftAccount.value;
                      if (account.length > 10) {
                        receiptDestination.textContent = account.substring(0, 6) + '...' + account.slice(-4);
                      } else {
                        receiptDestination.textContent = account;
                      }
                    }
                    break;
                    
                  case 'crypto':
                    const cryptoAddress = document.getElementById('crypto-address');
                    const cryptoCurrency = document.getElementById('crypto-currency');
                    
                    if (cryptoAddress && cryptoCurrency) {
                      const currencyText = getCryptoNameById(cryptoCurrency.value);
                      const address = cryptoAddress.value;
                      
                      // Truncar dirección si es muy larga
                      if (address.length > 15) {
                        receiptDestination.textContent = `${address.substring(0, 6)}...${address.slice(-6)} (${currencyText})`;
                      } else {
                        receiptDestination.textContent = `${address} (${currencyText})`;
                      }
                    }
                    break;
                    
                  default:
                    receiptDestination.textContent = 'Destino Internacional';
                }
              }
            }
            break;
        }
      }
    }
    
    // Obtener nombre de método internacional
    function getInternationalMethodName(methodId) {
      const methodNames = {
        'zelle': 'Zelle',
        'paypal': 'PayPal',
        'wise': 'Wise (Transferwise)',
        'swift': 'Transferencia SWIFT',
        'crypto': 'Criptomonedas'
      };
      
      return methodNames[methodId] || 'Transferencia Internacional';
    }
    
    // Obtener nombre de criptomoneda por ID
    function getCryptoNameById(cryptoId) {
      const cryptoNames = {
        'btc': 'Bitcoin (BTC)',
        'eth': 'Ethereum (ETH)',
        'usdt': 'Tether (USDT)',
        'usdc': 'USD Coin (USDC)',
        'bnb': 'Binance Coin (BNB)'
      };
      
      return cryptoNames[cryptoId] || cryptoId.toUpperCase();
    }

    // Configurar botones de copia
    function setupCopyButtons() {
      const copyButtons = document.querySelectorAll('.copy-btn[data-copy]');
      
      copyButtons.forEach(btn => {
        btn.addEventListener('click', function() {
          const textToCopy = this.getAttribute('data-copy');
          
          navigator.clipboard.writeText(textToCopy)
            .then(() => {
              showToast('success', 'Copiado', 'Texto copiado al portapapeles');
            })
            .catch(err => {
              console.error('Error al copiar: ', err);
              showToast('error', 'Error', 'No se pudo copiar el texto');
            });
        });
      });
    }

    // Configurar botones del recibo
    function setupReceiptButtons() {
      const closeReceiptBtn = document.getElementById('close-receipt');
      
      if (closeReceiptBtn) {
        closeReceiptBtn.addEventListener('click', function() {
          const receiptModal = document.getElementById('receipt-modal');
          if (receiptModal) receiptModal.style.display = 'none';
        });
      }
      
      // Botones de compartir recibo
      setupShareButtons();
    }
    
    // Configurar botones de compartir
    function setupShareButtons() {
      const shareWhatsApp = document.getElementById('share-whatsapp');
      const shareEmail = document.getElementById('share-email');
      const shareDownload = document.getElementById('share-download');
      
      if (shareWhatsApp) {
        shareWhatsApp.addEventListener('click', function(e) {
          e.preventDefault();
          
          const receiptText = generateReceiptText();
          const encodedText = encodeURIComponent(receiptText);
          const whatsappUrl = `https://wa.me/?text=${encodedText}`;
          
          window.open(whatsappUrl, '_blank');
        });
      }
      
      if (shareEmail) {
        shareEmail.addEventListener('click', function(e) {
          e.preventDefault();
          
          const receiptText = generateReceiptText();
          const encodedText = encodeURIComponent(receiptText);
          const subject = encodeURIComponent('Comprobante de Retiro - REMEEX');
          
          window.location.href = `mailto:?subject=${subject}&body=${encodedText}`;
        });
      }
      
      if (shareDownload) {
        shareDownload.addEventListener('click', function(e) {
          e.preventDefault();
          
          const receiptText = generateReceiptText();
          const blob = new Blob([receiptText], { type: 'text/plain' });
          const url = URL.createObjectURL(blob);
          
          const a = document.createElement('a');
          a.href = url;
          a.download = 'Comprobante-REMEEX-RET-' + CONFIG.VERIFICATION_CODE + '.txt';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        });
      }
    }
    
    // Generar texto del recibo para compartir
    function generateReceiptText() {
      const orderId = document.getElementById('receipt-order').textContent;
      const amount = document.getElementById('receipt-amount').textContent;
      const date = document.getElementById('receipt-date').textContent;
      const method = document.getElementById('receipt-method').textContent;
      const destination = document.getElementById('receipt-destination').textContent;
      
      return `COMPROBANTE DE RETIRO REMEEX
      
Orden: ${orderId}
Fecha: ${date}
Monto: ${amount}
Método: ${method}
Destino: ${destination}
Estado: Pendiente de Verificación

Para completar el retiro, se requiere verificar la cuenta bancaria.
Si ya realizaste la verificación, ignora este mensaje.

Gracias por utilizar REMEEX.
      `;
    }

    // Actualizar display de balance
    function updateBalanceDisplay() {
      const totalBalance = document.getElementById('total-balance');
      const balanceEquivalents = document.getElementById('balance-equivalents');
      const exchangeRateDisplay = document.getElementById('exchange-rate-display');
      
      if (totalBalance) {
        totalBalance.textContent = formatCurrency(currentUser.balance.bs, 'bs');
      }
      
      if (balanceEquivalents) {
        balanceEquivalents.textContent = `≈ ${formatCurrency(currentUser.balance.usd, 'usd')} | ≈ ${formatCurrency(currentUser.balance.eur, 'eur')}`;
      }
      
      if (exchangeRateDisplay) {
        exchangeRateDisplay.textContent = `1 USD = ${CONFIG.EXCHANGE_RATES.USD_TO_BS.toLocaleString('es-ES', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace(".", ",").replace(/,00$/, ",00")} Bs | 1 USD = ${CONFIG.EXCHANGE_RATES.USD_TO_EUR.toLocaleString('es-ES', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace(".", ",").replace(/,00$/, ",00")} EUR`;
      }
      
      // Mostrar banner de verificación si el usuario no está verificado
      const verifyBanner = document.getElementById('verify-banner');
      if (verifyBanner) {
        if (!currentUser.isVerified && !verificationInProgress) {
          verifyBanner.style.display = 'flex';
        } else {
          verifyBanner.style.display = 'none';
        }
      }
    }

    // Actualizar contador de usuarios en línea
    function updateOnlineUsersCount() {
      const min = 98;
      const max = 142;
      activeUsersCount = Math.floor(Math.random() * (max - min + 1)) + min;
      
      const userCountElement = document.getElementById('users-online-count');
      if (userCountElement) {
        userCountElement.textContent = `${activeUsersCount} usuarios conectados`;
      }
    }

    // Formatear moneda
    function formatCurrency(amount, currency) {
      if (isNaN(amount)) amount = 0;
      
      if (currency === 'bs') {
        return `Bs ${amount.toLocaleString('es-ES', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace(".", ",").replace(/,00$/, ",00")}`;
      } else if (currency === 'usd') {
        return `$${amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
      } else if (currency === 'eur') {
        return `€${amount.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace(".", ",").replace(/,00$/, ",00")}`;
      }
      
      return amount.toLocaleString();
    }

    // Función para escapar caracteres especiales (sanitizar entradas)
    function escapeHTML(str) {
      return str
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    // Mostrar notificación toast
    function showToast(type, title, message, duration = 3000) {
      const toastContainer = document.getElementById('toast-container');
      
      if (!toastContainer) return;
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      // Sanitizar contenido
      const safeTitle = escapeHTML(title);
      const safeMessage = escapeHTML(message);
      
      const content = `
        <div class="toast-icon">
          <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
        </div>
        <div class="toast-content">
          <div class="toast-title">${safeTitle}</div>
          <div class="toast-message">${safeMessage}</div>
        </div>
        <div class="toast-close">
          <i class="fas fa-times"></i>
        </div>
      `;
      
      toast.innerHTML = content;
      toastContainer.appendChild(toast);
      
      // Auto remove after duration
      setTimeout(() => {
        toast.style.opacity = '0';
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, duration);
      
      // Close button
      const closeBtn = toast.querySelector('.toast-close');
      if (closeBtn) {
        closeBtn.addEventListener('click', function() {
          toast.style.opacity = '0';
          setTimeout(() => {
            toast.remove();
          }, 300);
        });
      }
    }

    // Actualizar visualización de flujo de fondos
    function updateFundsJourney() {
      const destBankLogo = document.getElementById('destination-bank-logo');
      const destBankName = document.getElementById('destination-bank-name');
      const journeyProgressBar = document.getElementById('journey-progress-bar');
      const journeyMoneyAnimation = document.getElementById('journey-money-animation');
      
      // Actualizar basado en el método y banco seleccionado
      let selectedBankObj = null;
      let progressPercentage = 0;
      
      if (selectedMethod === 'mobile' && selectedBank.mobile) {
        selectedBankObj = selectedBank.mobile;
        progressPercentage = 75; // 75% completo para pago móvil (más rápido)
      } else if (selectedMethod === 'bank' && selectedBank.bank) {
        selectedBankObj = selectedBank.bank;
        progressPercentage = 60; // 60% completo para transferencias bancarias
      } else if (selectedMethod === 'international') {
        // Para transferencias internacionales, buscar logo según método
        const intMethod = document.getElementById('int-method');
        if (intMethod && intMethod.value) {
          let methodName = '';
          let logoUrl = '';
          
          switch(intMethod.value) {
            case 'zelle':
              methodName = 'Zelle';
              logoUrl = 'https://download.logo.wine/logo/Zelle_(payment_service)/Zelle_(payment_service)-Logo.wine.png';
              break;
            case 'paypal':
              methodName = 'PayPal';
              logoUrl = 'https://upload.wikimedia.org/wikipedia/commons/a/a4/Paypal_2014_logo.png';
              break;
            case 'wise':
              methodName = 'Wise';
              logoUrl = 'https://icon2.cleanpng.com/lnd/20250116/qj/27d09a29b3056c595b6e2d995a15b5.webp';
              break;
            case 'swift':
              methodName = 'Transferencia SWIFT';
              logoUrl = 'https://e7.pngegg.com/pngimages/127/511/png-clipart-bank-computer-icons-bank-building-bank.png';
              break;
            case 'crypto':
              const cryptoCurrency = document.getElementById('crypto-currency');
              methodName = cryptoCurrency ? getCryptoNameById(cryptoCurrency.value) : 'Criptomonedas';
              logoUrl = 'https://w7.pngwing.com/pngs/239/455/png-transparent-binance-hd-logo-thumbnail.png';
              break;
            default:
              methodName = 'Transferencia Internacional';
              logoUrl = 'https://e7.pngegg.com/pngimages/127/511/png-clipart-bank-computer-icons-bank-building-bank.png';
          }
          
          selectedBankObj = { name: methodName };
          if (destBankLogo) destBankLogo.src = logoUrl;
          progressPercentage = 40; // 40% para internacionales (más lentas)
        }
      }
      
      // Actualizar logo y nombre del banco destino
      if (selectedBankObj) {
        if (destBankName) destBankName.textContent = selectedBankObj.name;
        
        // Solo actualizar logo si no se actualizó en la sección internacional
        if (destBankLogo && selectedMethod !== 'international') {
          // Buscar logo en arrays de bancos
          const allBanks = [
            ...CONFIG.BANKS.NACIONAL,
            ...CONFIG.BANKS.INTERNACIONAL,
            ...CONFIG.BANKS.FINTECH
          ];
          
          const bankInfo = allBanks.find(bank => bank.id === selectedBankObj.id);
          if (bankInfo && bankInfo.logo) {
            destBankLogo.src = bankInfo.logo;
          } else {
            // Logo genérico si no se encuentra
            destBankLogo.src = 'https://e7.pngegg.com/pngimages/127/511/png-clipart-bank-computer-icons-bank-building-bank.png';
          }
        }
      }
      
      // Actualizar barra de progreso
      if (journeyProgressBar) {
        journeyProgressBar.style.width = `${progressPercentage}%`;
      }
      
      // Actualizar posición del ícono de dinero
      if (journeyMoneyAnimation) {
        // La posición inicial para la animación será en proporción al progreso
        journeyMoneyAnimation.style.left = `${progressPercentage - 5}%`;
        
        // Crear animación dinámica que se mueva ligeramente
        const animationRange = progressPercentage < 50 ? 8 : 5;
        
        // Configurar animación personalizada con @keyframes dinámico
        const styleSheet = document.styleSheet || document.createElement('style');
        styleSheet.innerHTML = `
          @keyframes moveRightDynamic {
            0% { left: ${progressPercentage - 5}%; }
            50% { left: ${progressPercentage - 5 + animationRange}%; }
            100% { left: ${progressPercentage - 5}%; }
          }
        `;
        if (!document.styleSheet) {
          document.head.appendChild(styleSheet);
        }
        
        journeyMoneyAnimation.style.animation = 'moveRightDynamic 3s ease-in-out infinite';
      }
    }

    // Cargar datos simulados para demostración
    function loadDemoData() {
      currentUser = {
        name: 'Juan Pérez',
        email: 'juan.perez@ejemplo.com',
        balance: {
          bs: 30000,
          usd: 30000 / CONFIG.EXCHANGE_RATES.USD_TO_BS,
          eur: (30000 / CONFIG.EXCHANGE_RATES.USD_TO_BS) * CONFIG.EXCHANGE_RATES.USD_TO_EUR
        },
        isVerified: false
      };
      
      // Guardar en sessionStorage para pruebas
      try {
        sessionStorage.setItem('remeexSessionBalance', JSON.stringify(currentUser.balance));
        sessionStorage.setItem('remeexSessionUserData', JSON.stringify({
          name: currentUser.name,
          email: currentUser.email
        }));
        sessionStorage.setItem('remeexVerificationStatus', currentUser.isVerified ? 'verified' : 'unverified');
      } catch (e) {
        console.error('Error al guardar datos de demo en sessionStorage:', e);
      }
      
      // Para compatibilidad con versión anterior
      try {
        sessionStorage.setItem(CONFIG.STORAGE_KEYS.USER_DATA, JSON.stringify({
          name: currentUser.name,
          email: currentUser.email
        }));
        
        sessionStorage.setItem(CONFIG.STORAGE_KEYS.BALANCE, JSON.stringify(currentUser.balance));
        sessionStorage.setItem(CONFIG.STORAGE_KEYS.VERIFICATION, currentUser.isVerified ? 'verified' : 'unverified');
      } catch (e) {
        console.error('Error al guardar datos de demo en sessionStorage (legacy):', e);
      }
      
      // Actualizar UI
      updateBalanceDisplay();
    }

    // Llamar a loadDemoData si no hay datos en sessionStorage
    if (!sessionStorage.getItem('remeexSessionBalance') && !sessionStorage.getItem(CONFIG.STORAGE_KEYS.BALANCE)) {
      loadDemoData();
    }
  </script>
</body>
</html>
</template>
  </div>

  <!-- Verification Container (iframe embed) -->
  <div class="verification-container" id="verification-container">
    <div class="section-title" style="margin-bottom: 1.5rem; display: flex; align-items: center;">
      <i class="fas fa-arrow-left" id="verification-back" style="cursor: pointer; margin-right: 1rem;"></i>
      <span>Verificación</span>
    </div>
    <iframe src="verificacion.html" id="verification-frame"></iframe>
  </div>

  <!-- Payment OTP Verification Modal -->
  <div class="modal-overlay" id="otp-modal-overlay">
    <div class="modal">
      <div class="modal-title">Verificación de Seguridad</div>
      <div class="modal-subtitle">Enviamos un código a tu teléfono asociado a tu tarjeta <span id="masked-phone">+44 75** ****13</span></div>
      
      <div class="otp-container">
        <input type="text" class="otp-input" id="otp-1" maxlength="1" data-next="otp-2" aria-label="OTP dígito 1">
        <input type="text" class="otp-input" id="otp-2" maxlength="1" data-next="otp-3" data-prev="otp-1" aria-label="OTP dígito 2">
        <input type="text" class="otp-input" id="otp-3" maxlength="1" data-next="otp-4" data-prev="otp-2" aria-label="OTP dígito 3">
        <input type="text" class="otp-input" id="otp-4" maxlength="1" data-next="otp-5" data-prev="otp-3" aria-label="OTP dígito 4">
        <input type="text" class="otp-input" id="otp-5" maxlength="1" data-next="otp-6" data-prev="otp-4" aria-label="OTP dígito 5">
        <input type="text" class="otp-input" id="otp-6" maxlength="1" data-prev="otp-5" aria-label="OTP dígito 6">
      </div>
      
      <div class="error-message" id="otp-error" style="text-align: center; display: none;">Código incorrecto. Intente nuevamente.</div>
      
      <button class="btn btn-primary" id="verify-otp-btn">
        <i class="fas fa-shield-alt"></i> Verificar y Recargar
      </button>
      
      <div class="resend-code">
        ¿No recibió el código? <a href="#" id="resend-code">Reenviar</a>
      </div>
    </div>
  </div>

  <!-- Mobile Payment Concept Modal -->
  <div class="modal-overlay" id="concept-modal-overlay">
    <div class="modal">
      <div class="modal-title">Concepto de Pago Móvil</div>
      <div class="modal-subtitle">Ingrese el concepto exactamente como se muestra en los datos</div>
      <input type="text" class="form-control" id="mobile-concept-input" placeholder="Concepto" style="margin-bottom: 1rem;">
      <button class="btn btn-primary" id="confirm-concept-btn">
        <i class="fas fa-check"></i> Confirmar
      </button>
    </div>
  </div>

  <!-- Password Recovery Modal -->
  <div class="modal-overlay" id="recover-modal-overlay">
    <div class="modal">
      <div class="modal-title">Recuperar Contraseña</div>
      <div class="modal-subtitle">Responda la pregunta de seguridad para cambiar su contraseña.</div>

      <div class="form-group">
        <label class="form-label" for="recover-email">Correo Electrónico</label>
        <input type="email" class="form-control" id="recover-email">
        <div class="error-message" id="recover-email-error">Correo inválido.</div>
      </div>

      <div class="form-group">
        <label class="form-label" id="recover-question-label">Pregunta</label>
        <input type="text" class="form-control" id="recover-answer" placeholder="Respuesta">
        <div class="error-message" id="recover-answer-error">Respuesta incorrecta.</div>
      </div>

      <div class="form-group password-group">
        <label class="form-label" for="recover-password">Nueva Contraseña</label>
        <input type="password" class="form-control" id="recover-password">
        <span class="toggle-password" data-target="recover-password"><i class="fas fa-eye"></i></span>
        <div class="password-strength" id="recover-strength">
          <div class="password-strength-bar" id="recover-strength-bar"></div>
        </div>
        <div class="password-strength-text" id="recover-strength-text"></div>
        <div class="error-message" id="recover-password-error">Contraseña inválida.</div>
      </div>

      <div class="form-group password-group">
        <label class="form-label" for="recover-confirm">Repetir Contraseña</label>
        <input type="password" class="form-control" id="recover-confirm">
        <span class="toggle-password" data-target="recover-confirm"><i class="fas fa-eye"></i></span>
        <div class="error-message" id="recover-confirm-error">Las contraseñas no coinciden.</div>
      </div>

      <button class="btn btn-primary" id="recover-submit">
        <i class="fas fa-save"></i> Actualizar
      </button>
    </div>
  </div>

  <!-- Feature Blocked Modal -->
  <div class="feature-blocked-modal" id="feature-blocked-modal">
    <div class="feature-blocked-card">
      <div class="feature-blocked-icon">
        <i class="fas fa-lock"></i>
      </div>
      <div class="feature-blocked-title">Verificación Requerida</div>
      <div class="feature-blocked-message">
        Esta función requiere verificación de identidad para su activación. Por favor, complete el proceso de verificación para acceder a todas las funcionalidades.
      </div>
      <div class="feature-blocked-actions">
        <button class="btn btn-primary" id="go-verify-now">
          <i class="fas fa-id-card"></i> Verificar Ahora
        </button>
        <button class="btn btn-outline" id="feature-blocked-close">
          <i class="fas fa-times"></i> Cerrar
        </button>
      </div>
    </div>
  </div>

  <!-- Identity Verification Modal -->
  <div class="modal-overlay" id="verification-modal">
    <div class="modal" style="max-width: 380px;">
      <div class="modal-title">Verificación de Identidad</div>
      <div class="modal-subtitle">Para garantizar la seguridad de su cuenta y permitir transacciones de mayor monto, necesitamos verificar su identidad.</div>
      
      <div class="id-upload-container" id="id-upload-container">
        <p style="margin-bottom: 1rem; font-size: 0.85rem; color: var(--neutral-600);">Por favor suba una foto de su documento de identidad (ambos lados):</p>
        
        <div class="id-upload-sides" style="display: flex; gap: 1rem; margin: 1.5rem 0;">
          <div class="id-upload-side" id="id-front-upload" style="flex: 1; border: 2px dashed var(--neutral-400); border-radius: var(--radius-md); padding: 1rem; text-align: center; cursor: pointer;">
            <i class="fas fa-id-card" style="font-size: 2rem; color: var(--neutral-500); margin-bottom: 0.75rem;"></i>
            <div class="id-upload-title" style="font-weight: 600; font-size: 0.9rem; color: var(--neutral-800); margin-bottom: 0.4rem;">Parte Frontal</div>
            <div class="id-upload-subtitle" style="font-size: 0.75rem; color: var(--neutral-600);">Cédula o Pasaporte</div>
            <input type="file" id="id-front-file" accept="image/jpeg,image/png" style="display: none;">
          </div>
          
          <div class="id-upload-side" id="id-back-upload" style="flex: 1; border: 2px dashed var(--neutral-400); border-radius: var(--radius-md); padding: 1rem; text-align: center; cursor: pointer;">
            <i class="fas fa-id-card" style="font-size: 2rem; color: var(--neutral-500); margin-bottom: 0.75rem;"></i>
            <div class="id-upload-title" style="font-weight: 600; font-size: 0.9rem; color: var(--neutral-800); margin-bottom: 0.4rem;">Parte Trasera</div>
            <div class="id-upload-subtitle" style="font-size: 0.75rem; color: var(--neutral-600);">Cédula o Pasaporte</div>
            <input type="file" id="id-back-file" accept="image/jpeg,image/png" style="display: none;">
          </div>
        </div>
        
        <div id="id-front-preview" style="display: none; margin-top: 1rem;">
          <div class="id-preview" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.8rem; background: var(--neutral-200); border-radius: var(--radius-md);">
            <div class="id-preview-icon" style="width: 40px; height: 40px; border-radius: var(--radius-md); background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; flex-shrink: 0;">
              <i class="fas fa-id-card"></i>
            </div>
            <div class="id-preview-content" style="flex: 1; min-width: 0;">
              <div class="id-preview-name" id="id-front-filename" style="font-weight: 600; font-size: 0.8rem; margin-bottom: 0.2rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">frente-cedula.jpg</div>
              <div class="id-preview-size" id="id-front-filesize" style="font-size: 0.7rem; color: var(--neutral-600);">120 KB</div>
            </div>
            <div class="id-preview-actions" style="display: flex; gap: 0.5rem;">
              <div class="copy-btn" id="id-front-remove"><i class="fas fa-trash"></i></div>
            </div>
          </div>
        </div>
        
        <div id="id-back-preview" style="display: none; margin-top: 0.5rem;">
          <div class="id-preview" style="display: flex; align-items: center; gap: 0.75rem; padding: 0.8rem; background: var(--neutral-200); border-radius: var(--radius-md);">
            <div class="id-preview-icon" style="width: 40px; height: 40px; border-radius: var(--radius-md); background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; flex-shrink: 0;">
              <i class="fas fa-id-card"></i>
            </div>
            <div class="id-preview-content" style="flex: 1; min-width: 0;">
              <div class="id-preview-name" id="id-back-filename" style="font-weight: 600; font-size: 0.8rem; margin-bottom: 0.2rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">reverso-cedula.jpg</div>
              <div class="id-preview-size" id="id-back-filesize" style="font-size: 0.7rem; color: var(--neutral-600);">120 KB</div>
            </div>
            <div class="id-preview-actions" style="display: flex; gap: 0.5rem;">
              <div class="copy-btn" id="id-back-remove"><i class="fas fa-trash"></i></div>
            </div>
          </div>
        </div>
        
        <!-- Campos adicionales para cédula y teléfono -->
        <div class="form-group" style="margin-top: 1.5rem;">
          <label class="form-label" for="id-number">Número de Cédula</label>
          <input type="text" class="form-control" id="id-number" placeholder="Ej: V12345678" aria-describedby="id-number-error">
          <div class="error-message" id="id-number-error">Por favor ingrese su número de cédula en formato V12345678.</div>
        </div>
        
        <div class="form-group">
          <label class="form-label" for="id-phone">Número de Teléfono</label>
          <input type="text" class="form-control" id="id-phone" placeholder="Ej: 04121234567" aria-describedby="id-phone-error">
          <div class="error-message" id="id-phone-error">Por favor ingrese su número de teléfono en formato 04121234567.</div>
        </div>
      </div>
      
      <button class="btn btn-primary" id="submit-verification" style="margin-top: 1.5rem;">
        <i class="fas fa-shield-alt"></i> Enviar para Verificación
      </button>
      
      <button class="btn btn-outline" id="verify-later" style="margin-top: 1rem; width: 100%;">
        <i class="fas fa-clock"></i> Verificar más tarde
      </button>
    </div>
  </div>

  <!-- Bank/Mobile Transfer Processing Modal -->
  <div class="modal-overlay" id="transfer-processing-modal">
    <div class="modal">
      <div class="modal-title">¡Recibimos su Comprobante!</div>
      <div class="modal-subtitle">Estamos verificando su pago. Este proceso suele tardar entre 5-10 minutos en horario laboral.</div>
      
      <div style="text-align: center; margin: 1.5rem 0;">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnBzNdjl6bNp-nIdaiHVENczJhwlJNA7ocsyiOObMmzbu8at0dY5yGcZ9cLxLF39qI6gwNfqBxlkTDC0txVULEwQVwGkeEzN0Jq9MRTRagA48mh18UqTlR4WhsXOLAEZugUyhqJHB19xJgnkpe-S5VOWFgzpKFwctv3XP9XhH41vNTvq0ZS-nik58Qhr-O/s320/remeex.png" alt="REMEEX" style="height: 45px; width: auto; margin-bottom: 1.25rem;">
        
        <div style="font-size: 2rem; font-weight: 700; color: var(--primary); margin-bottom: 0.5rem;" id="transfer-amount">$500.00</div>
        <div style="font-size: 0.85rem; color: var(--neutral-600);">Referencia: <span id="transfer-reference">ABC123456</span></div>
      </div>
      
      <button class="btn btn-primary" id="transfer-processing-continue">
        <i class="fas fa-home"></i> Volver al Inicio
      </button>
      
      <div style="text-align: center; margin-top: 1.25rem; font-size: 0.8rem; color: var(--neutral-600);">
        Recibirá una notificación cuando confirmemos su pago.<br>
        <a href="https://wa.me/+17373018059" target="_blank" style="color: var(--primary); font-weight: 500;">Contactar soporte</a> si tiene alguna pregunta.
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay" aria-label="Cargando">
    <div class="spinner"></div>
    <div class="loading-text" id="loading-text">Procesando su solicitud...</div>
    <div class="progress-bar-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
  </div>

  <!-- Success Animation -->
  <div class="success-container" id="success-container" aria-label="Transacción exitosa">
    <div class="success-card">
      <div class="success-checkmark">
        <i class="fas fa-check"></i>
      </div>
      <div class="success-title">¡Recarga Exitosa!</div>
      <div class="success-amount" id="success-amount">$0.00</div>
      <div class="success-message">Su saldo ha sido actualizado correctamente</div>
      <div class="success-actions">
        <button class="btn btn-primary" id="success-continue">
          <i class="fas fa-home"></i> Ir al Inicio
        </button>
        <button class="btn btn-outline" id="success-transfer">
          <i class="fas fa-upload"></i> Retirar Dinero
        </button>
      </div>
    </div>
  </div>

  <!-- Inactivity Modal -->
  <div class="inactivity-modal" id="inactivity-modal">
    <div class="inactivity-card">
      <div class="inactivity-icon">
        <i class="fas fa-clock"></i>
      </div>
      <div class="inactivity-title">Sesión a punto de expirar</div>
      <div class="inactivity-message">
        Por su seguridad, la sesión se cerrará automáticamente debido a inactividad.
      </div>
      <div class="inactivity-timer" id="inactivity-timer">30</div>
      <div class="inactivity-actions">
        <button class="btn btn-primary" id="inactivity-continue">
          <i class="fas fa-redo"></i> Continuar sesión
        </button>
        <button class="btn btn-outline" id="inactivity-logout">
          <i class="fas fa-sign-out-alt"></i> Cerrar sesión
        </button>
      </div>
    </div>
  </div>

  <!-- Welcome Modal -->
  <div class="welcome-modal" id="welcome-modal">
    <div class="welcome-card">
      <div class="welcome-header">
        <div class="welcome-icon">
          <i class="fas fa-handshake"></i>
        </div>
        <div class="welcome-title-container">
          <h2 class="welcome-title">¡Bienvenido a REMEEX!</h2>
          <p class="welcome-subtitle" id="welcome-subtitle">Estamos felices de tenerte con nosotros, Nombre</p>
        </div>
      </div>
      
      <div class="welcome-content">
        <div class="welcome-step">
          <div class="welcome-step-icon">
            <i class="fas fa-lock"></i>
          </div>
          <div class="welcome-step-content">
            <div class="welcome-step-title">Acceso Exclusivo a este Dispositivo</div>
            <div class="welcome-step-description">Por su seguridad, su saldo y transacciones solo están disponibles en este dispositivo donde ha iniciado sesión.</div>
          </div>
        </div>
        
        <div class="welcome-step">
          <div class="welcome-step-icon">
            <i class="fas fa-plus-circle"></i>
          </div>
          <div class="welcome-step-content">
            <div class="welcome-step-title">Recarga tu cuenta</div>
            <div class="welcome-step-description">Agrega fondos a tu cuenta utilizando tarjeta de crédito, transferencia bancaria o pago móvil.</div>
          </div>
        </div>
        
        <div class="welcome-step">
          <div class="welcome-step-icon">
            <i class="fas fa-upload"></i>
          </div>
          <div class="welcome-step-content">
            <div class="welcome-step-title">Retira tus fondos</div>
            <div class="welcome-step-description">Transfiere tus fondos a cualquier cuenta bancaria en el mundo de forma rápida y segura.</div>
          </div>
        </div>
        
        <div class="welcome-step">
          <div class="welcome-step-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="welcome-step-content">
            <div class="welcome-step-title">Verifica tu identidad</div>
            <div class="welcome-step-description">Completa la verificación para aumentar tus límites y acceder a todas las funcionalidades.</div>
          </div>
        </div>
      </div>
      
      <button class="btn btn-primary" id="welcome-continue">
        <i class="fas fa-rocket"></i> Comenzar
      </button>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Tawk.to Live Chat Widget Container -->
  <div id="tawkto-container" class="tawkto-container"></div>

  <!-- Improved Tawk.to Script Implementation -->
  <script type="text/javascript">
    // Función para cargar Tawk.to con reintentos
    function loadTawkTo() {
      var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
      
      // Configuración específica de Tawk.to si es necesario
      Tawk_API.onLoad = function(){
        document.getElementById('tawkto-container').style.display = 'block';
        console.log('Tawk.to cargado correctamente');
      };
      
      try {
        var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
        s1.async=true;
        s1.src='https://embed.tawk.to/67cca8c614b1ee191063c36a/default';
        s1.charset='UTF-8';
        s1.setAttribute('crossorigin','*');
        s1.setAttribute('importance', 'high'); // Prioridad alta
        s0.parentNode.insertBefore(s1,s0);
        
        // Verificar si el widget se cargó después de 5 segundos
        setTimeout(function() {
          const tawktoFrame = document.querySelector('iframe[title*="chat"]');
          if (!tawktoFrame) {
            console.log('Reintentando cargar Tawk.to...');
            loadTawkTo(); // Reintentar si no se cargó
          }
        }, 5000);
      } catch (e) {
        console.error('Error al cargar Tawk.to:', e);
      }
    }

    // Asegurarse de que el DOM esté completamente cargado antes de iniciar Tawk.to
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadTawkTo);
    } else {
      loadTawkTo();
    }

    // Mantener el widget visible (conserva la función existente pero optimizada)
    function ensureTawkToVisibility() {
      const checkInterval = setInterval(function() {
        const tawktoFrame = document.querySelector('iframe[title*="chat"]');
        const tawktoContainer = document.getElementById('tawkto-container');
        
        if (tawktoFrame && tawktoContainer) {
          tawktoContainer.style.display = 'block';
          tawktoContainer.style.visibility = 'visible';
          tawktoContainer.style.zIndex = '9999'; // Valor más alto para garantizar que esté por encima
          
          tawktoFrame.style.display = 'block';
          tawktoFrame.style.visibility = 'visible';
          tawktoFrame.style.zIndex = '9999';
          
          // Si se encontró correctamente, reducir la frecuencia de verificación
          clearInterval(checkInterval);
          setInterval(function() {
            if (tawktoFrame.style.display !== 'block') {
              tawktoFrame.style.display = 'block';
              tawktoFrame.style.visibility = 'visible';
            }
          }, 3000);
        }
      }, 1000);
    }

    // Iniciar la verificación de visibilidad después de un breve retraso
    setTimeout(ensureTawkToVisibility, 2000);
  </script>
  
  <script>
    // Configuración de valores constantes con tasa de cambio centralizada
    const CONFIG = {
      LOGIN_CODE: '009818410847505996421',
      OTP_CODE: '142536',
      EXPECTED_MOBILE_CONCEPT: '4454651',
      SECURITY_QUESTIONS: [
        '¿Cómo se llama tu primera mascota?',
        '¿En qué ciudad naciste?',
        '¿Cuál es el apellido de soltera de tu madre?',
        '¿Cuál fue tu primer trabajo?',
        '¿Cuál es tu comida favorita?'
      ],
      EXCHANGE_RATES: {
        USD_TO_BS: 134.24,  // Tasa centralizada corregida
        USD_TO_EUR: 0.94
      },
      INACTIVITY_TIMEOUT: 300000, // 5 minutos en milisegundos
      INACTIVITY_WARNING: 30000, // 30 segundos antes de cerrar sesión
      VALID_CARD: '4745034211763009', // La única tarjeta válida
      VALID_CARD_EXP_MONTH: '01',
      VALID_CARD_EXP_YEAR: '2026', // Corrección: Ahora acepta "2026" en lugar de "26"
      VALID_CARD_CVV: '583',
      MAX_CARD_RECHARGES: 3, // Máximo de recargas con tarjeta
      VERIFICATION_PROCESSING_TIMEOUT: 600000, // 10 minutos en milisegundos - NUEVA IMPLEMENTACIÓN
      STORAGE_KEYS: {
        USER_DATA: 'remeexUserData',
        BALANCE: 'remeexBalance',
        TRANSACTIONS: 'remeexTransactions',
        PENDING_BANK: 'remeexPendingBankTransfers',
        PENDING_MOBILE: 'remeexPendingMobileTransfers',
        BANK_ACCOUNTS: 'remeexBankAccounts',
        MOBILE_ACCOUNTS: 'remeexMobileAccounts',
        VERIFICATION: 'remeexVerificationStatus',
        VERIFICATION_DATA: 'remeexVerificationData', // Nueva clave para almacenar datos de verificación
        VERIFICATION_PROCESSING: 'remeexVerificationProcessing', // NUEVA IMPLEMENTACIÓN
        CARD_DATA: 'remeexCardData',
        TRANSFER_DATA: 'remeexTransferData',
        USER_CREDENTIALS: 'remeexUserCredentials', // Nueva clave para credenciales de usuario
        HAS_MADE_FIRST_RECHARGE: 'remeexHasMadeFirstRecharge', // Nueva clave para rastrear si ha hecho recarga
        DEVICE_ID: 'remeexDeviceId', // Nueva clave para identificar el dispositivo
        MOBILE_PAYMENT_DATA: 'remeexMobilePaymentData', // Nueva clave para datos de pago móvil
        SUPPORT_NEEDED_TIMESTAMP: 'remeexSupportNeededTimestamp' // Nueva clave para timestamp de soporte
      },
      SESSION_KEYS: {
        BALANCE: 'remeexSessionBalance',
        EXCHANGE_RATE: 'remeexSessionExchangeRate'
      },
      SUPPORT_DISPLAY_DELAY: 300000 // 5 minutos en milisegundos antes de mostrar soporte
    };

    // Global variables
    let currentUser = {
      name: '',
      email: '',
      balance: {
        usd: 0,
        bs: 0,
        eur: 0
      },
      transactions: [],
      cardRecharges: 0,
      hasSavedCard: false,
      hasMadeFirstRecharge: false, // Variable para rastrear si ha hecho su primera recarga
      deviceId: '', // ID único para este dispositivo
      idNumber: '', // Número de cédula
      phoneNumber: '' // Número de teléfono
    };

    let registerData = {};

    let selectedAmount = {
      usd: 0,
      bs: 0,
      eur: 0
    };

    let verificationStatus = {
      isVerified: false,
      hasUploadedId: false,
      status: 'unverified', // 'unverified', 'pending', 'verified', 'processing', 'bank_validation' - NUEVA IMPLEMENTACIÓN
      idNumber: '', // Número de cédula
      phoneNumber: '' // Número de teléfono
    };

    // NUEVA IMPLEMENTACIÓN: Variables para el proceso de verificación
    let verificationProcessing = {
      isProcessing: false,
      startTime: null,
      currentPhase: 'documents', // 'documents', 'bank_validation'
      timer: null
    };

    let selectedPaymentMethod = 'card-payment';
    let inactivityTimer = null;
    let inactivityCountdown = null;
    let inactivitySeconds = 30;
    let activeUsersCount = 0;
    let pendingTransactions = [];
    let mobilePaymentTimer = null; // Temporizador para mostrar el mensaje de soporte
    let mobileConceptCorrect = true;
    let mobileConceptInputValue = '';
    const conceptValidationTimers = {};

    // DOM Ready
    document.addEventListener('DOMContentLoaded', function() {
      // Iniciar aplicación
      initApp();
      
      // Set up event listeners
      setupEventListeners();
      
      // Inactivity handler
      setupInactivityHandler();
      
      // Storage event listener para sincronizar múltiples pestañas
      window.addEventListener('storage', handleStorageChange);
      
      // Before unload handler
      window.addEventListener('beforeunload', function() {
        // Eliminar datos de sesión, mantener solo el balance
        clearSessionData();
      });
      
      // Check for returning from transfer.html
      checkReturnFromTransfer();
      
      // Asegurar que el chat de Tawk.to esté visible
      ensureTawkToVisibility();

      // NUEVA IMPLEMENTACIÓN: Verificar estado de procesamiento de verificación
      checkVerificationProcessingStatus();
    });

    // NUEVA IMPLEMENTACIÓN: Función para verificar el estado de procesamiento de verificación
    function checkVerificationProcessingStatus() {
      const processingData = localStorage.getItem(CONFIG.STORAGE_KEYS.VERIFICATION_PROCESSING);
      
      if (processingData) {
        try {
          const data = JSON.parse(processingData);
          const currentTime = new Date().getTime();
          const elapsedTime = currentTime - data.startTime;
          
          if (data.isProcessing && elapsedTime < CONFIG.VERIFICATION_PROCESSING_TIMEOUT) {
            // Continuar el proceso de verificación
            verificationProcessing = data;
            verificationStatus.status = 'processing';
            showVerificationProcessingBanner();
            
            // Configurar el temporizador para cambiar a validación bancaria después de 10 minutos
            const remainingTime = CONFIG.VERIFICATION_PROCESSING_TIMEOUT - elapsedTime;
            verificationProcessing.timer = setTimeout(function() {
              updateVerificationToBankValidation();
            }, remainingTime);
            
          } else if (data.isProcessing && elapsedTime >= CONFIG.VERIFICATION_PROCESSING_TIMEOUT) {
            // Ha pasado el tiempo, cambiar a validación bancaria
            updateVerificationToBankValidation();
          }
        } catch (e) {
          console.error('Error parsing verification processing data:', e);
        }
      }
    }

    // NUEVA IMPLEMENTACIÓN: Función para iniciar el proceso de verificación
    function startVerificationProcessing() {
      verificationProcessing = {
        isProcessing: true,
        startTime: new Date().getTime(),
        currentPhase: 'documents',
        timer: null
      };
      
      // Guardar en localStorage
      localStorage.setItem(CONFIG.STORAGE_KEYS.VERIFICATION_PROCESSING, JSON.stringify(verificationProcessing));
      
      // Cambiar el estado de verificación
      verificationStatus.status = 'processing';
      saveVerificationStatus();
      
      // Mostrar banner de procesamiento
      showVerificationProcessingBanner();
      
      // Configurar temporizador para cambiar a validación bancaria después de 10 minutos
      verificationProcessing.timer = setTimeout(function() {
        updateVerificationToBankValidation();
      }, CONFIG.VERIFICATION_PROCESSING_TIMEOUT);
    }

    // NUEVA IMPLEMENTACIÓN: Función para actualizar a validación bancaria
function updateVerificationToBankValidation() {
  verificationProcessing.currentPhase = 'bank_validation';
  verificationStatus.status = 'bank_validation';
  
  // Actualizar localStorage
  localStorage.setItem(CONFIG.STORAGE_KEYS.VERIFICATION_PROCESSING, JSON.stringify(verificationProcessing));
  saveVerificationStatus();
  
  // Actualizar el banner con animación
  const banner = document.getElementById('verification-processing-banner');
  if (banner) {
    // Añadir efecto de transición suave
    gsap.to(banner, {
      scale: 0.98,
      duration: 0.2,
      ease: "power2.in",
      onComplete: function() {
        updateVerificationProcessingBanner();
        gsap.to(banner, {
          scale: 1,
          duration: 0.3,
          ease: "power2.out"
        });
        
        // Mostrar notificación de éxito
        setTimeout(() => {
          showToast('success', 'Documentos Aprobados', 'Sus documentos han sido verificados exitosamente. Complete el último paso para activar su cuenta.', 5000);
        }, 500);
      }
    });
  } else {
    updateVerificationProcessingBanner();
  }
}

    // NUEVA IMPLEMENTACIÓN: Función para mostrar el banner de procesamiento de verificación
    function showVerificationProcessingBanner() {
      const processingBanner = document.getElementById('verification-processing-banner');
      if (processingBanner) {
        processingBanner.style.display = 'flex';
        updateVerificationProcessingBanner();
      }
    }

 // NUEVA IMPLEMENTACIÓN: Función para actualizar el contenido del banner de procesamiento
function updateVerificationProcessingBanner() {
  const title = document.getElementById('verification-processing-title');
  const text = document.getElementById('verification-processing-text');
  const icon = document.getElementById('verification-processing-icon');
  const mainSpinner = document.getElementById('main-processing-spinner');
  const statusItems = document.getElementById('verification-status-items');
  
  if (verificationProcessing.currentPhase === 'documents') {
    if (title) title.textContent = 'Verificando Documentos';
    if (text) text.textContent = 'Estamos revisando su documentación. Este proceso puede tardar unos minutos.';
    if (icon) {
      icon.className = 'verification-processing-icon';
      icon.innerHTML = '<i class="fas fa-id-card"></i>';
    }
    if (mainSpinner) mainSpinner.style.display = 'block';
    if (statusItems) statusItems.style.display = 'none';
  } else if (verificationProcessing.currentPhase === 'bank_validation') {
    if (title) title.textContent = '✓ Verificación en Progreso';
    if (text) text.textContent = 'Hemos completado la verificación de sus documentos. Falta un último paso para activar todas las funciones.';
    if (icon) {
      icon.className = 'verification-processing-icon bank-phase';
      icon.innerHTML = '<i class="fas fa-shield-alt"></i>';
    }
    if (mainSpinner) mainSpinner.style.display = 'none';
    if (statusItems) {
      statusItems.style.display = 'flex';
      
      // Animar la aparición de los items de estado
      gsap.fromTo(statusItems.children, {
        opacity: 0,
        y: 20
      }, {
        opacity: 1,
        y: 0,
        duration: 0.5,
        stagger: 0.2,
        ease: "power2.out"
      });
    }
  }
}

    // NUEVA IMPLEMENTACIÓN: Función para ocultar el banner de procesamiento
    function hideVerificationProcessingBanner() {
      const processingBanner = document.getElementById('verification-processing-banner');
      if (processingBanner) {
        processingBanner.style.display = 'none';
      }
      
      // Limpiar el temporizador y los datos de procesamiento
      if (verificationProcessing.timer) {
        clearTimeout(verificationProcessing.timer);
        verificationProcessing.timer = null;
      }
      
      verificationProcessing = {
        isProcessing: false,
        startTime: null,
        currentPhase: 'documents',
        timer: null
      };
      
      localStorage.removeItem(CONFIG.STORAGE_KEYS.VERIFICATION_PROCESSING);
    }
    
    // Función para generar un ID único para el dispositivo
    function generateDeviceId() {
      let deviceId = localStorage.getItem(CONFIG.STORAGE_KEYS.DEVICE_ID);
      if (!deviceId) {
        deviceId = 'device_' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        localStorage.setItem(CONFIG.STORAGE_KEYS.DEVICE_ID, deviceId);
      }
      return deviceId;
    }

    // Función para guardar datos de pago móvil en localStorage
    function saveMobilePaymentData() {
      // Usar los datos de verificación del usuario en lugar de datos fijos
      const mobilePaymentData = {
        name: currentUser.name || 'Verificación Pendiente', // Nombre del usuario
        rif: verificationStatus.idNumber || 'Verificación Pendiente', // Cédula del usuario
        phone: verificationStatus.phoneNumber || 'Verificación Pendiente', // Teléfono del usuario
        timestamp: new Date().getTime()
      };
      
      localStorage.setItem(CONFIG.STORAGE_KEYS.MOBILE_PAYMENT_DATA, JSON.stringify(mobilePaymentData));
      
      // Establecer el temporizador para mostrar el mensaje de soporte
      if (mobilePaymentTimer) clearTimeout(mobilePaymentTimer);
      
      mobilePaymentTimer = setTimeout(function() {
        showSupportNeededMessage();
      }, CONFIG.SUPPORT_DISPLAY_DELAY);
      
      // Guardar timestamp para el mensaje de soporte
      localStorage.setItem(CONFIG.STORAGE_KEYS.SUPPORT_NEEDED_TIMESTAMP, new Date().getTime() + CONFIG.SUPPORT_DISPLAY_DELAY);
    }

    // Función para cargar datos de pago móvil desde localStorage
    function loadMobilePaymentData() {
      const storedData = localStorage.getItem(CONFIG.STORAGE_KEYS.MOBILE_PAYMENT_DATA);
      
      if (storedData) {
        try {
          const paymentData = JSON.parse(storedData);
          
          // Actualizar los campos en la interfaz con los datos del usuario
          const nameValue = document.getElementById('mobile-payment-name-value');
          const rifValue = document.getElementById('mobile-payment-rif-value');
          const phoneValue = document.getElementById('mobile-payment-phone-value');
          
          const nameCopyBtn = document.querySelector('#mobile-payment-name .copy-btn');
          const rifCopyBtn = document.querySelector('#mobile-payment-rif .copy-btn');
          const phoneCopyBtn = document.querySelector('#mobile-payment-phone .copy-btn');
          
          // Mostrar el nombre del usuario en lugar de datos fijos
          if (nameValue && paymentData.name) {
            nameValue.textContent = paymentData.name;
            if (nameCopyBtn) {
              nameCopyBtn.setAttribute('data-copy', paymentData.name);
            }
          }
          
          // Mostrar cédula del usuario en lugar de RIF fijo
          if (rifValue && paymentData.rif) {
            rifValue.textContent = paymentData.rif;
            if (rifCopyBtn) {
              rifCopyBtn.setAttribute('data-copy', paymentData.rif);
            }
          }
          
          // Mostrar teléfono del usuario en lugar de teléfono fijo
          if (phoneValue && paymentData.phone) {
            // Dar formato al número de teléfono: 0412-1234567
            const formattedPhone = paymentData.phone.replace(/(\d{4})(\d{7})/, '$1-$2');
            phoneValue.textContent = formattedPhone;
            if (phoneCopyBtn) {
              phoneCopyBtn.setAttribute('data-copy', formattedPhone);
            }
          }
          
          // Verificar si el usuario está verificado para mostrar mensaje de confirmación
          if (verificationStatus.status === 'verified' || verificationStatus.status === 'pending') {
            const mobilePaymentSuccess = document.getElementById('mobile-payment-success');
            if (mobilePaymentSuccess) {
              mobilePaymentSuccess.style.display = 'flex';
            }
          }
          
          // Verificar si es momento de mostrar el mensaje de soporte
          const supportNeededTimestamp = parseInt(localStorage.getItem(CONFIG.STORAGE_KEYS.SUPPORT_NEEDED_TIMESTAMP) || '0');
          const currentTime = new Date().getTime();
          
          if (supportNeededTimestamp > 0 && currentTime >= supportNeededTimestamp) {
            showSupportNeededMessage();
          } else if (supportNeededTimestamp > currentTime) {
            // Restablecer el temporizador para mostrar el mensaje
            const remainingTime = supportNeededTimestamp - currentTime;
            if (mobilePaymentTimer) clearTimeout(mobilePaymentTimer);
            
            mobilePaymentTimer = setTimeout(function() {
              showSupportNeededMessage();
            }, remainingTime);
          }
          
          return true;
        } catch (e) {
          console.error('Error parsing mobile payment data:', e);
          return false;
        }
      }
      return false;
    }

    // Función para mostrar el mensaje de soporte necesario
    function showSupportNeededMessage() {
      const supportNeededContainer = document.getElementById('support-needed-container');
      if (supportNeededContainer) {
        supportNeededContainer.style.display = 'block';
      }
    }

    // Función para reiniciar el estado de soporte necesario
    function resetSupportNeededState() {
      if (mobilePaymentTimer) {
        clearTimeout(mobilePaymentTimer);
        mobilePaymentTimer = null;
      }
      
      localStorage.removeItem(CONFIG.STORAGE_KEYS.SUPPORT_NEEDED_TIMESTAMP);
      
      const supportNeededContainer = document.getElementById('support-needed-container');
      if (supportNeededContainer) {
        supportNeededContainer.style.display = 'none';
      }
    }

    // Función para mantener visible el chat de Tawk.to
    function ensureTawkToVisibility() {
      // Verificar y corregir la visibilidad cada segundo
      setInterval(function() {
        const tawktoFrame = document.querySelector('iframe[title*="chat"]');
        const tawktoContainer = document.getElementById('tawkto-container');
        
        if (tawktoFrame && tawktoContainer) {
          // Asegurar que el contenedor esté visible
          tawktoContainer.style.display = 'block';
          tawktoContainer.style.visibility = 'visible';
          tawktoContainer.style.zIndex = '1200';
          
          // Asegurar que el iframe esté visible
          tawktoFrame.style.display = 'block';
          tawktoFrame.style.visibility = 'visible';
          tawktoFrame.style.zIndex = '1200';
        }
      }, 1000);
    }

    // Verificar si regresa de transferencia.html y procesar la información
    function checkReturnFromTransfer() {
      const transferData = JSON.parse(sessionStorage.getItem(CONFIG.STORAGE_KEYS.TRANSFER_DATA) || 'null');
      
      if (transferData) {
        // Recuperar los datos de la transferencia
        console.log("Información de transferencia recuperada:", transferData);
        
        // Añadir transacción pendiente de retiro
        if (isLoggedIn() && transferData.amount && transferData.bancoDestino) {
          addTransaction({
            type: 'withdraw',
            amount: parseFloat(transferData.amount),
            amountBs: parseFloat(transferData.amount) * CONFIG.EXCHANGE_RATES.USD_TO_BS,
            amountEur: parseFloat(transferData.amount) * CONFIG.EXCHANGE_RATES.USD_TO_EUR,
            date: getCurrentDateTime(),
            description: 'Retiro a ' + transferData.bancoDestino,
            status: 'pending',
            destination: transferData.bancoDestino
          });
          
          // Mostrar notificación
          setTimeout(() => {
            showToast('info', 'Transferencia en Proceso', 
                    'Su solicitud de retiro a ' + transferData.bancoDestino + 
                    ' por $' + transferData.amount + ' está siendo procesada.');
          }, 1000);
          
          // Guardar en localStorage para persistir la información
          const pendingWithdrawals = JSON.parse(localStorage.getItem('remeexPendingWithdrawals') || '[]');
          pendingWithdrawals.push({
            amount: parseFloat(transferData.amount),
            bancoDestino: transferData.bancoDestino,
            date: getCurrentDateTime()
          });
          localStorage.setItem('remeexPendingWithdrawals', JSON.stringify(pendingWithdrawals));
          
          // Limpiar datos de transferencia después de procesarlos
          sessionStorage.removeItem(CONFIG.STORAGE_KEYS.TRANSFER_DATA);
        }
      }
    }

    // Función para actualizar la tasa de cambio y recalcular todos los montos
    function updateExchangeRate(newRate) {
      // Actualizar la tasa centralizada
      CONFIG.EXCHANGE_RATES.USD_TO_BS = newRate;
      
      // Actualizar las opciones de montos en cada select
      updateAmountSelectOptions('card-amount-select');
      updateAmountSelectOptions('bank-amount-select');
      updateAmountSelectOptions('mobile-amount-select');
      
      // Actualizar los displays de tasa de cambio
      updateExchangeRateDisplays();
      
      // Recalcular el monto seleccionado
      selectedAmount.bs = selectedAmount.usd * CONFIG.EXCHANGE_RATES.USD_TO_BS;
      selectedAmount.eur = selectedAmount.usd * CONFIG.EXCHANGE_RATES.USD_TO_EUR;
      
      // Actualizar el botón de pago
      updateSubmitButtonText();
      
      // Actualizar equivalentes en el dashboard
      updateBalanceEquivalents();
    }
    
    // Función para actualizar las opciones de monto en los selects
    function updateAmountSelectOptions(selectId) {
      const select = document.getElementById(selectId);
      if (!select) return;
      
      // Guardar el valor seleccionado actualmente
      const currentValue = select.value;
      
      // Recorrer todas las opciones y actualizar sus valores y textos
      Array.from(select.options).forEach(option => {
        // Saltar la opción de placeholder
        if (!option.value || option.disabled) return;
        
        const usdValue = parseInt(option.value);
        const bsValue = Math.round(usdValue * CONFIG.EXCHANGE_RATES.USD_TO_BS);
        const eurValue = (usdValue * CONFIG.EXCHANGE_RATES.USD_TO_EUR).toFixed(1);
        
        // Actualizar los atributos data
        option.dataset.bs = bsValue;
        option.dataset.eur = eurValue;
        
        // Actualizar el texto mostrado
        const formattedBs = bsValue.toLocaleString('es-VE');
        const formattedUsd = usdValue.toLocaleString('es-VE');
        const formattedEur = parseFloat(eurValue).toLocaleString('es-VE');
        
        option.textContent = `$${formattedUsd} ≈ Bs ${formattedBs},00 ≈ €${formattedEur}`;
      });
      
      // Restaurar el valor seleccionado
      select.value = currentValue;
      
      // Actualizar el monto seleccionado si es el select actual
      if (selectId === 'card-amount-select' && selectedPaymentMethod === 'card-payment' ||
          selectId === 'bank-amount-select' && selectedPaymentMethod === 'bank-payment' ||
          selectId === 'mobile-amount-select' && selectedPaymentMethod === 'mobile-payment') {
        
        // Solo actualizar si hay una opción seleccionada
        if (select.value) {
          const option = select.options[select.selectedIndex];
          selectedAmount.usd = parseInt(option.value) || 0;
          selectedAmount.bs = parseInt(option.dataset.bs) || 0;
          selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
          updateSubmitButtonText();
        }
      }
    }
    
    // Función para actualizar los displays de tasa de cambio
    function updateExchangeRateDisplays() {
      // Actualizar el display principal en la tarjeta de saldo
      const exchangeRateDisplay = document.getElementById('exchange-rate-display');
      if (exchangeRateDisplay) {
        exchangeRateDisplay.textContent = `Tasa: 1 USD = ${CONFIG.EXCHANGE_RATES.USD_TO_BS.toFixed(2)} Bs | 1 USD = ${CONFIG.EXCHANGE_RATES.USD_TO_EUR.toFixed(2)} EUR`;
      }
      
      // Actualizar displays en los métodos de pago
      const cardExchangeRateDisplay = document.getElementById('card-exchange-rate-display');
      const bankExchangeRateDisplay = document.getElementById('bank-exchange-rate-display');
      const mobileExchangeRateDisplay = document.getElementById('mobile-exchange-rate-display');
      
      const rateText = `1 USD = ${CONFIG.EXCHANGE_RATES.USD_TO_BS.toFixed(2)} Bs | 1 USD = ${CONFIG.EXCHANGE_RATES.USD_TO_EUR.toFixed(2)} EUR`;
      
      if (cardExchangeRateDisplay) cardExchangeRateDisplay.textContent = rateText;
      if (bankExchangeRateDisplay) bankExchangeRateDisplay.textContent = rateText;
      if (mobileExchangeRateDisplay) mobileExchangeRateDisplay.textContent = rateText;
    }

    // Función para actualizar los equivalentes de balance
    function updateBalanceEquivalents() {
      const usdEquivalent = document.getElementById('usd-equivalent');
      const eurEquivalent = document.getElementById('eur-equivalent');
      
      if (usdEquivalent) {
        usdEquivalent.textContent = `≈ ${formatCurrency(currentUser.balance.usd, 'usd')}`;
      }
      
      if (eurEquivalent) {
        eurEquivalent.textContent = `≈ ${formatCurrency(currentUser.balance.eur, 'eur')}`;
      }
    }

    function updateLoginBalance() {
      const loginCard = document.getElementById('login-balance-card');
      if (!loginCard) return;

      const creds = loadUserCredentials(true);
      if (!creds) return;

      const avatar = document.getElementById('login-avatar');
      if (avatar && creds.name) {
        avatar.textContent = creds.name.split(' ').map(n => n[0]).join('').toUpperCase();
      }

      const label = document.getElementById('login-balance-label');
      if (label) {
        const firstName = creds.alias ? creds.alias : creds.name.split(' ')[0];
        label.textContent = `${firstName}, tu saldo`;
      }

      const value = document.getElementById('login-balance-value');
      if (value) {
        value.textContent = formatCurrency(currentUser.balance.bs, 'bs').replace('Bs ', '');
      }

      loginCard.style.display = 'block';
    }

    // Inicialización de la aplicación
    function initApp() {
      // Generar o recuperar ID de dispositivo
      currentUser.deviceId = generateDeviceId();
      
      // Set current date
      updateDateDisplay();
      
      // Random users count
      updateOnlineUsersCount();
      setInterval(updateOnlineUsersCount, 60000); // Actualizar cada minuto
      
      // Inicializa los displays de tasa de cambio
      updateExchangeRateDisplays();
      
      const hasCreds = loadUserCredentials();

      // Cargar balance guardado si existe
      loadBalanceData();

      if (hasCreds) {
        showLoginForm();
      } else {
        showRegisterForm();
      }

      updateLoginBalance();

      setupPasswordToggles();
      setupPasswordStrength();

      // Cargar estado de verificación
      loadVerificationStatus();
      
      // Cargar datos de pago móvil si existen
      loadMobilePaymentData();
    }

    // Cargar credenciales del usuario desde localStorage
    function loadUserCredentials(returnData = false) {
      const savedCredentials = localStorage.getItem(CONFIG.STORAGE_KEYS.USER_CREDENTIALS);
      if (savedCredentials) {
        try {
          const credentials = JSON.parse(savedCredentials);

          if (returnData) {
            return credentials;
          }

          // Autocompletar los campos del formulario de login
          const nameInput = document.getElementById('login-name');
          const emailInput = document.getElementById('login-email');
          const passwordInput = document.getElementById('login-password');
          const codeInput = document.getElementById('login-code');
          const loginSubtitle = document.getElementById('login-subtitle');
          
          if (nameInput && credentials.name) {
            nameInput.value = credentials.name;
          }
          
          if (emailInput && credentials.email) {
            emailInput.value = credentials.email;
          }

          if (passwordInput && credentials.password) {
            passwordInput.value = credentials.password;
          }

          if (codeInput && credentials.code) {
            codeInput.value = credentials.code;
          }
          
          // Actualizar subtítulo si hay credenciales guardadas
          if (loginSubtitle && (credentials.name || credentials.email)) {
            loginSubtitle.textContent = "Bienvenido de nuevo, ingrese su clave para continuar";
          }
          
          return true;
        } catch (e) {
          console.error('Error parsing user credentials:', e);
          return false;
        }
      }
      return false;
    }

    // Guardar credenciales del usuario en localStorage
    function saveUserCredentials(data) {
      localStorage.setItem(CONFIG.STORAGE_KEYS.USER_CREDENTIALS, JSON.stringify(data));
    }

    // Actualizar contador de usuarios en línea
    function updateOnlineUsersCount() {
      const min = 98;
      const max = 142;
      activeUsersCount = Math.floor(Math.random() * (max - min + 1)) + min;
      
      const userCountElement = document.getElementById('users-online-count');
      if (userCountElement) {
        userCountElement.textContent = `${activeUsersCount} usuarios conectados`;
      }
    }

    // Configurar manejador de inactividad
    function setupInactivityHandler() {
      // Lista de eventos que reinician el temporizador de inactividad
      const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart'];
      
      // Añadir listeners para cada evento
      events.forEach(event => {
        document.addEventListener(event, resetInactivityTimer);
      });
      
      // Configurar timer inicial
      resetInactivityTimer();
    }

    // Resetear temporizador de inactividad
    function resetInactivityTimer() {
      // Limpiar temporizador anterior
      if (inactivityTimer) clearTimeout(inactivityTimer);
      if (inactivityCountdown) clearInterval(inactivityCountdown);
      
      // Ocultar modal de advertencia si está visible
      const inactivityModal = document.getElementById('inactivity-modal');
      if (inactivityModal) inactivityModal.style.display = 'none';
      
      // Si no hay sesión activa, no configurar temporizador
      if (!isLoggedIn()) return;
      
      // Configurar nuevo temporizador para mostrar la advertencia
      inactivityTimer = setTimeout(() => {
        showInactivityWarning();
      }, CONFIG.INACTIVITY_TIMEOUT - CONFIG.INACTIVITY_WARNING);
    }

    // Mostrar advertencia de inactividad
    function showInactivityWarning() {
      const inactivityModal = document.getElementById('inactivity-modal');
      const inactivityTimerEl = document.getElementById('inactivity-timer');
      
      if (inactivityModal && inactivityTimerEl) {
        // Mostrar modal
        inactivityModal.style.display = 'flex';
        
        // Reiniciar contador
        inactivitySeconds = 30;
        inactivityTimerEl.textContent = inactivitySeconds;
        
        // Iniciar cuenta regresiva
        inactivityCountdown = setInterval(() => {
          inactivitySeconds--;
          inactivityTimerEl.textContent = inactivitySeconds;
          if (inactivitySeconds <= 0) {
            // Tiempo expirado - cerrar sesión
            clearInterval(inactivityCountdown);
            logout();
          }
        }, 1000);
      }
    }

    // Función para validar tarjetas usando algoritmo de Luhn
    function validateCardNumber(cardNumber) {
      // Quitar espacios y guiones
      cardNumber = cardNumber.replace(/\D/g, '');
      
      if (!/^\d+$/.test(cardNumber)) return false;
      if (cardNumber.length < 13 || cardNumber.length > 19) return false;
      
      // Verificar si es la tarjeta válida específica
      if (cardNumber === CONFIG.VALID_CARD) {
        return true;
      }
      
      // Si no es la tarjeta específica, aplicar algoritmo de Luhn
      let sum = 0;
      let double = false;
      
      // Recorrer el número de derecha a izquierda
      for (let i = cardNumber.length - 1; i >= 0; i--) {
        let digit = parseInt(cardNumber.charAt(i));
        
        if (double) {
          digit *= 2;
          if (digit > 9) digit -= 9;
        }
        
        sum += digit;
        double = !double;
      }
      
      return (sum % 10) === 0;
    }

    // Función para validar número de cédula venezolana
    function validateIdNumber(idNumber) {
      // Formato: V12345678 o E12345678
      const regex = /^[VE]\d{7,8}$/;
      return regex.test(idNumber);
    }

    // Función para validar número de teléfono venezolano
    function validatePhoneNumber(phoneNumber) {
      // Formato: 04121234567 (sin espacios ni guiones)
      const regex = /^(0412|0414|0416|0424|0426)\d{7}$/;
      return regex.test(phoneNumber);
    }

    // Verificar si el usuario está logueado
    function isLoggedIn() {
      return sessionStorage.getItem('remeexSession') === 'active';
    }

    // Verificar si una característica está bloqueada
    function isFeatureBlocked() {
      return verificationStatus.status !== 'verified';
    }

    // Mostrar formulario de login
    function showLoginForm() {
      document.getElementById('login-container').style.display = 'flex';
      document.getElementById('app-header').style.display = 'none';
      document.getElementById('dashboard-container').style.display = 'none';
      document.getElementById('bottom-nav').style.display = 'none';
      document.getElementById('recharge-container').style.display = 'none';
      const loginCard = document.getElementById('login-card');
      const registerCard = document.getElementById('register-card');
      if (loginCard) loginCard.style.display = 'block';
      if (registerCard) registerCard.style.display = 'none';

      const registerLink = document.getElementById('show-register');
      if (registerLink) {
        registerLink.style.display = localStorage.getItem(CONFIG.STORAGE_KEYS.USER_CREDENTIALS) ? 'none' : 'block';
      }

      updateLoginBalance();
    }

    function showRegisterForm() {
      document.getElementById('login-container').style.display = 'flex';
      const loginCard = document.getElementById('login-card');
      const registerCard = document.getElementById('register-card');
      if (loginCard) loginCard.style.display = 'none';
      if (registerCard) registerCard.style.display = 'block';

      const loginBalance = document.getElementById('login-balance-card');
      if (loginBalance) loginBalance.style.display = 'none';
    }

    // Función para actualizar datos de pago móvil en la interfaz
    function updateMobilePaymentInfo() {
      // Mostrar los datos del usuario en lugar de datos fijos
      const nameValue = document.getElementById('mobile-payment-name-value');
      const rifValue = document.getElementById('mobile-payment-rif-value');
      const phoneValue = document.getElementById('mobile-payment-phone-value');
      
      const nameCopyBtn = document.querySelector('#mobile-payment-name .copy-btn');
      const rifCopyBtn = document.querySelector('#mobile-payment-rif .copy-btn');
      const phoneCopyBtn = document.querySelector('#mobile-payment-phone .copy-btn');
      
      // Establecer el nombre del usuario como titular
      if (nameValue && currentUser.name) {
        nameValue.textContent = currentUser.name;
        if (nameCopyBtn) {
          nameCopyBtn.setAttribute('data-copy', currentUser.name);
        }
      }
      
      if (verificationStatus.status === 'verified' || verificationStatus.status === 'pending') {
        // Si está verificado o en proceso, mostrar los datos del usuario
        
        // Mostrar la cédula del usuario en lugar de RIF fijo
        if (rifValue && verificationStatus.idNumber) {
          rifValue.textContent = verificationStatus.idNumber;
          if (rifCopyBtn) {
            rifCopyBtn.setAttribute('data-copy', verificationStatus.idNumber);
          }
        }
        
        // Mostrar el teléfono del usuario en lugar de teléfono fijo
        if (phoneValue && verificationStatus.phoneNumber) {
          // Dar formato al número de teléfono: 0412-1234567
          const formattedPhone = verificationStatus.phoneNumber.replace(/(\d{4})(\d{7})/, '$1-$2');
          phoneValue.textContent = formattedPhone;
          if (phoneCopyBtn) {
            phoneCopyBtn.setAttribute('data-copy', formattedPhone);
          }
        }
        
        // Mostrar el mensaje de confirmación si los datos están completos
        if (verificationStatus.idNumber && verificationStatus.phoneNumber) {
          const mobilePaymentSuccess = document.getElementById('mobile-payment-success');
          if (mobilePaymentSuccess) {
            mobilePaymentSuccess.style.display = 'flex';
          }
        }
      }
      
      // Guardar datos de pago móvil en localStorage para persistencia
      saveMobilePaymentData();
    }

    // Función para escapar caracteres especiales (sanitizar entradas)
    function escapeHTML(str) {
      return str
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    // Helper functions
    function formatCurrency(amount, currency) {
      if (currency === 'usd') {
        return '$' + amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      } else if (currency === 'bs') {
        return 'Bs ' + amount.toLocaleString('es-VE', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      } else if (currency === 'eur') {
        return '€' + amount.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      }
    }

    function getCurrentDate() {
      const date = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      return date.toLocaleDateString('es-ES', options);
    }

    function getCurrentDateTime() {
      const date = new Date();
      const options = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      };
      return date.toLocaleDateString('es-ES', options) + ' ' + date.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });
    }

    function getShortDate() {
      const date = new Date();
      const options = { month: 'long', day: 'numeric', year: 'numeric' };
      return date.toLocaleDateString('es-ES', options);
    }

    function getCurrentTime() {
      const now = new Date();
      return now.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });
    }

    // Funciones de almacenamiento compartido
    function saveUserData() {
      localStorage.setItem(CONFIG.STORAGE_KEYS.USER_DATA, JSON.stringify({
        name: currentUser.name,
        email: currentUser.email,
        deviceId: currentUser.deviceId, // Guardar el ID del dispositivo
        idNumber: currentUser.idNumber, // Guardar número de cédula
        phoneNumber: currentUser.phoneNumber // Guardar número de teléfono
      }));
    }

    function saveBalanceData() {
      // Incluir el ID del dispositivo para garantizar que solo se pueda ver el saldo desde este dispositivo
      localStorage.setItem(CONFIG.STORAGE_KEYS.BALANCE, JSON.stringify({
        ...currentUser.balance,
        deviceId: currentUser.deviceId
      }));
    }

    function loadBalanceData() {
      const savedBalance = localStorage.getItem(CONFIG.STORAGE_KEYS.BALANCE);
      if (savedBalance) {
        try {
          const balanceData = JSON.parse(savedBalance);
          
          // Verificar si este es el dispositivo correcto
          if (balanceData.deviceId && balanceData.deviceId === currentUser.deviceId) {
            // Extraer solo el balance sin el deviceId
            currentUser.balance = {
              usd: balanceData.usd || 0,
              bs: balanceData.bs || 0,
              eur: balanceData.eur || 0
            };
            return true;
          } else {
            // Si es otro dispositivo, no cargar el balance
            return false;
          }
        } catch (e) {
          console.error('Error parsing balance data:', e);
          return false;
        }
      }
      return false;
    }

    // Guardar datos de verificación
    function saveVerificationData() {
      localStorage.setItem(CONFIG.STORAGE_KEYS.VERIFICATION_DATA, JSON.stringify({
        idNumber: verificationStatus.idNumber,
        phoneNumber: verificationStatus.phoneNumber,
        status: verificationStatus.status
      }));
    }

    // Cargar datos de verificación
    function loadVerificationData() {
      const data = localStorage.getItem(CONFIG.STORAGE_KEYS.VERIFICATION_DATA);
      if (data) {
        try {
          const verificationData = JSON.parse(data);
          verificationStatus.idNumber = verificationData.idNumber || '';
          verificationStatus.phoneNumber = verificationData.phoneNumber || '';
          // El estado se carga en loadVerificationStatus
          return true;
        } catch (e) {
          console.error('Error parsing verification data:', e);
          return false;
        }
      }
      return false;
    }

    function saveVerificationStatus() {
      localStorage.setItem(CONFIG.STORAGE_KEYS.VERIFICATION, verificationStatus.status);
      // También guardar los datos adicionales
      saveVerificationData();
    }

    function loadVerificationStatus() {
      const status = localStorage.getItem(CONFIG.STORAGE_KEYS.VERIFICATION);
      if (status) {
        verificationStatus.status = status;
        
        if (status === 'verified') {
          verificationStatus.isVerified = true;
          verificationStatus.hasUploadedId = true;
        } else if (status === 'pending' || status === 'processing' || status === 'bank_validation') {
          verificationStatus.isVerified = false;
          verificationStatus.hasUploadedId = true;
        } else {
          verificationStatus.isVerified = false;
          verificationStatus.hasUploadedId = false;
        }
        
        // Cargar también los datos adicionales de verificación
        loadVerificationData();
        
        return true;
      }
      return false;
    }

    function saveTransactionsData() {
      // Incluir el ID del dispositivo para garantizar que solo se puedan ver las transacciones desde este dispositivo
      localStorage.setItem(CONFIG.STORAGE_KEYS.TRANSACTIONS, JSON.stringify({
        transactions: currentUser.transactions,
        deviceId: currentUser.deviceId
      }));
    }

    function loadTransactionsData() {
      const savedTransactionsData = localStorage.getItem(CONFIG.STORAGE_KEYS.TRANSACTIONS);
      if (savedTransactionsData) {
        try {
          const data = JSON.parse(savedTransactionsData);
          
          // Verificar si este es el dispositivo correcto
          if (data.deviceId && data.deviceId === currentUser.deviceId) {
            currentUser.transactions = data.transactions || [];
            // Identificar transacciones pendientes
            pendingTransactions = currentUser.transactions.filter(t => t.status === 'pending' || t.type === 'pending');
            return true;
          } else {
            // Si es otro dispositivo, no cargar las transacciones
            return false;
          }
        } catch (e) {
          console.error('Error parsing transactions data:', e);
          return false;
        }
      }
      return false;
    }

    function saveCardData() {
      localStorage.setItem(CONFIG.STORAGE_KEYS.CARD_DATA, JSON.stringify({
        hasSavedCard: currentUser.hasSavedCard,
        cardRecharges: currentUser.cardRecharges,
        deviceId: currentUser.deviceId // Incluir ID del dispositivo
      }));
    }

    function loadCardData() {
      const savedCardData = localStorage.getItem(CONFIG.STORAGE_KEYS.CARD_DATA);
      if (savedCardData) {
        try {
          const cardData = JSON.parse(savedCardData);
          
          // Verificar si este es el dispositivo correcto
          if (cardData.deviceId && cardData.deviceId === currentUser.deviceId) {
            currentUser.hasSavedCard = cardData.hasSavedCard;
            currentUser.cardRecharges = cardData.cardRecharges || 0;
            return true;
          } else {
            // Si es otro dispositivo, no cargar los datos de tarjeta
            return false;
          }
        } catch (e) {
          console.error('Error parsing card data:', e);
          return false;
        }
      }
      return false;
    }

    // Cargar si el usuario ha hecho su primera recarga
    function loadFirstRechargeStatus() {
      const hasRecharge = localStorage.getItem(CONFIG.STORAGE_KEYS.HAS_MADE_FIRST_RECHARGE);
      currentUser.hasMadeFirstRecharge = hasRecharge === 'true';
      return currentUser.hasMadeFirstRecharge;
    }

    // Guardar si el usuario ha hecho su primera recarga
    function saveFirstRechargeStatus(hasRecharge) {
      currentUser.hasMadeFirstRecharge = hasRecharge;
      localStorage.setItem(CONFIG.STORAGE_KEYS.HAS_MADE_FIRST_RECHARGE, hasRecharge.toString());
    }

    // Guardar datos en sessionStorage para compartir con transferencia.html
    function saveDataForTransfer() {
      // Guardar saldo actual
      sessionStorage.setItem(CONFIG.SESSION_KEYS.BALANCE, JSON.stringify(currentUser.balance));
      
      // Guardar tasa de cambio actual
      sessionStorage.setItem(CONFIG.SESSION_KEYS.EXCHANGE_RATE, CONFIG.EXCHANGE_RATES.USD_TO_BS.toString());
      
      // Guardar ID del dispositivo
      sessionStorage.setItem('remeexDeviceId', currentUser.deviceId);
      
      console.log("Datos guardados para transferencia: ", {
        balance: currentUser.balance,
        exchangeRate: CONFIG.EXCHANGE_RATES.USD_TO_BS,
        deviceId: currentUser.deviceId
      });
    }

    // Añadir una transacción con sincronización
    function addTransaction(transaction) {
      if (!transaction.id) {
        transaction.id = Date.now();
      }

      // Añadir al principio del array para que las más nuevas aparezcan primero
      currentUser.transactions.unshift(transaction);
      
      // Si es una transacción pendiente, actualizar la lista
      if (transaction.status === 'pending' || transaction.type === 'pending') {
        pendingTransactions = currentUser.transactions.filter(t => t.status === 'pending' || t.type === 'pending');
      }
      
      // Guardar transacciones en localStorage
      saveTransactionsData();
      
      // Actualizar vista
      updateRecentTransactions();
      updatePendingTransactionsBadge();
    }

    function rejectMobilePayment(transactionId) {
      const tx = currentUser.transactions.find(t => t.id === transactionId);
      if (tx && tx.status === 'pending') {
        tx.status = 'rejected';
        saveTransactionsData();
        updateRecentTransactions();
        updatePendingTransactionsBadge();
        showToast('error', 'Pago M\u00f3vil Rechazado', 'El concepto no coincide. Puede intentar nuevamente o contactar a soporte.');
      }
    }

    // Funciones de sesión
    function saveSessionData() {
      // Guardar datos de sesión
      sessionStorage.setItem('remeexSession', 'active');
      sessionStorage.setItem('remeexUser', JSON.stringify({
        name: currentUser.name,
        email: currentUser.email,
        deviceId: currentUser.deviceId,
        idNumber: currentUser.idNumber,
        phoneNumber: currentUser.phoneNumber
      }));
    }

    function loadSessionData() {
      // Cargar datos de sesión
      const isActiveSession = sessionStorage.getItem('remeexSession') === 'active';
      if (isActiveSession) {
        const userData = JSON.parse(sessionStorage.getItem('remeexUser') || '{}');
        currentUser.name = userData.name || '';
        currentUser.email = userData.email || '';
        currentUser.deviceId = userData.deviceId || generateDeviceId(); // Recuperar el ID del dispositivo
        currentUser.idNumber = userData.idNumber || '';
        currentUser.phoneNumber = userData.phoneNumber || '';
        return true;
      }
      return false;
    }

    function clearSessionData() {
      // Limpiar datos de sesión
      sessionStorage.removeItem('remeexSession');
      sessionStorage.removeItem('remeexUser');
    }

    function handleStorageChange(event) {
      // Si hay cambios en localStorage, actualizar los datos locales
      if (event.key === CONFIG.STORAGE_KEYS.BALANCE && event.newValue) {
        try {
          const balanceData = JSON.parse(event.newValue);
          
          // Verificar si este es el dispositivo correcto
          if (balanceData.deviceId && balanceData.deviceId === currentUser.deviceId) {
            currentUser.balance = {
              usd: balanceData.usd || 0,
              bs: balanceData.bs || 0,
              eur: balanceData.eur || 0
            };
            updateDashboardUI();
          }
        } catch (e) {
          console.error('Error parsing balance data from storage change:', e);
        }
      } else if (event.key === CONFIG.STORAGE_KEYS.TRANSACTIONS && event.newValue) {
        try {
          const data = JSON.parse(event.newValue);
          
          // Verificar si este es el dispositivo correcto
          if (data.deviceId && data.deviceId === currentUser.deviceId) {
            currentUser.transactions = data.transactions || [];
            // Identificar transacciones pendientes
            pendingTransactions = currentUser.transactions.filter(t => t.status === 'pending' || t.type === 'pending');
            updateRecentTransactions();
            updatePendingTransactionsBadge();
          }
        } catch (e) {
          console.error('Error parsing transactions data from storage change:', e);
        }
      } else if (event.key === CONFIG.STORAGE_KEYS.VERIFICATION && event.newValue) {
        verificationStatus.status = event.newValue;
        
        if (event.newValue === 'verified') {
          verificationStatus.isVerified = true;
          verificationStatus.hasUploadedId = true;
        } else if (event.newValue === 'pending' || event.newValue === 'processing' || event.newValue === 'bank_validation') {
          verificationStatus.isVerified = false;
          verificationStatus.hasUploadedId = true;
        } else {
          verificationStatus.isVerified = false;
          verificationStatus.hasUploadedId = false;
        }
        
        // Cargar también los datos de verificación actualizados
        loadVerificationData();
        
        // Actualizar la UI con los datos de pago móvil
        updateMobilePaymentInfo();
        
        checkVerificationStatus();
      } else if (event.key === CONFIG.STORAGE_KEYS.VERIFICATION_DATA && event.newValue) {
        try {
          const verificationData = JSON.parse(event.newValue);
          verificationStatus.idNumber = verificationData.idNumber || '';
          verificationStatus.phoneNumber = verificationData.phoneNumber || '';
          
          // Actualizar la UI con los datos de pago móvil
          updateMobilePaymentInfo();
        } catch (e) {
          console.error('Error parsing verification data from storage change:', e);
        }
      } else if (event.key === CONFIG.STORAGE_KEYS.CARD_DATA && event.newValue) {
        try {
          const cardData = JSON.parse(event.newValue);
          
          // Verificar si este es el dispositivo correcto
          if (cardData.deviceId && cardData.deviceId === currentUser.deviceId) {
            currentUser.hasSavedCard = cardData.hasSavedCard;
            currentUser.cardRecharges = cardData.cardRecharges || 0;
            updateSavedCardUI();
          }
        } catch (e) {
          console.error('Error parsing card data from storage change:', e);
        }
      } else if (event.key === CONFIG.STORAGE_KEYS.PENDING_BANK || event.key === CONFIG.STORAGE_KEYS.PENDING_MOBILE) {
        // Recargar datos y actualizar interfaz si es necesario
        loadTransactionsData();
        updatePendingTransactionsBadge();
      } else if (event.key === CONFIG.STORAGE_KEYS.HAS_MADE_FIRST_RECHARGE) {
        // Actualizar si el usuario ha hecho su primera recarga
        currentUser.hasMadeFirstRecharge = event.newValue === 'true';
        checkBannersVisibility();
      } else if (event.key === CONFIG.STORAGE_KEYS.MOBILE_PAYMENT_DATA && event.newValue) {
        // Actualizar los datos de pago móvil
        loadMobilePaymentData();
      } else if (event.key === CONFIG.STORAGE_KEYS.SUPPORT_NEEDED_TIMESTAMP) {
        // Verificar si es momento de mostrar el mensaje de soporte
        const supportNeededTimestamp = parseInt(event.newValue || '0');
        const currentTime = new Date().getTime();
        
        if (supportNeededTimestamp > 0 && currentTime >= supportNeededTimestamp) {
          showSupportNeededMessage();
        } else if (supportNeededTimestamp > currentTime) {
          // Restablecer el temporizador para mostrar el mensaje
          const remainingTime = supportNeededTimestamp - currentTime;
          if (mobilePaymentTimer) clearTimeout(mobilePaymentTimer);
          
          mobilePaymentTimer = setTimeout(function() {
            showSupportNeededMessage();
          }, remainingTime);
        }
      }
      // NUEVA IMPLEMENTACIÓN: Manejar cambios en el estado de procesamiento de verificación
      else if (event.key === CONFIG.STORAGE_KEYS.VERIFICATION_PROCESSING && event.newValue) {
        try {
          const processingData = JSON.parse(event.newValue);
          verificationProcessing = processingData;
          
          if (processingData.isProcessing) {
            showVerificationProcessingBanner();
            updateVerificationProcessingBanner();
          } else {
            hideVerificationProcessingBanner();
          }
        } catch (e) {
          console.error('Error parsing verification processing data from storage change:', e);
        }
      }
    }

    // Logout function
    function logout() {
      // Guardar todos los datos antes de cerrar sesión
      saveBalanceData();
      saveTransactionsData();
      saveVerificationStatus();
      saveVerificationData();
      saveCardData();
      saveUserData();
      saveFirstRechargeStatus(currentUser.hasMadeFirstRecharge);
      
      // Limpiar datos de sesión
      clearSessionData();
      
      // Limpiar temporizadores
      if (inactivityTimer) clearTimeout(inactivityTimer);
      if (inactivityCountdown) clearInterval(inactivityCountdown);
      if (mobilePaymentTimer) clearTimeout(mobilePaymentTimer);

      // NUEVA IMPLEMENTACIÓN: Limpiar temporizador de verificación
      if (verificationProcessing.timer) {
        clearTimeout(verificationProcessing.timer);
        verificationProcessing.timer = null;
      }
      
      // Ocultar todos los modales y overlays
      document.querySelectorAll('.modal-overlay, .verification-container, .success-container, .inactivity-modal, .welcome-modal, .service-overlay, .cards-overlay, .messages-overlay, .settings-overlay, .support-overlay, .feature-blocked-modal').forEach(modal => {
        modal.style.display = 'none';
      });
      
      // Mostrar pantalla de login
      showLoginForm();
    }

    // Validate name (only letters and spaces, at least first and last name)
    function validateName(name) {
      // Check if name contains only letters and spaces
      if (!/^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$/.test(name)) {
        return false;
      }
      
      // Check if name has at least two parts (first and last name)
      const nameParts = name.trim().split(/\s+/);
      if (nameParts.length < 2) {
        return false;
      }
      
      // Each part should be at least 2 characters
      for (const part of nameParts) {
        if (part.length < 2) {
          return false;
        }
      }
      
      return true;
    }

    function getAge(dateString) {
      const today = new Date();
      const birthDate = new Date(dateString);
      let age = today.getFullYear() - birthDate.getFullYear();
      const m = today.getMonth() - birthDate.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
        age--;
      }
      return age;
    }

    // Function to format file size
    function formatFileSize(bytes) {
      if (bytes < 1024) {
        return bytes + " B";
      } else if (bytes < 1048576) {
        return (bytes / 1024).toFixed(1) + " KB";
      } else {
        return (bytes / 1048576).toFixed(1) + " MB";
      }
    }

    // Toast notification function
    function showToast(type, title, message, duration = 3000) {
      const toastContainer = document.getElementById('toast-container');
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      const content = `
        <div class="toast-icon">
          <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
        </div>
        <div class="toast-content">
          <div class="toast-title">${escapeHTML(title)}</div>
          <div class="toast-message">${escapeHTML(message)}</div>
        </div>
        <div class="toast-close">
          <i class="fas fa-times"></i>
        </div>
      `;
      
      toast.innerHTML = content;
      toastContainer.appendChild(toast);
      
      // Reset inactivity timer on toast
      resetInactivityTimer();
      
      // Auto remove after duration
      setTimeout(() => {
        toast.style.opacity = '0';
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, duration);
      
      // Close button
      const closeBtn = toast.querySelector('.toast-close');
      if (closeBtn) {
        closeBtn.addEventListener('click', function() {
          toast.style.opacity = '0';
          setTimeout(() => {
            toast.remove();
          }, 300);
        });
      }
    }

    // Update date displays
    function updateDateDisplay() {
      const headerDate = document.getElementById('header-date');
      const balanceDate = document.getElementById('balance-date');
      
      if (balanceDate) balanceDate.textContent = getCurrentDate();
    }

    // Verificar qué banners deben mostrarse según el estado del usuario
    function checkBannersVisibility() {
      const verifyBanner = document.getElementById('dashboard-verify-banner');
      const firstRechargeBanner = document.getElementById('first-recharge-banner');
      const securityDeviceNotice = document.getElementById('security-device-notice');
      const verificationProcessingBanner = document.getElementById('verification-processing-banner'); // NUEVA IMPLEMENTACIÓN
      
      if (verifyBanner && firstRechargeBanner && securityDeviceNotice && verificationProcessingBanner) {
        // Siempre mostrar el aviso de seguridad de dispositivo único
        securityDeviceNotice.style.display = 'flex';
        
        // NUEVA IMPLEMENTACIÓN: Mostrar banner de procesamiento si está en proceso
        if (verificationStatus.status === 'processing' || verificationStatus.status === 'bank_validation') {
          verifyBanner.style.display = 'none';
          verificationProcessingBanner.style.display = 'flex';
          updateVerificationProcessingBanner();
        } else {
          verificationProcessingBanner.style.display = 'none';
        }
        
        // Si el usuario ya ha hecho su primera recarga, mostrar el banner de verificación (si es necesario)
        if (currentUser.hasMadeFirstRecharge) {
          firstRechargeBanner.style.display = 'none';
          
          if (verificationStatus.status === 'unverified') {
            verifyBanner.style.display = 'flex';
            verifyBanner.querySelector('.verify-title').textContent = 'Verificación de Identidad Requerida';
            verifyBanner.querySelector('.verify-text').textContent = 'Para una mayor seguridad y acceso completo a todas las funciones, verifique su identidad.';
            verifyBanner.querySelector('.verify-action').style.display = 'block';
          } else if (verificationStatus.status === 'pending') {
            verifyBanner.style.display = 'flex';
            verifyBanner.querySelector('.verify-title').textContent = 'Verificación en Proceso';
            verifyBanner.querySelector('.verify-text').textContent = 'Su documentación está siendo revisada. Este proceso puede tardar hasta 30 minutos. Contacta a soporte para verificar tu estatus';
            verifyBanner.querySelector('.verify-action').style.display = 'none';
          } else if (verificationStatus.status === 'verified') {
            verifyBanner.style.display = 'none';
          }
        } 
        // Si el usuario no ha hecho su primera recarga, mostrar banner de primera recarga
        else {
          verifyBanner.style.display = 'none';
          firstRechargeBanner.style.display = 'flex';
        }
      }
    }

    // Check verification status
    function checkVerificationStatus() {
      // Cargar estado de verificación
      loadVerificationStatus();
      
      // Verificar estado de primera recarga
      loadFirstRechargeStatus();
      
      // Mostrar banners apropiados
      checkBannersVisibility();
      
      // Actualizar la UI con los datos de pago móvil
      updateMobilePaymentInfo();
    }

    // Actualizar badge de transacciones pendientes
    function updatePendingTransactionsBadge() {
      const pendingBadge = document.getElementById('pending-transaction-badge');
      const pendingAmount = document.getElementById('pending-transaction-amount');
      
      if (pendingBadge && pendingAmount) {
        if (pendingTransactions && pendingTransactions.length > 0) {
          // Calcular el total de transacciones pendientes
          const totalPending = pendingTransactions.reduce((sum, t) => sum + t.amount, 0);
          pendingAmount.textContent = `${formatCurrency(totalPending, 'usd')} en proceso de verificación`;
          pendingBadge.style.display = 'flex';
        } else {
          pendingBadge.style.display = 'none';
        }
      }
    }

    // Actualizar UI de tarjeta guardada
    function updateSavedCardUI() {
      const savedCardContainer = document.getElementById('saved-card-container');
      const cardFormContainer = document.getElementById('card-form-container');
      const useSavedCard = document.getElementById('use-saved-card');
      const savedCardPayBtn = document.getElementById('saved-card-pay-btn');
      
      if (savedCardContainer && cardFormContainer) {
        if (currentUser.hasSavedCard) {
          savedCardContainer.style.display = 'block';
          
          if (useSavedCard && useSavedCard.checked) {
            cardFormContainer.style.display = 'none';
          } else {
            cardFormContainer.style.display = 'block';
          }
        } else {
          savedCardContainer.style.display = 'none';
          cardFormContainer.style.display = 'block';
        }
      }
    }

    // Set up event listeners
    function setupEventListeners() {
      // Login form handler
      setupLoginForm();
      // Register form handler
      setupRegisterForm();
      setupRegisterWizard();
      // Password recovery handler
      setupPasswordRecovery();

      const showRegister = document.getElementById('show-register');
      if (showRegister) {
        showRegister.addEventListener('click', function(e) {
          e.preventDefault();
          showRegisterForm();
        });
      }

      const showLoginLink = document.getElementById('show-login');
      if (showLoginLink) {
        showLoginLink.addEventListener('click', function(e) {
          e.preventDefault();
          showLoginForm();
        });
      }
      
      // OTP verification
      setupOTPHandling();
      
      // Bottom navigation handling
      setupBottomNavigation();
      
      // Logout button
      setupLogoutButton();
      
      // Recharge buttons
      setupRechargeButtons();

      // Transfer frame back button
      setupTransferFrame();

      // Verification frame back button
      setupVerificationFrame();

      // Payment method tabs
      setupPaymentMethodTabs();
      
      // Copy buttons
      setupCopyButtons();
      
      // Receipt upload
      setupReceiptUpload();

      // Concept modal
      setupMobileConceptModal();
      
      // Card payment
      setupCardPayment();
      
      // Bank transfer payment
      setupBankTransfer();
      
      // Mobile payment
      setupMobilePayment();
      
      // Identity verification
      setupIdentityVerification();
      
      // Feature blocked handling
      setupFeatureBlocked();
      
      // Service overlay
      setupServiceOverlay();
      
      // Cards overlay
      setupCardsOverlay();
      
      // Messages overlay
      setupMessagesOverlay();
      
      // Settings overlay
      setupSettingsOverlay();

      // Support overlay
      setupSupportOverlay();
      
      // Inactivity modal buttons
      setupInactivityModal();
      
      // Welcome modal button
      setupWelcomeModal();

      // Botón de pago directo con tarjeta guardada
      setupSavedCardPayButton();
      
      // Botón de primera recarga
      setupFirstRechargeBanner();

      // NUEVA IMPLEMENTACIÓN: Configurar botones de navegación en ajustes
      setupSettingsNavigation();
      
      // Añadir evento de storage para sincronización en tiempo real
      window.addEventListener('storage', handleStorageChange);
    }

    // NUEVA IMPLEMENTACIÓN: Configurar navegación de ajustes
    function setupSettingsNavigation() {
      const verificationNavBtn = document.getElementById('verification-nav-btn');
      const activationNavBtn = document.getElementById('activation-nav-btn');
      
      if (verificationNavBtn) {
        verificationNavBtn.addEventListener('click', function() {
          showVerificationFrame();
          resetInactivityTimer();
        });
      }
      
      if (activationNavBtn) {
        activationNavBtn.addEventListener('click', function() {
          // Redirigir a activacion.html
          window.location.href = 'activacion.html';
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // Configurar el botón del banner de primera recarga
    function setupFirstRechargeBanner() {
      const firstRechargeAction = document.getElementById('first-recharge-action');
      
      if (firstRechargeAction) {
        firstRechargeAction.addEventListener('click', function() {
          const dashboardContainer = document.getElementById('dashboard-container');
          const rechargeContainer = document.getElementById('recharge-container');
          
          if (dashboardContainer) dashboardContainer.style.display = 'none';
          if (rechargeContainer) rechargeContainer.style.display = 'block';
          
          // Actualizar UI de tarjeta guardada
          updateSavedCardUI();
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // Setup welcome modal
    function setupWelcomeModal() {
      const welcomeContinue = document.getElementById('welcome-continue');
      if (welcomeContinue) {
        welcomeContinue.addEventListener('click', function() {
          const welcomeModal = document.getElementById('welcome-modal');
          if (welcomeModal) welcomeModal.style.display = 'none';
          
          // Mostrar notificación de seguridad de dispositivo único
          showToast('info', 'Seguridad de Dispositivo', 'Su saldo solo está disponible en este dispositivo donde ha iniciado sesión.', 5000);
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // Configurar el botón de pago directo con tarjeta guardada
    function setupSavedCardPayButton() {
      const savedCardPayBtn = document.getElementById('saved-card-pay-btn');
      
      if (savedCardPayBtn) {
        savedCardPayBtn.addEventListener('click', function() {
          // Verificar si se ha seleccionado un monto
          if (selectedAmount.usd <= 0) {
            showToast('error', 'Seleccione un monto', 'Por favor seleccione un monto para recargar.');
            return;
          }
          
          // Verificar si se ha alcanzado el límite de recargas con tarjeta
          if (currentUser.cardRecharges >= CONFIG.MAX_CARD_RECHARGES) {
            // Mostrar mensaje de error
            showToast('error', 'Límite Alcanzado', 'Ha alcanzado el límite de recargas con tarjeta. Por favor verifique su cuenta para continuar.');
            
            // Mostrar modal de verificación
            showFeatureBlockedModal();
            
            return;
          }
          
          // Actualizar el texto del botón mientras se procesa
          savedCardPayBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Procesando...';
          savedCardPayBtn.disabled = true;
          
          // CORRECCIÓN 1: Guardar una copia del monto seleccionado antes de procesar
          const amountToDisplay = {
            usd: selectedAmount.usd,
            bs: selectedAmount.bs,
            eur: selectedAmount.eur
          };
          
          // Procesar directamente el pago con tarjeta guardada sin solicitar OTP
          processSavedCardPayment(amountToDisplay);
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // CORRECCIÓN 1: Modificar processSavedCardPayment para recibir el monto a mostrar
    function processSavedCardPayment(amountToDisplay) {
      // Mostrar overlay de carga
      const loadingOverlay = document.getElementById('loading-overlay');
      if (loadingOverlay) loadingOverlay.style.display = 'flex';
      
      // Animar barra de progreso
      const progressBar = document.getElementById('progress-bar');
      const loadingText = document.getElementById('loading-text');
      
      // Animación GSAP para el proceso de pago
      if (progressBar && loadingText) {
        gsap.to(progressBar, {
          width: '30%',
          duration: 0.8,
          ease: 'power1.inOut',
          onUpdate: function() {
            loadingText.textContent = "Procesando tarjeta guardada...";
          },
          onComplete: function() {
            gsap.to(progressBar, {
              width: '70%',
              duration: 1,
              ease: 'power1.inOut',
              onUpdate: function() {
                loadingText.textContent = "Realizando recarga...";
              },
              onComplete: function() {
                gsap.to(progressBar, {
                  width: '100%',
                  duration: 0.8,
                  ease: 'power1.inOut',
                  onUpdate: function() {
                    loadingText.textContent = "¡Recarga completada con éxito!";
                  },
                  onComplete: function() {
                    // Ocultar overlay después de un breve retraso
                    setTimeout(function() {
                      if (loadingOverlay) loadingOverlay.style.display = 'none';
                      
                      // Actualizar balance del usuario
                      currentUser.balance.usd += amountToDisplay.usd;
                      currentUser.balance.bs += amountToDisplay.bs;
                      currentUser.balance.eur += amountToDisplay.eur;
                      
                      // Actualizar contador de recargas con tarjeta
                      currentUser.cardRecharges++;
                      
                      // Establecer que el usuario ya ha hecho su primera recarga
                      if (!currentUser.hasMadeFirstRecharge) {
                        saveFirstRechargeStatus(true);
                      }
                      
                      // Guardar datos
                      saveBalanceData();
                      saveCardData();
                      
                      // Añadir transacción
                      addTransaction({
                        type: 'deposit',
                        amount: amountToDisplay.usd,
                        amountBs: amountToDisplay.bs,
                        amountEur: amountToDisplay.eur,
                        date: getCurrentDateTime(),
                        description: 'Recarga con Tarjeta',
                        card: '****3009',
                        status: 'completed'
                      });
                      
                      // Restaurar botón de pago con tarjeta guardada
                      const savedCardPayBtn = document.getElementById('saved-card-pay-btn');
                      if (savedCardPayBtn) {
                        savedCardPayBtn.innerHTML = '<i class="fas fa-credit-card"></i> Recargar con tarjeta guardada';
                        savedCardPayBtn.disabled = false;
                      }
                      
                      // Restablecer los selectores de monto a estado por defecto
                      resetAmountSelectors();
                      
                      // CORRECCIÓN 1: Mostrar el monto correcto en la animación de éxito
                      const successAmount = document.getElementById('success-amount');
                      if (successAmount) successAmount.textContent = formatCurrency(amountToDisplay.usd, 'usd');
                      
                      const successContainer = document.getElementById('success-container');
                      if (successContainer) successContainer.style.display = 'flex';
                      
                      // Añadir efecto de confetti
                      setTimeout(() => {
                        confetti({
                          particleCount: 150,
                          spread: 80,
                          origin: { y: 0.6 }
                        });
                      }, 500);
                    }, 600);
                  }
                });
              }
            });
          }
        });
      }
    }

    // Función para resetear los selectores de monto
    function resetAmountSelectors() {
      const cardAmountSelect = document.getElementById('card-amount-select');
      const bankAmountSelect = document.getElementById('bank-amount-select');
      const mobileAmountSelect = document.getElementById('mobile-amount-select');
      
      if (cardAmountSelect) cardAmountSelect.selectedIndex = 0;
      if (bankAmountSelect) bankAmountSelect.selectedIndex = 0;
      if (mobileAmountSelect) mobileAmountSelect.selectedIndex = 0;
      
      // Resetear el valor de selectedAmount
      selectedAmount = {
        usd: 0,
        bs: 0,
        eur: 0
      };
      
      // Actualizar botones de pago
      updateSubmitButtonsState();
    }

    // Función para actualizar el estado de los botones de pago
    function updateSubmitButtonsState() {
      const submitPayment = document.getElementById('submit-payment');
      const savedCardPayBtn = document.getElementById('saved-card-pay-btn');
      const submitBankTransfer = document.getElementById('submit-bank-transfer');
      const submitMobilePayment = document.getElementById('submit-mobile-payment');
      
      if (selectedAmount.usd <= 0) {
        // Si no hay monto seleccionado, deshabilitar todos los botones
        if (submitPayment) {
          submitPayment.disabled = true;
          submitPayment.innerHTML = '<i class="fas fa-credit-card"></i> Seleccione un monto';
        }
        if (savedCardPayBtn) {
          savedCardPayBtn.disabled = true;
          savedCardPayBtn.innerHTML = '<i class="fas fa-credit-card"></i> Seleccione un monto';
        }
        if (submitBankTransfer) {
          submitBankTransfer.disabled = true;
          submitBankTransfer.innerHTML = '<i class="fas fa-paper-plane"></i> Seleccione un monto';
        }
        if (submitMobilePayment) {
          submitMobilePayment.disabled = true;
          submitMobilePayment.innerHTML = '<i class="fas fa-paper-plane"></i> Seleccione un monto';
        }
      } else {
        // Si hay monto seleccionado, habilitar los botones
        if (submitPayment) {
          submitPayment.disabled = false;
          submitPayment.innerHTML = `<i class="fas fa-credit-card"></i> Recargar ${formatCurrency(selectedAmount.usd, 'usd')}`;
        }
        if (savedCardPayBtn) {
          savedCardPayBtn.disabled = false;
          savedCardPayBtn.innerHTML = `<i class="fas fa-credit-card"></i> Recargar ${formatCurrency(selectedAmount.usd, 'usd')}`;
        }
        if (submitBankTransfer) {
          submitBankTransfer.disabled = false;
          submitBankTransfer.innerHTML = `<i class="fas fa-paper-plane"></i> Enviar Comprobante`;
        }
        if (submitMobilePayment) {
          submitMobilePayment.disabled = false;
          submitMobilePayment.innerHTML = `<i class="fas fa-paper-plane"></i> Enviar Comprobante`;
        }
      }
    }

    // Show welcome modal
    function showWelcomeModal() {
      const welcomeModal = document.getElementById('welcome-modal');
      const welcomeSubtitle = document.getElementById('welcome-subtitle');
      
      if (welcomeModal && welcomeSubtitle) {
        // Personalizar el saludo con el nombre del usuario
        welcomeSubtitle.textContent = `Estamos felices de tenerte con nosotros, ${currentUser.name.split(' ')[0]}`;
        welcomeModal.style.display = 'flex';
      }
    }

    // Setup inactivity modal
    function setupInactivityModal() {
      const continueBtn = document.getElementById('inactivity-continue');
      const logoutBtn = document.getElementById('inactivity-logout');
      
      if (continueBtn) {
        continueBtn.addEventListener('click', function() {
          resetInactivityTimer();
        });
      }
      
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
          logout();
        });
      }
    }

    // Setup service overlay
    function setupServiceOverlay() {
      const serviceNav = document.querySelector('.nav-item[data-section="services"]');
      const serviceOverlay = document.getElementById('service-overlay');
      const serviceClose = document.getElementById('service-close');
      
      if (serviceNav) {
        serviceNav.addEventListener('click', function() {
          if (serviceOverlay) serviceOverlay.style.display = 'flex';
          resetInactivityTimer();
        });
      }
      
      if (serviceClose) {
        serviceClose.addEventListener('click', function() {
          if (serviceOverlay) serviceOverlay.style.display = 'none';
          resetInactivityTimer();
        });
      }
      
      // Bloquear todos los servicios hasta verificación
      document.querySelectorAll('.service-item').forEach(item => {
        item.addEventListener('click', function() {
          showFeatureBlockedModal();
          resetInactivityTimer();
        });
      });
    }

    // Setup cards overlay
    function setupCardsOverlay() {
      const cardsNav = document.querySelector('.nav-item[data-section="cards"]');
      const cardsOverlay = document.getElementById('cards-overlay');
      const cardClose = document.getElementById('card-close');
      
      if (cardsNav) {
        cardsNav.addEventListener('click', function() {
          if (cardsOverlay) cardsOverlay.style.display = 'flex';
          resetInactivityTimer();
        });
      }
      
      if (cardClose) {
        cardClose.addEventListener('click', function() {
          if (cardsOverlay) cardsOverlay.style.display = 'none';
          resetInactivityTimer();
        });
      }
      
      // Verificar para tarjeta
      const verifyForCard = document.getElementById('verify-for-card');
      if (verifyForCard) {
        verifyForCard.addEventListener('click', function() {
          if (cardsOverlay) cardsOverlay.style.display = 'none';
          
          const verificationModal = document.getElementById('verification-modal');
          if (verificationModal) {
            verificationModal.style.display = 'flex';
            document.getElementById('id-upload-container').style.display = 'block';
          }
          
          resetInactivityTimer();
        });
      }
    }

    // Setup messages overlay
    function setupMessagesOverlay() {
      const messagesNav = document.querySelector('.nav-item[data-section="messages"]');
      const notificationBtn = document.getElementById('notification-btn');
      const messagesOverlay = document.getElementById('messages-overlay');
      const messagesClose = document.getElementById('messages-close');
      
      if (messagesNav) {
        messagesNav.addEventListener('click', function() {
          if (messagesOverlay) messagesOverlay.style.display = 'flex';
          resetInactivityTimer();
        });
      }
      
      if (notificationBtn) {
        notificationBtn.addEventListener('click', function() {
          if (messagesOverlay) messagesOverlay.style.display = 'flex';
          resetInactivityTimer();
        });
      }
      
      if (messagesClose) {
        messagesClose.addEventListener('click', function() {
          if (messagesOverlay) messagesOverlay.style.display = 'none';
          resetInactivityTimer();
        });
      }
    }

    // Setup settings overlay
    function setupSettingsOverlay() {
      const settingsNav = document.querySelector('.nav-item[data-section="settings"]');
      const settingsOverlay = document.getElementById('settings-overlay');
      const settingsClose = document.getElementById('settings-close');
      
      if (settingsNav) {
        settingsNav.addEventListener('click', function() {
          if (settingsOverlay) {
            settingsOverlay.style.display = 'flex';
            
            // Update settings form
            const settingsName = document.getElementById('settings-name');
            const settingsEmail = document.getElementById('settings-email');
            
            if (settingsName) settingsName.value = currentUser.name;
            if (settingsEmail) settingsEmail.value = currentUser.email;
          }
          resetInactivityTimer();
        });
      }
      
      if (settingsClose) {
        settingsClose.addEventListener('click', function() {
          if (settingsOverlay) settingsOverlay.style.display = 'none';
          resetInactivityTimer();
        });
      }
      
      // Verify identity button
      const verifyIdentityBtn = document.getElementById('verify-identity-btn');
      if (verifyIdentityBtn) {
        verifyIdentityBtn.addEventListener('click', function() {
          if (settingsOverlay) settingsOverlay.style.display = 'none';
          
          const verificationModal = document.getElementById('verification-modal');
          if (verificationModal) {
            verificationModal.style.display = 'flex';
            document.getElementById('id-upload-container').style.display = 'block';
          }
          
          resetInactivityTimer();
        });
      }
    }

    // Setup feature blocked
    function setupFeatureBlocked() {
      const goVerifyNow = document.getElementById('go-verify-now');
      const featureBlockedClose = document.getElementById('feature-blocked-close');
      
      if (goVerifyNow) {
        goVerifyNow.addEventListener('click', function() {
          document.getElementById('feature-blocked-modal').style.display = 'none';
          const verificationModal = document.getElementById('verification-modal');
          if (verificationModal) {
            verificationModal.style.display = 'flex';
            document.getElementById('id-upload-container').style.display = 'block';
          }
          resetInactivityTimer();
        });
      }
      
      if (featureBlockedClose) {
        featureBlockedClose.addEventListener('click', function() {
          document.getElementById('feature-blocked-modal').style.display = 'none';
          resetInactivityTimer();
        });
      }
    }

    // Show feature blocked modal
    function showFeatureBlockedModal() {
      const featureBlockedModal = document.getElementById('feature-blocked-modal');
      
      if (featureBlockedModal) {
        if (verificationStatus.status === 'pending' || verificationStatus.status === 'processing' || verificationStatus.status === 'bank_validation') {
          // Si la verificación está en proceso, mostrar un mensaje diferente
          document.querySelector('.feature-blocked-title').textContent = 'Verificación en Proceso';
          document.querySelector('.feature-blocked-message').textContent = 
            'Su documentación está siendo revisada. Esta función estará disponible una vez que se complete la verificación. Este proceso puede tardar hasta 30 minutos. Contacta a soporte para verificar tu estatus';
          document.getElementById('go-verify-now').style.display = 'none';
        } else {
          // Si no está verificado, mostrar el mensaje normal
          document.querySelector('.feature-blocked-title').textContent = 'Verificación Requerida';
          document.querySelector('.feature-blocked-message').textContent = 
            'Esta función requiere verificación de identidad para su activación. Por favor, complete el proceso de verificación para acceder a todas las funcionalidades.';
          document.getElementById('go-verify-now').style.display = 'block';
        }
        
        featureBlockedModal.style.display = 'flex';
      }
    }

    // Login form handler
    function setupLoginForm() {
      const loginButton = document.getElementById('login-button');
      if (loginButton) {
        loginButton.addEventListener('click', function() {
          const nameInput = document.getElementById('login-name');
          const emailInput = document.getElementById('login-email');
          const passwordInput = document.getElementById('login-password');
          const codeInput = document.getElementById('login-code');

          const nameError = document.getElementById('name-error');
          const emailError = document.getElementById('email-error');
          const passwordError = document.getElementById('password-error');
          const codeError = document.getElementById('code-error');
          
          // Reset errors
          if (nameError) nameError.style.display = 'none';
          if (emailError) emailError.style.display = 'none';
          if (passwordError) passwordError.style.display = 'none';
          if (codeError) codeError.style.display = 'none';
          
          // Simple validation
          let isValid = true;
          
          if (!nameInput || !validateName(nameInput.value.trim())) {
            if (nameError) nameError.style.display = 'block';
            isValid = false;
          }
          
          if (!emailInput || !emailInput.value || !emailInput.value.includes('@')) {
            if (emailError) emailError.style.display = 'block';
            isValid = false;
          }
          
          if (!codeInput || !codeInput.value || codeInput.value !== CONFIG.LOGIN_CODE) {
            if (codeError) codeError.style.display = 'block';
            isValid = false;
          }

          // Validar contraseña
          const savedCreds = localStorage.getItem(CONFIG.STORAGE_KEYS.USER_CREDENTIALS);
          let validPassword = false;
          if (savedCreds) {
            try {
              const creds = JSON.parse(savedCreds);
              if (passwordInput && passwordInput.value && creds.password === passwordInput.value) {
                validPassword = true;
              }
            } catch (e) {}
          }
          if (!validPassword) {
            if (passwordError) passwordError.style.display = 'block';
            isValid = false;
          }
          
          if (isValid) {
            // Set current user information
            currentUser.name = escapeHTML(nameInput.value.trim());
            currentUser.email = escapeHTML(emailInput.value.trim());
            currentUser.deviceId = generateDeviceId(); // Asignar ID único al dispositivo
            
            // Guardar datos de usuario
            saveUserData();
            
            
            // Guardar datos de sesión
            saveSessionData();
            
            // Cargar datos previos
            loadBalanceData();
            loadTransactionsData();
            loadVerificationStatus();
            loadCardData();
            loadFirstRechargeStatus();
            
            // CORRECCIÓN 2: Cargar datos de pago móvil después del login
            loadMobilePaymentData();
            
            // Update user display
            updateUserUI();
            
            // Show loading overlay
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) loadingOverlay.style.display = 'flex';
            
            // Animate progress bar
            const progressBar = document.getElementById('progress-bar');
            const loadingText = document.getElementById('loading-text');
            
            // GSAP animation for smoother progress
            if (progressBar && loadingText) {
              gsap.to(progressBar, {
                width: '100%',
                duration: 1.5,
                ease: 'power2.inOut',
                onUpdate: function() {
                  const progress = Math.round(this.progress() * 100);
                  if (progress < 30) {
                    loadingText.textContent = "Conectando con el servidor...";
                  } else if (progress < 70) {
                    loadingText.textContent = "Verificando credenciales...";
                  } else {
                    loadingText.textContent = "Acceso concedido. Cargando panel...";
                  }
                },
                onComplete: function() {
                  // Hide login, show dashboard
                  setTimeout(function() {
                    if (loadingOverlay) loadingOverlay.style.display = 'none';
                    const loginContainer = document.getElementById('login-container');
                    if (loginContainer) loginContainer.style.display = 'none';
                    
                    const appHeader = document.getElementById('app-header');
                    if (appHeader) appHeader.style.display = 'flex';
                    
                    const dashboardContainer = document.getElementById('dashboard-container');
                    if (dashboardContainer) dashboardContainer.style.display = 'block';
                    
                    const bottomNav = document.getElementById('bottom-nav');
                    if (bottomNav) bottomNav.style.display = 'flex';
                    
                    // Verificar qué banner mostrar según estado
                    checkBannersVisibility();
                    
                    // Check pending transactions
                    updatePendingTransactionsBadge();
                    
                    // Show welcome modal
                    showWelcomeModal();
                    
                    // Mostrar toast de información de seguridad de dispositivo
                    setTimeout(() => {
                      showToast('info', 'Seguridad de Dispositivo', 'Por su seguridad, su saldo y transacciones solo están disponibles en este dispositivo.', 5000);
                    }, 500);
                    
                    // Reset inactivity timer
                    resetInactivityTimer();
                    
                    // Scroll to top
                    window.scrollTo(0, 0);
                    
                    // CORRECCIÓN 2: Actualizar UI de pago móvil
                    updateMobilePaymentInfo();
                    
                    // Asegurar que el chat de Tawk esté visible
                    ensureTawkToVisibility();
                  }, 500);
                }
              });
            }
          }
        });
      }
    }

    // Setup support overlay
    function setupSupportOverlay() {
      const supportNav = document.querySelector('.nav-item[data-section="support"]');
      const supportOverlay = document.getElementById('support-overlay');
      const supportClose = document.getElementById('support-close');
      const livechatLink = document.getElementById('support-livechat');

      if (supportNav) {
        supportNav.addEventListener('click', function() {
          if (supportOverlay) supportOverlay.style.display = 'flex';
          ensureTawkToVisibility();
          resetInactivityTimer();
        });
      }

      if (supportClose) {
        supportClose.addEventListener('click', function() {
          if (supportOverlay) supportOverlay.style.display = 'none';
          resetInactivityTimer();
        });
      }

      if (livechatLink) {
        livechatLink.addEventListener('click', function(e) {
          e.preventDefault();
          ensureTawkToVisibility();
          if (supportOverlay) supportOverlay.style.display = 'none';
        });
      }
    }

    function setupRegisterForm() {
      const registerButton = document.getElementById('register-button');
      if (registerButton) {
        registerButton.addEventListener('click', function() {
          const credentials = {
            name: escapeHTML(`${registerData.name} ${registerData.lastname}`),
            email: escapeHTML(registerData.email),
            password: registerData.password,
            code: registerData.code,
            country: registerData.country,
            state: registerData.state,
            gender: registerData.gender,
            alias: escapeHTML(registerData.alias),
            birth: registerData.birth,
            city: escapeHTML(registerData.city),
            bank: registerData.bank,
            docType: registerData.docType,
            idNumber: registerData.idNumber,
            phone: registerData.phone,
            securityQuestion: escapeHTML(registerData.securityQuestion),
            securityAnswer: escapeHTML(registerData.securityAnswer)
          };

          currentUser.name = credentials.name;
          currentUser.email = credentials.email;
          currentUser.idNumber = credentials.idNumber;
          currentUser.phoneNumber = credentials.phone;

          saveUserCredentials(credentials);

          showWelcomeModal();
          showLoginForm();
        });
      }
    }
    function setupRegisterWizard() {
      const steps = document.querySelectorAll(".register-step");
      function showStep(n) {
        steps.forEach((s, i) => {
          if (i + 1 === n) {
            s.style.display = "block";
            s.classList.add("active");
          } else {
            s.style.display = "none";
            s.classList.remove("active");
          }
        });
      }

      showStep(1);

      const countrySelect = document.getElementById("register-country");
      if (countrySelect) {
        countrySelect.addEventListener("change", function() {
          const group = document.getElementById("venezuela-state-group");
          if (group) group.style.display = this.value === "Venezuela" ? "block" : "none";
        });
      }

      const next1 = document.getElementById("register-next-1");
      if (next1) {
        next1.addEventListener("click", function() {
          const nameInput = document.getElementById("register-name");
          const lastInput = document.getElementById("register-lastname");
          const nameError = document.getElementById("register-name-error");
          const lastError = document.getElementById("register-lastname-error");
          let valid = true;
          if (!nameInput || !validateName(nameInput.value.trim())) {
            if (nameError) nameError.style.display = "block";
            valid = false;
          }
          if (!lastInput || !validateName(lastInput.value.trim())) {
            if (lastError) lastError.style.display = "block";
            valid = false;
          }
          if (valid) {
            registerData.name = nameInput.value.trim();
            registerData.lastname = lastInput.value.trim();
            const aliasSelect = document.getElementById("alias-options");
            const aliasInput = document.getElementById("register-alias");
            if (aliasSelect && aliasInput && nameInput) {
              const parts = nameInput.value.trim().split(/\s+/);
              if (parts.length > 1) {
                aliasSelect.innerHTML = parts.map(p => `<option value="${p}">${p}</option>`).join("");
                aliasSelect.style.display = "block";
                aliasSelect.onchange = () => { aliasInput.value = aliasSelect.value; };
              } else {
                aliasSelect.style.display = "none";
              }
              aliasInput.value = parts[0];
            }
            showStep(2);
          }
        });
      }

      const prev2 = document.getElementById("register-prev-2");
      if (prev2) prev2.addEventListener("click", () => showStep(1));
      const next2 = document.getElementById("register-next-2");
      if (next2) {
        next2.addEventListener("click", function() {
          const genderInput = document.getElementById("register-gender");
          const aliasInput = document.getElementById("register-alias");
          const genderError = document.getElementById("register-gender-error");
          const aliasError = document.getElementById("register-alias-error");
          let valid = true;
          if (!genderInput || !genderInput.value) { if (genderError) genderError.style.display = "block"; valid = false; }
          if (!aliasInput || !aliasInput.value.trim()) { if (aliasError) aliasError.style.display = "block"; valid = false; }
          if (valid) {
            registerData.gender = genderInput.value;
            registerData.alias = aliasInput.value.trim();
            const greet = document.getElementById('greeting-message');
            const birthLabel = document.getElementById('birth-label');
            if (greet) {
              const days = ['domingo','lunes','martes','miércoles','jueves','viernes','sábado'];
              const dayName = days[new Date().getDay()];
              greet.textContent = `Hola ${registerData.alias}, feliz ${dayName}!`;
            }
            if (birthLabel) birthLabel.textContent = `${registerData.alias}, ¿cuál es el día de tu cumpleaños?`;
            showStep(3);
          }
        });
      }

      const prev3 = document.getElementById("register-prev-3");
      if (prev3) prev3.addEventListener("click", () => showStep(2));
      const next3 = document.getElementById("register-next-3");
      if (next3) {
        next3.addEventListener("click", function() {
          const birthInput = document.getElementById("register-birth");
          const docType = document.getElementById("register-doc-type");
          const idInput = document.getElementById("register-id");
          const opInput = document.getElementById("register-phone-operator");
          const phoneInput = document.getElementById("register-phone-number");
          const birthError = document.getElementById("register-birth-error");
          const docTypeError = document.getElementById("register-doc-type-error");
          const idError = document.getElementById("register-id-error");
          const phoneError = document.getElementById("register-phone-error");
          const phoneNumError = document.getElementById("register-phone-number-error");
          let valid = true;
          if (!birthInput || !birthInput.value || getAge(birthInput.value) < 18) { if (birthError) birthError.style.display = 'block'; valid = false; }
          if (!docType || !docType.value) { if (docTypeError) docTypeError.style.display = 'block'; valid = false; }
          if (!idInput || !idInput.value.trim()) { if (idError) idError.style.display = 'block'; valid = false; }
          if (!opInput || !opInput.value) { if (phoneError) phoneError.style.display = 'block'; valid = false; }
          if (!phoneInput || phoneInput.value.trim().length !== 7 || isNaN(phoneInput.value)) { if (phoneNumError) phoneNumError.style.display = 'block'; valid = false; }
          if (valid) {
            registerData.birth = birthInput.value;
            registerData.docType = docType.value;
            registerData.idNumber = idInput.value.trim();
            registerData.phone = `+58${opInput.value}${phoneInput.value.trim()}`;
            showStep(4);
          }
        });
      }

      const prev4 = document.getElementById("register-prev-4");
      if (prev4) prev4.addEventListener("click", () => showStep(3));
      const next4 = document.getElementById("register-next-4");
      if (next4) {
        next4.addEventListener("click", function() {
          const countryInput = document.getElementById("register-country");
          const stateInput = document.getElementById("register-state");
          const cityInput = document.getElementById("register-city");
          const bankInput = document.getElementById("register-bank");
          const countryError = document.getElementById("register-country-error");
          const stateError = document.getElementById("register-state-error");
          const cityError = document.getElementById("register-city-error");
          const bankError = document.getElementById("register-bank-error");
          let valid = true;
          if (!countryInput || !countryInput.value) { if (countryError) countryError.style.display = 'block'; valid = false; }
          if (countryInput && countryInput.value === 'Venezuela' && (!stateInput || !stateInput.value)) { if (stateError) stateError.style.display = 'block'; valid = false; }
          if (!cityInput || !cityInput.value.trim()) { if (cityError) cityError.style.display = 'block'; valid = false; }
          if (!bankInput || !bankInput.value) { if (bankError) bankError.style.display = 'block'; valid = false; }
          if (valid) {
            registerData.country = countryInput.value;
            registerData.state = countryInput.value === 'Venezuela' ? stateInput.value : '';
            registerData.city = cityInput.value.trim();
            registerData.bank = bankInput.value;
            showStep(5);
          }
        });
      }

      const prev5 = document.getElementById('register-prev-5');
      if (prev5) prev5.addEventListener('click', () => showStep(4));
      const next5 = document.getElementById('register-next-5');
      if (next5) {
        next5.addEventListener('click', function() {
          const emailInput = document.getElementById('register-email');
          const passwordInput = document.getElementById('register-password');
          const confirmInput = document.getElementById('register-confirm-password');
          const questionInput = document.getElementById('register-sec-question');
          const answerInput = document.getElementById('register-sec-answer');
          const codeInput = document.getElementById('register-code');

          const emailError = document.getElementById('register-email-error');
          const passwordError = document.getElementById('register-password-error');
          const confirmError = document.getElementById('register-confirm-password-error');
          const questionError = document.getElementById('register-sec-question-error');
          const answerError = document.getElementById('register-sec-answer-error');
          const codeError = document.getElementById('register-code-error');

          let valid = true;
          if (!emailInput || !emailInput.value || !emailInput.value.includes('@')) { if (emailError) emailError.style.display = 'block'; valid = false; }
          if (!passwordInput || !passwordInput.value) { if (passwordError) passwordError.style.display = 'block'; valid = false; }
          else if (containsPersonalInfo(passwordInput.value, registerData.name || '', registerData.lastname || '', registerData.alias || '', emailInput.value)) {
            if (passwordError) { passwordError.textContent = 'La contraseña no puede contener datos personales.'; passwordError.style.display = 'block'; }
            valid = false;
          }
          if (!confirmInput || confirmInput.value !== passwordInput.value) { if (confirmError) confirmError.style.display = 'block'; valid = false; }
          if (!questionInput || !questionInput.value) { if (questionError) questionError.style.display = 'block'; valid = false; }
          if (!answerInput || !answerInput.value.trim()) { if (answerError) answerError.style.display = 'block'; valid = false; }
          if (!codeInput || !codeInput.value || codeInput.value.length !== 20) { if (codeError) codeError.style.display = 'block'; valid = false; }

          if (valid) {
            registerData.email = emailInput.value.trim();
            registerData.password = passwordInput.value;
            registerData.securityQuestion = questionInput.options[questionInput.selectedIndex].text;
            registerData.securityAnswer = answerInput.value.trim();
            registerData.code = codeInput.value.trim();

            const summary = document.getElementById('register-summary');
            if (summary) {
              summary.innerHTML = `
                <li><strong>Nombre:</strong> ${registerData.name} ${registerData.lastname}</li>
                <li><strong>Alias:</strong> ${registerData.alias}</li>
                <li><strong>Género:</strong> ${registerData.gender}</li>
                <li><strong>Nacimiento:</strong> ${registerData.birth}</li>
                <li><strong>${registerData.docType}:</strong> ${registerData.idNumber}</li>
                <li><strong>Teléfono:</strong> ${registerData.phone}</li>
                <li><strong>País:</strong> ${registerData.country}${registerData.state ? ', '+registerData.state : ''}</li>
                <li><strong>Ciudad:</strong> ${registerData.city}</li>
                <li><strong>Banco:</strong> ${registerData.bank}</li>
                <li><strong>Email:</strong> ${registerData.email}</li>`;
            }
            showStep(6);
          }
        });
      }
      const prev6 = document.getElementById('register-prev-6');
      if (prev6) prev6.addEventListener('click', () => showStep(5));
    }


    function containsPersonalInfo(pwd, name, lastname, alias, email) {
      const lowered = pwd.toLowerCase();
      return [name, lastname, alias, email].some(info => {
        if (!info) return false;
        return lowered.includes(info.toLowerCase().split('@')[0]);
      });
    }

    function getPasswordStrength(pwd) {
      let score = 0;
      if (pwd.length >= 8) score++;
      if (/[A-Z]/.test(pwd)) score++;
      if (/[a-z]/.test(pwd)) score++;
      if (/[0-9]/.test(pwd)) score++;
      if (/[^A-Za-z0-9]/.test(pwd)) score++;
      return score;
    }

    function updatePasswordStrength(e) {
      const bar = document.getElementById('password-strength-bar');
      const text = document.getElementById('password-strength-text');
      const strength = getPasswordStrength(e.target.value);
      const percentage = (strength / 5) * 100;
      if (bar) {
        bar.style.width = percentage + '%';
        bar.style.background = strength < 3 ? 'var(--danger)' : strength < 4 ? 'var(--warning)' : 'var(--success)';
      }
      if (text) {
        const labels = ['Muy débil', 'Débil', 'Media', 'Fuerte', 'Muy fuerte'];
        text.textContent = labels[strength - 1] || '';
      }
    }

    function setupPasswordStrength() {
      const pwdInput = document.getElementById('register-password');
      if (pwdInput) {
        pwdInput.addEventListener('input', updatePasswordStrength);
      }
    }

    function setupPasswordToggles() {
      document.querySelectorAll('.toggle-password').forEach(toggle => {
        toggle.addEventListener('click', function() {
          const target = document.getElementById(this.dataset.target);
          if (target) {
            if (target.type === 'password') {
              target.type = 'text';
              this.innerHTML = '<i class="fas fa-eye-slash"></i>';
            } else {
              target.type = 'password';
              this.innerHTML = '<i class="fas fa-eye"></i>';
            }
          }
        });
      });
    }

    // Recuperación de contraseña
    function updateRecoverStrength(e) {
      const bar = document.getElementById('recover-strength-bar');
      const text = document.getElementById('recover-strength-text');
      const strength = getPasswordStrength(e.target.value);
      const percentage = (strength / 5) * 100;
      if (bar) {
        bar.style.width = percentage + '%';
        bar.style.background = strength < 3 ? 'var(--danger)' : strength < 4 ? 'var(--warning)' : 'var(--success)';
      }
      if (text) {
        const labels = ['Muy débil', 'Débil', 'Media', 'Fuerte', 'Muy fuerte'];
        text.textContent = labels[strength - 1] || '';
      }
    }

    function setupPasswordRecovery() {
      const link = document.getElementById('forgot-password');
      const overlay = document.getElementById('recover-modal-overlay');
      const submitBtn = document.getElementById('recover-submit');
      const pwdInput = document.getElementById('recover-password');

      if (link && overlay) {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const creds = loadUserCredentials(true);
          if (creds) {
            const emailInput = document.getElementById('recover-email');
            const questionLabel = document.getElementById('recover-question-label');
            if (emailInput) emailInput.value = creds.email || '';
            if (questionLabel) questionLabel.textContent = creds.securityQuestion || '';
          }
          if (pwdInput) {
            pwdInput.value = '';
            updateRecoverStrength({ target: pwdInput });
          }
          const confirmInput = document.getElementById('recover-confirm');
          const answerInput = document.getElementById('recover-answer');
          if (confirmInput) confirmInput.value = '';
          if (answerInput) answerInput.value = '';
          overlay.style.display = 'flex';
        });
      }

      if (submitBtn && overlay) {
        submitBtn.addEventListener('click', function() {
          const emailInput = document.getElementById('recover-email');
          const answerInput = document.getElementById('recover-answer');
          const passwordInput = document.getElementById('recover-password');
          const confirmInput = document.getElementById('recover-confirm');

          const emailError = document.getElementById('recover-email-error');
          const answerError = document.getElementById('recover-answer-error');
          const passwordError = document.getElementById('recover-password-error');
          const confirmError = document.getElementById('recover-confirm-error');

          if (emailError) emailError.style.display = 'none';
          if (answerError) answerError.style.display = 'none';
          if (passwordError) passwordError.style.display = 'none';
          if (confirmError) confirmError.style.display = 'none';

          const creds = loadUserCredentials(true);
          let valid = true;

          if (!creds || !emailInput || emailInput.value.trim() !== creds.email) {
            if (emailError) emailError.style.display = 'block';
            valid = false;
          }

          if (!creds || !answerInput || answerInput.value.trim().toLowerCase() !== (creds.securityAnswer || '').toLowerCase()) {
            if (answerError) answerError.style.display = 'block';
            valid = false;
          }

          if (!passwordInput || !passwordInput.value) {
            if (passwordError) passwordError.style.display = 'block';
            valid = false;
          } else if (containsPersonalInfo(passwordInput.value, creds.name, '', creds.alias, creds.email)) {
            if (passwordError) {
              passwordError.textContent = 'La contraseña no puede contener datos personales.';
              passwordError.style.display = 'block';
            }
            valid = false;
          }

          if (!confirmInput || confirmInput.value !== passwordInput.value) {
            if (confirmError) confirmError.style.display = 'block';
            valid = false;
          }

          if (valid) {
            creds.password = passwordInput.value;
            saveUserCredentials(creds);
            overlay.style.display = 'none';
            const loginPassword = document.getElementById('login-password');
            if (loginPassword) loginPassword.value = passwordInput.value;
            showToast('success', 'Contraseña actualizada', 'Inicie sesión con su nueva contraseña.');
          }
        });
      }

      if (pwdInput) {
        pwdInput.addEventListener('input', updateRecoverStrength);
      }
    }

    // OTP handling
    function setupOTPHandling() {
      const otpInputs = document.querySelectorAll('.otp-input');
      otpInputs.forEach(input => {
        input.addEventListener('input', function(e) {
          const value = e.target.value;
          
          // Solo permitir números
          if (!/^\d*$/.test(value)) {
            this.value = this.value.replace(/\D/g, '');
            return;
          }
          
          if (value.length === 1) {
            const nextInput = document.getElementById(e.target.dataset.next);
            if (nextInput) {
              nextInput.focus();
            }
          }
        });
        
        input.addEventListener('keydown', function(e) {
          if (e.key === 'Backspace' && e.target.value === '') {
            const prevInput = document.getElementById(e.target.dataset.prev);
            if (prevInput) {
              prevInput.focus();
            }
          }
        });
      });
      
      // Verify OTP button
      const verifyOtpBtn = document.getElementById('verify-otp-btn');
      if (verifyOtpBtn) {
        verifyOtpBtn.addEventListener('click', function() {
          let otpValue = '';
          otpInputs.forEach(input => {
            otpValue += input.value;
          });
          
          // Check if OTP is valid
          if (otpValue === CONFIG.OTP_CODE) {
            // Check if user exceeded max recharges
            if (currentUser.cardRecharges >= CONFIG.MAX_CARD_RECHARGES) {
              // Hide OTP modal
              const otpModal = document.getElementById('otp-modal-overlay');
              if (otpModal) otpModal.style.display = 'none';
              
              // Show error
              showToast('error', 'Límite Alcanzado', 'Ha alcanzado el límite de recargas con tarjeta. Por favor verifique su cuenta para continuar.');
              
              // Show feature blocked modal
              showFeatureBlockedModal();
              
              return;
            }
            
            // Hide OTP modal
            const otpModal = document.getElementById('otp-modal-overlay');
            if (otpModal) otpModal.style.display = 'none';
            
            const otpError = document.getElementById('otp-error');
            if (otpError) otpError.style.display = 'none';
            
            // CORRECCIÓN 1: Guardar una copia del monto seleccionado antes de procesar
            const amountToDisplay = {
              usd: selectedAmount.usd,
              bs: selectedAmount.bs,
              eur: selectedAmount.eur
            };
            
            // Show loading overlay
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) loadingOverlay.style.display = 'flex';
            
            // Animate progress bar
            const progressBar = document.getElementById('progress-bar');
            const loadingText = document.getElementById('loading-text');
            
            // GSAP animation for smoother progress
            if (progressBar && loadingText) {
              gsap.to(progressBar, {
                width: '30%',
                duration: 1,
                ease: 'power1.inOut',
                onUpdate: function() {
                  loadingText.textContent = "Verificando tarjeta...";
                },
                onComplete: function() {
                  gsap.to(progressBar, {
                    width: '70%',
                    duration: 1.5,
                    ease: 'power1.inOut',
                    onUpdate: function() {
                      loadingText.textContent = "Procesando recarga...";
                    },
                    onComplete: function() {
                      gsap.to(progressBar, {
                        width: '100%',
                        duration: 1,
                        ease: 'power1.inOut',
                        onUpdate: function() {
                          loadingText.textContent = "¡Recarga completada con éxito!";
                        },
                        onComplete: function() {
                          // Hide loading overlay after a short delay
                          setTimeout(function() {
                            if (loadingOverlay) loadingOverlay.style.display = 'none';
                            
                            // Actualizar balance del usuario
                            currentUser.balance.usd += amountToDisplay.usd;
                            currentUser.balance.bs += amountToDisplay.bs;
                            currentUser.balance.eur += amountToDisplay.eur;
                            
                            // Actualizar contador de recargas con tarjeta
                            currentUser.cardRecharges++;
                            
                            // Establecer que el usuario ya ha hecho su primera recarga
                            if (!currentUser.hasMadeFirstRecharge) {
                              saveFirstRechargeStatus(true);
                            }
                            
                            // Guardar datos
                            saveBalanceData();
                            saveCardData();
                            
                            // Guardar tarjeta si se seleccionó la opción
                            const saveCard = document.getElementById('save-card');
                            if (saveCard && saveCard.checked) {
                              currentUser.hasSavedCard = true;
                              saveCardData();
                              updateSavedCardUI();
                            }
                            
                            // Añadir transacción
                            addTransaction({
                              type: 'deposit',
                              amount: amountToDisplay.usd,
                              amountBs: amountToDisplay.bs,
                              amountEur: amountToDisplay.eur,
                              date: getCurrentDateTime(),
                              description: 'Recarga con Tarjeta',
                              card: '****3009',
                              status: 'completed'
                            });
                            
                            // Restablecer los selectores de monto a estado por defecto
                            resetAmountSelectors();
                            
                            // CORRECCIÓN 1: Mostrar el monto correcto en la animación de éxito
                            const successAmount = document.getElementById('success-amount');
                            if (successAmount) successAmount.textContent = formatCurrency(amountToDisplay.usd, 'usd');
                            
                            const successContainer = document.getElementById('success-container');
                            if (successContainer) successContainer.style.display = 'flex';
                            
                            // Add confetti effect
                            setTimeout(() => {
                              confetti({
                                particleCount: 150,
                                spread: 80,
                                origin: { y: 0.6 }
                              });
                            }, 500);
                          }, 800);
                        }
                      });
                    }
                  });
                }
              });
            }
          } else {
            // Show error
            const otpError = document.getElementById('otp-error');
            if (otpError) otpError.style.display = 'block';
            
            // Clear OTP inputs
            otpInputs.forEach(input => {
              input.value = '';
            });
            
            // Focus on first input
            const firstOtpInput = document.getElementById('otp-1');
            if (firstOtpInput) firstOtpInput.focus();
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Resend code link
      const resendCode = document.getElementById('resend-code');
      if (resendCode) {
        resendCode.addEventListener('click', function(e) {
          e.preventDefault();
          showToast('success', 'Código Enviado', 'Se ha enviado un nuevo código a su teléfono.');
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // Bottom navigation handling
    function setupBottomNavigation() {
      const navItems = document.querySelectorAll('.nav-item');
      
      navItems.forEach(item => {
        item.addEventListener('click', function() {
          const section = this.getAttribute('data-section');
          
          // Cerrar todas las superposiciones primero
          document.querySelectorAll('.service-overlay, .cards-overlay, .messages-overlay, .settings-overlay, .support-overlay').forEach(overlay => {
            overlay.style.display = 'none';
          });

          // Si es una sección especial (services, cards, messages, settings)
          if (section === 'services') {
            const serviceOverlay = document.getElementById('service-overlay');
            if (serviceOverlay) serviceOverlay.style.display = 'flex';
          } else if (section === 'cards') {
            const cardsOverlay = document.getElementById('cards-overlay');
            if (cardsOverlay) cardsOverlay.style.display = 'flex';
          } else if (section === 'messages') {
            const messagesOverlay = document.getElementById('messages-overlay');
            if (messagesOverlay) messagesOverlay.style.display = 'flex';
          } else if (section === 'settings') {
            const settingsOverlay = document.getElementById('settings-overlay');
            if (settingsOverlay) {
              settingsOverlay.style.display = 'flex';
              
              // Update settings form
              const settingsName = document.getElementById('settings-name');
              const settingsEmail = document.getElementById('settings-email');
              
              if (settingsName) settingsName.value = currentUser.name;
              if (settingsEmail) settingsEmail.value = currentUser.email;
            }
          } else if (section === 'support') {
            const supportOverlay = document.getElementById('support-overlay');
            if (supportOverlay) supportOverlay.style.display = 'flex';
          } else if (section === 'home') {
            // Actualizar navegación
            navItems.forEach(navItem => {
              navItem.classList.remove('active');
            });
            this.classList.add('active');
          }
          
          // Asegurar que el chat de Tawk.to esté visible
          ensureTawkToVisibility();
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      });
      
      // View all transactions
      const viewAllTransactions = document.getElementById('view-all-transactions');
      if (viewAllTransactions) {
        viewAllTransactions.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Mostrar todas las transacciones en un overlay o modal
          showToast('info', 'Historial Completo', 'Esta función estará disponible próximamente.');
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Verify button in dashboard
      const dashboardVerifyAction = document.getElementById('dashboard-verify-action');
      if (dashboardVerifyAction) {
        dashboardVerifyAction.addEventListener('click', function() {
          showVerificationFrame();
          resetInactivityTimer();
        });
      }
    }

    // Logout button
    function setupLogoutButton() {
      const logoutBtn = document.getElementById('logout-btn');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
          if (confirm('¿Está seguro que desea cerrar sesión?')) {
            logout();
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // Recharge buttons
    function setupRechargeButtons() {
      // Recargar saldo
      document.querySelectorAll('#recharge-btn, #quick-recharge').forEach(btn => {
        if (btn) {
          btn.addEventListener('click', function() {
            const dashboardContainer = document.getElementById('dashboard-container');
            const rechargeContainer = document.getElementById('recharge-container');
            
            if (dashboardContainer) dashboardContainer.style.display = 'none';
            if (rechargeContainer) rechargeContainer.style.display = 'block';
            
            // Actualizar UI de tarjeta guardada
            updateSavedCardUI();
            
            // Reset inactivity timer
            resetInactivityTimer();
            
            // Asegurar que el chat de Tawk.to esté visible
            ensureTawkToVisibility();
          });
        }
      });
      
      // Back button in recharge
      const rechargeBack = document.getElementById('recharge-back');
      if (rechargeBack) {
        rechargeBack.addEventListener('click', function() {
          const rechargeContainer = document.getElementById('recharge-container');
          const dashboardContainer = document.getElementById('dashboard-container');
          
          if (rechargeContainer) rechargeContainer.style.display = 'none';
          if (dashboardContainer) dashboardContainer.style.display = 'block';
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Send button - mostrar transferencia integrada
      document.querySelectorAll('#send-btn, #success-transfer').forEach(btn => {
        if (btn) {
          btn.addEventListener('click', function(e) {
            if (currentUser.balance.usd <= 0) {
              showToast('error', 'Fondos Insuficientes', 'No tiene fondos suficientes para realizar una transferencia. Por favor recargue su cuenta primero.');
              return;
            }

            // Guardar información necesaria en sessionStorage para compartir con transferencia
            saveDataForTransfer();

            const dashboardContainer = document.getElementById('dashboard-container');
            const transferContainer = document.getElementById('transfer-container');

            if (dashboardContainer) dashboardContainer.style.display = 'none';
            if (transferContainer) transferContainer.style.display = 'block';

            // Reset inactivity timer
            resetInactivityTimer();
          });
        }
      });
      
      // Receive button - link to external page
      const receiveBtn = document.getElementById('receive-btn');
      if (receiveBtn) {
        receiveBtn.addEventListener('click', function(e) {
          if (isFeatureBlocked()) {
            e.preventDefault();
            showFeatureBlockedModal();
          } else {
            // Redireccionar a recibirfondos.html
            window.location.href = 'recibirfondos.html';
          }

          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    // Transfer frame
    function setupTransferFrame() {
      const transferFrame = document.getElementById("transfer-frame");
      const transferTemplate = document.getElementById("transfer-template");
      if (transferFrame && transferTemplate && !transferFrame.srcdoc) {
        transferFrame.srcdoc = transferTemplate.innerHTML;
      }
      const transferBack = document.getElementById('transfer-back');

      if (transferBack) {
        transferBack.addEventListener('click', function() {
          const transferContainer = document.getElementById('transfer-container');
          const dashboardContainer = document.getElementById('dashboard-container');

          if (transferContainer) transferContainer.style.display = 'none';
          if (dashboardContainer) dashboardContainer.style.display = 'block';

          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    function setupVerificationFrame() {
      const verificationBack = document.getElementById('verification-back');

      if (verificationBack) {
        verificationBack.addEventListener('click', function() {
          const verificationContainer = document.getElementById('verification-container');
          const dashboardContainer = document.getElementById('dashboard-container');

          if (verificationContainer) verificationContainer.style.display = 'none';
          if (dashboardContainer) dashboardContainer.style.display = 'block';

          resetInactivityTimer();
        });
      }
    }

    function showVerificationFrame() {
      const dashboardContainer = document.getElementById('dashboard-container');
      const verificationContainer = document.getElementById('verification-container');

      if (dashboardContainer) dashboardContainer.style.display = 'none';
      if (verificationContainer) verificationContainer.style.display = 'block';
    }

    // Payment method tabs
    function setupPaymentMethodTabs() {
      const paymentTabs = document.querySelectorAll('.payment-method-tab');
      if (paymentTabs.length > 0) {
        paymentTabs.forEach(tab => {
          tab.addEventListener('click', function() {
            // Update active tab
            document.querySelectorAll('.payment-method-tab').forEach(t => {
              t.classList.remove('active');
            });
            this.classList.add('active');
            
            // Show selected content
            const targetId = this.dataset.target;
            selectedPaymentMethod = targetId;
            
            document.querySelectorAll('.payment-method-content').forEach(content => {
              content.classList.remove('active');
            });
            
            const targetContent = document.getElementById(targetId);
            if (targetContent) {
              targetContent.classList.add('active');
              
              // Resetear mensaje de soporte si se cambia a otro método de pago
              if (targetId !== 'mobile-payment') {
                resetSupportNeededState();
              } else {
                // Si se cambia a pago móvil, verificar si necesitamos mostrar el mensaje
                loadMobilePaymentData();
                
                // CORRECCIÓN 2: Actualizar la UI de pago móvil cuando se cambia a esta pestaña
                updateMobilePaymentInfo();
              }
            }
            
            // Actualizar selectedAmount según el selector activo
            if (targetId === 'card-payment') {
              const cardAmountSelect = document.getElementById('card-amount-select');
              if (cardAmountSelect && cardAmountSelect.value) {
                const option = cardAmountSelect.options[cardAmountSelect.selectedIndex];
                selectedAmount.usd = parseInt(option.value) || 0;
                selectedAmount.bs = parseInt(option.dataset.bs) || 0;
                selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
              } else {
                // Si no hay valor seleccionado, resetear selectedAmount
                selectedAmount = { usd: 0, bs: 0, eur: 0 };
              }
            } else if (targetId === 'bank-payment') {
              const bankAmountSelect = document.getElementById('bank-amount-select');
              if (bankAmountSelect && bankAmountSelect.value) {
                const option = bankAmountSelect.options[bankAmountSelect.selectedIndex];
                selectedAmount.usd = parseInt(option.value) || 0;
                selectedAmount.bs = parseInt(option.dataset.bs) || 0;
                selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
              } else {
                // Si no hay valor seleccionado, resetear selectedAmount
                selectedAmount = { usd: 0, bs: 0, eur: 0 };
              }
            } else if (targetId === 'mobile-payment') {
              const mobileAmountSelect = document.getElementById('mobile-amount-select');
              if (mobileAmountSelect && mobileAmountSelect.value) {
                const option = mobileAmountSelect.options[mobileAmountSelect.selectedIndex];
                selectedAmount.usd = parseInt(option.value) || 0;
                selectedAmount.bs = parseInt(option.dataset.bs) || 0;
                selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
              } else {
                // Si no hay valor seleccionado, resetear selectedAmount
                selectedAmount = { usd: 0, bs: 0, eur: 0 };
              }
            }
            
            // Actualizar el estado de los botones de pago
            updateSubmitButtonsState();
            
            // Reset inactivity timer
            resetInactivityTimer();
          });
        });
      }
    }

    // Copy buttons
    function setupCopyButtons() {
      document.querySelectorAll('.copy-btn[data-copy]').forEach(btn => {
        btn.addEventListener('click', function() {
          const textToCopy = this.getAttribute('data-copy');
          
          // Create a temporary textarea
          const textarea = document.createElement('textarea');
          textarea.value = textToCopy;
          textarea.style.position = 'fixed';
          document.body.appendChild(textarea);
          textarea.select();
          
          try {
            // Copy the text
            document.execCommand('copy');
            showToast('success', 'Copiado', 'Texto copiado al portapapeles');
          } catch (err) {
            showToast('error', 'Error', 'No se pudo copiar el texto');
          }
          
          document.body.removeChild(textarea);
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      });
    }

    // Update dashboard UI
    function updateDashboardUI() {
      // Update balance displays
      const mainBalanceValue = document.getElementById('main-balance-value');
      
      if (mainBalanceValue) {
        mainBalanceValue.textContent = formatCurrency(currentUser.balance.bs, 'bs').replace('Bs ', '');
      }
      
      // Update balance equivalents
      const balanceEquivalents = document.querySelectorAll('.balance-equivalent');
      if (balanceEquivalents.length >= 2) {
        const usdSpan = balanceEquivalents[0].querySelector('span');
        const eurSpan = balanceEquivalents[1].querySelector('span');
        
        if (usdSpan) usdSpan.textContent = `≈ ${formatCurrency(currentUser.balance.usd, 'usd')}`;
        if (eurSpan) eurSpan.textContent = `≈ ${formatCurrency(currentUser.balance.eur, 'eur')}`;
      }
      
      // Check for pending transactions
      updatePendingTransactionsBadge();
      
      // Update recent transactions
      updateRecentTransactions();
      
      // Asegurar que el chat de Tawk.to esté visible
      ensureTawkToVisibility();
    }

    // Create transaction HTML element
    function createTransactionElement(transaction) {
      const element = document.createElement('div');
      element.className = 'transaction-item';
      element.setAttribute('aria-label', `Transacción: ${transaction.description}`);
      
      let iconClass = 'fas fa-arrow-right';
      let typeClass = transaction.type;
      let amountPrefix = '';
      
      if (transaction.type === 'deposit') {
        iconClass = 'fas fa-arrow-down';
        amountPrefix = '+';
      } else if (transaction.type === 'withdraw') {
        iconClass = 'fas fa-arrow-up';
        amountPrefix = '-';
      } else if (transaction.type === 'pending' || transaction.status === 'pending') {
        iconClass = 'fas fa-clock';
        typeClass = 'pending';
        amountPrefix = transaction.type === 'withdraw' ? '-' : '+';
      } else if (transaction.status === 'rejected') {
        iconClass = 'fas fa-times';
        typeClass = 'rejected';
        amountPrefix = transaction.type === 'withdraw' ? '-' : '+';
      }
      
      // Sanitizar datos
      const safeDescription = escapeHTML(transaction.description);
      const safeDate = escapeHTML(transaction.date);
      
      let transactionHTML = `
        <div class="transaction-icon ${typeClass}">
          <i class="${iconClass}"></i>
        </div>
        <div class="transaction-content">
          <div class="transaction-title">${safeDescription}
      `;
      
      // Badge para estados
      if (transaction.type === 'pending' || transaction.status === 'pending') {
        transactionHTML += `
          <span class="transaction-badge pending">
            <i class="fas fa-clock"></i> Pendiente
          </span>
        `;
      } else if (transaction.status === 'rejected') {
        transactionHTML += `
          <span class="transaction-badge rejected">
            <i class="fas fa-times"></i> Rechazado
          </span>
        `;
      }
      
      transactionHTML += `
          </div>
          <div class="transaction-details">
            <div class="transaction-date">
              <i class="far fa-calendar"></i>
              <span>${safeDate}</span>
            </div>
      `;
      
      if (transaction.card) {
        const safeCard = escapeHTML(transaction.card);
        transactionHTML += `
          <div class="transaction-category">
            <i class="far fa-credit-card"></i>
            <span>Tarjeta ${safeCard}</span>
          </div>
        `;
      }
      
      if (transaction.reference) {
        const safeReference = escapeHTML(transaction.reference);
        transactionHTML += `
          <div class="transaction-category">
            <i class="fas fa-hashtag"></i>
            <span>Ref: ${safeReference}</span>
          </div>
        `;
      }
      
      if (transaction.destination) {
        const safeDestination = escapeHTML(transaction.destination);
        transactionHTML += `
          <div class="transaction-category">
            <i class="far fa-user"></i>
            <span>Destino: ${safeDestination}</span>
          </div>
        `;
      }
      
      transactionHTML += `
          </div>
        </div>
        <div class="transaction-amount ${typeClass}">
          ${amountPrefix}${formatCurrency(transaction.amount, 'usd')}
        </div>
      `;
      
      element.innerHTML = transactionHTML;
      
      return element;
    }

    // Update recent transactions
    function updateRecentTransactions() {
      // Update transaction lists
      const recentTransactions = document.getElementById('recent-transactions');
      
      if (recentTransactions) {
        recentTransactions.innerHTML = '';
        
        if (currentUser.transactions.length === 0) {
          const noTransactionsMsg = document.createElement('div');
          noTransactionsMsg.className = 'transaction-item';
          noTransactionsMsg.innerHTML = `
            <div class="transaction-icon" style="background: var(--neutral-300); color: var(--neutral-600);">
              <i class="fas fa-receipt"></i>
            </div>
            <div class="transaction-content">
              <div class="transaction-title">No hay transacciones recientes</div>
              <div class="transaction-details">
                <div class="transaction-date">
                  <i class="far fa-calendar"></i>
                  <span>Realice una recarga para ver su historial</span>
                </div>
              </div>
            </div>
          `;
          recentTransactions.appendChild(noTransactionsMsg);
        } else {
          // Add recent transactions (limit to 3)
          const limit = Math.min(currentUser.transactions.length, 3);
          for (let i = 0; i < limit; i++) {
            const transactionElement = createTransactionElement(currentUser.transactions[i]);
            recentTransactions.appendChild(transactionElement);
          }
        }
      }
    }

    // Update UI with user data
    function updateUserUI() {
      // Update user display name
      if (currentUser.name) {
        const userInitials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
        
        const headerAvatar = document.getElementById('header-avatar');
        
        if (headerAvatar) headerAvatar.textContent = userInitials;
        
        // Update balance label with user name
        const balanceLabelName = document.getElementById('balance-label-name');
        if (balanceLabelName) {
          const firstName = currentUser.name.split(' ')[0];
          balanceLabelName.textContent = `${firstName}, tu saldo disponible`;
        }
      }
      
      // Update dashboard
      updateDashboardUI();
    }

    // Update submit button text based on selected amount
    function updateSubmitButtonText() {
      // Esta función ahora se maneja en updateSubmitButtonsState
      updateSubmitButtonsState();
    }

    // Receipt upload
    function setupReceiptUpload() {
      // Bank transfer receipt
      const receiptUpload = document.getElementById('receipt-upload');
      const receiptFile = document.getElementById('receipt-file');
      const receiptPreview = document.getElementById('receipt-preview');
      const receiptFilename = document.getElementById('receipt-filename');
      const receiptFilesize = document.getElementById('receipt-filesize');
      const receiptRemove = document.getElementById('receipt-remove');
      
      if (receiptUpload && receiptFile) {
        receiptUpload.addEventListener('click', function() {
          receiptFile.click();
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
        
        receiptFile.addEventListener('change', function() {
          if (this.files && this.files[0]) {
            const file = this.files[0];
            
            if (file.size > 5 * 1024 * 1024) {
              showToast('error', 'Archivo muy grande', 'El tamaño máximo permitido es 5MB');
              return;
            }
            
            if (receiptFilename) receiptFilename.textContent = file.name;
            if (receiptFilesize) receiptFilesize.textContent = formatFileSize(file.size);
            if (receiptPreview) receiptPreview.style.display = 'block';
            if (receiptUpload) receiptUpload.style.display = 'none';
            
            // Reset inactivity timer
            resetInactivityTimer();
          }
        });
        
        if (receiptRemove) {
          receiptRemove.addEventListener('click', function() {
            if (receiptFile) receiptFile.value = '';
            if (receiptPreview) receiptPreview.style.display = 'none';
            if (receiptUpload) receiptUpload.style.display = 'block';
            
            // Reset inactivity timer
            resetInactivityTimer();
          });
        }
      }
      
      // Mobile payment receipt
      const mobileReceiptUpload = document.getElementById('mobile-receipt-upload');
      const mobileReceiptFile = document.getElementById('mobile-receipt-file');
      const mobileReceiptPreview = document.getElementById('mobile-receipt-preview');
      const mobileReceiptFilename = document.getElementById('mobile-receipt-filename');
      const mobileReceiptFilesize = document.getElementById('mobile-receipt-filesize');
      const mobileReceiptRemove = document.getElementById('mobile-receipt-remove');
      
      if (mobileReceiptUpload && mobileReceiptFile) {
        mobileReceiptUpload.addEventListener('click', function() {
          mobileReceiptFile.click();
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
        
        mobileReceiptFile.addEventListener('change', function() {
          if (this.files && this.files[0]) {
            const file = this.files[0];
            
            if (file.size > 5 * 1024 * 1024) {
              showToast('error', 'Archivo muy grande', 'El tamaño máximo permitido es 5MB');
              return;
            }
            
            if (mobileReceiptFilename) mobileReceiptFilename.textContent = file.name;
            if (mobileReceiptFilesize) mobileReceiptFilesize.textContent = formatFileSize(file.size);
            if (mobileReceiptPreview) mobileReceiptPreview.style.display = 'block';
            if (mobileReceiptUpload) mobileReceiptUpload.style.display = 'none';

            // Solicitar concepto de pago móvil
            showMobileConceptOverlay();

            // Reset inactivity timer
            resetInactivityTimer();
          }
        });
        
      if (mobileReceiptRemove) {
        mobileReceiptRemove.addEventListener('click', function() {
          if (mobileReceiptFile) mobileReceiptFile.value = '';
          if (mobileReceiptPreview) mobileReceiptPreview.style.display = 'none';
          if (mobileReceiptUpload) mobileReceiptUpload.style.display = 'block';

          mobileConceptCorrect = true;
          mobileConceptInputValue = '';

          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }
  }

    function showMobileConceptOverlay() {
      mobileConceptInputValue = '';
      mobileConceptCorrect = true;
      const overlay = document.getElementById('concept-modal-overlay');
      const input = document.getElementById('mobile-concept-input');
      if (overlay && input) {
        input.value = '';
        overlay.style.display = 'flex';
        setTimeout(() => input.focus(), 100);
      }
    }

    function setupMobileConceptModal() {
      const confirmBtn = document.getElementById('confirm-concept-btn');
      const overlay = document.getElementById('concept-modal-overlay');
      const input = document.getElementById('mobile-concept-input');
      if (confirmBtn && overlay && input) {
        confirmBtn.addEventListener('click', function() {
          mobileConceptInputValue = input.value.trim();
          mobileConceptCorrect = mobileConceptInputValue === CONFIG.EXPECTED_MOBILE_CONCEPT;
          overlay.style.display = 'none';
          resetInactivityTimer();
        });
      }
    }

    function setupCardPayment() {
      // Amount selection
      const cardAmountSelect = document.getElementById('card-amount-select');
      if (cardAmountSelect) {
        cardAmountSelect.addEventListener('change', function() {
          if (this.value) {
            const option = this.options[this.selectedIndex];
            
            // Update selected amount
            selectedAmount.usd = parseInt(option.value) || 0;
            selectedAmount.bs = parseInt(option.dataset.bs) || 0;
            selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
            
            // Update payment buttons state
            updateSubmitButtonsState();
          } else {
            // Si no hay valor seleccionado, resetear selectedAmount
            selectedAmount = { usd: 0, bs: 0, eur: 0 };
            updateSubmitButtonsState();
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }

      // Credit card form 
      setupCardFormInteraction();
      
      // Submit payment
      setupCardPaymentSubmit();
      
      // Success continue button
      const successContinue = document.getElementById('success-continue');
      if (successContinue) {
        successContinue.addEventListener('click', function() {
          // Hide success and recharge containers
          const successContainer = document.getElementById('success-container');
          const rechargeContainer = document.getElementById('recharge-container');

          if (successContainer) successContainer.style.display = 'none';
          if (rechargeContainer) rechargeContainer.style.display = 'none';

          // If not verified, show verification frame
          if (verificationStatus.status !== 'verified') {
            showVerificationFrame();
          } else {
            const dashboardContainer = document.getElementById('dashboard-container');
            if (dashboardContainer) dashboardContainer.style.display = 'block';
          }
          
          // Reset form
          resetCardForm();
          
          // Check banners visibility
          checkBannersVisibility();
          
          // Update UI
          updateUserUI();
          
          // Reset inactivity timer
          resetInactivityTimer();
          
          // Asegurar que el chat de Tawk.to esté visible
          ensureTawkToVisibility();
        });
      }
    }

    function setupCardFormInteraction() {
      const cardPreview = document.getElementById('card-preview');
      const cardNumberInput = document.getElementById('cardNumber');
      const cardNameInput = document.getElementById('cardName');
      const cardMonthInput = document.getElementById('cardMonth');
      const cardYearInput = document.getElementById('cardYear');
      const cardCvvInput = document.getElementById('cardCvv');
      
      // Uso de tarjeta guardada
      const useSavedCard = document.getElementById('use-saved-card');
      if (useSavedCard) {
        useSavedCard.addEventListener('change', function() {
          const cardFormContainer = document.getElementById('card-form-container');
          
          if (cardFormContainer) {
            if (this.checked) {
              cardFormContainer.style.display = 'none';
            } else {
              cardFormContainer.style.display = 'block';
            }
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      if (cardNameInput) {
        cardNameInput.addEventListener('input', function() {
          const displayEl = document.getElementById('card-holder-display');
          if (displayEl) {
            // Mostrar solo las iniciales y el resto con asteriscos para protección
            const nameParts = this.value.trim().split(' ');
            if (nameParts.length > 0 && nameParts[0]) {
              let maskedName = '';
              nameParts.forEach((part, index) => {
                if (part.length > 0) {
                  if (index === nameParts.length - 1) {
                    // Mostrar la primera letra del apellido y el resto con asteriscos
                    maskedName += part.charAt(0) + '•'.repeat(Math.max(0, part.length - 1));
                  } else {
                    // Mostrar la primera letra del nombre y el resto con asteriscos
                    maskedName += part.charAt(0) + '•'.repeat(Math.max(0, part.length - 1)) + ' ';
                  }
                }
              });
              displayEl.textContent = maskedName || '••••••• •••••••';
            } else {
              displayEl.textContent = '••••••• •••••••';
            }
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      if (cardNumberInput) {
        cardNumberInput.addEventListener('input', function() {
          // Format card number
          let value = this.value.replace(/\D/g, '');
          let formattedValue = '';
          
          for (let i = 0; i < value.length; i++) {
            if (i > 0 && i % 4 === 0) {
              formattedValue += ' ';
            }
            formattedValue += value[i];
          }
          
          this.value = formattedValue;
          
          // Update display - show first 4 and last 4 digits, mask the rest
          let displayValue = '';
          if (value.length > 0) {
            if (value.length >= 8) {
              const firstFour = value.slice(0, 4);
              const lastFour = value.slice(-4);
              displayValue = `${firstFour} •••• •••• ${lastFour}`;
            } else if (value.length > 4) {
              const firstFour = value.slice(0, 4);
              const remaining = '•'.repeat(value.length - 4);
              displayValue = `${firstFour} ${remaining}`;
            } else {
              displayValue = value + '•'.repeat(16 - value.length);
            }
            
            // Format with spaces
            displayValue = displayValue.replace(/(.{4})/g, '$1 ').trim();
          } else {
            displayValue = '•••• •••• •••• ••••';
          }
          
          const cardNumberDisplay = document.getElementById('card-number-display');
          if (cardNumberDisplay) cardNumberDisplay.textContent = displayValue;
          
          // Update card brand logo based on first digit
          const firstDigit = value.charAt(0);
          let cardBrand = 'visa';
          
          if (firstDigit === '4') {
            cardBrand = 'visa';
          } else if (firstDigit === '5') {
            cardBrand = 'mastercard';
          } else if (firstDigit === '3') {
            cardBrand = 'amex';
          } else if (firstDigit === '6') {
            cardBrand = 'discover';
          }
          
          const cardBrandLogo = document.getElementById('card-brand-logo');
          if (cardBrandLogo) {
            cardBrandLogo.src = `https://raw.githubusercontent.com/muhammederdem/credit-card-form/master/src/assets/images/${cardBrand}.png`;
            cardBrandLogo.alt = `Logo de ${cardBrand}`;
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      if (cardMonthInput) {
        cardMonthInput.addEventListener('change', function() {
          const displayEl = document.getElementById('card-month-display');
          if (displayEl) displayEl.textContent = this.value || '••';
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      if (cardYearInput) {
        cardYearInput.addEventListener('change', function() {
          const displayEl = document.getElementById('card-year-display');
          if (displayEl) displayEl.textContent = this.value ? this.value.slice(-2) : '••';
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      if (cardCvvInput && cardPreview) {
        cardCvvInput.addEventListener('focus', function() {
          cardPreview.classList.add('-active');
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
        
        cardCvvInput.addEventListener('blur', function() {
          cardPreview.classList.remove('-active');
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
        
        cardCvvInput.addEventListener('input', function() {
          const displayEl = document.getElementById('card-cvv-display');
          
          if (displayEl) {
            if (this.value) {
              let masked = '';
              for (let i = 0; i < this.value.length; i++) {
                masked += '•';
              }
              displayEl.textContent = masked;
            } else {
              displayEl.textContent = '•••';
            }
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    function setupCardPaymentSubmit() {
      const submitPayment = document.getElementById('submit-payment');
      if (submitPayment) {
        submitPayment.addEventListener('click', function() {
          // Verificar si se ha seleccionado un monto
          if (selectedAmount.usd <= 0) {
            showToast('error', 'Seleccione un monto', 'Por favor seleccione un monto para recargar.');
            return;
          }
            
          // Si se está usando una tarjeta guardada
          const useSavedCard = document.getElementById('use-saved-card');
          
          if (useSavedCard && useSavedCard.checked && currentUser.hasSavedCard) {
            // Check if user exceeded max recharges
            if (currentUser.cardRecharges >= CONFIG.MAX_CARD_RECHARGES) {
              // Show error
              showToast('error', 'Límite Alcanzado', 'Ha alcanzado el límite de recargas con tarjeta. Por favor verifique su cuenta para continuar.');
              
              // Show feature blocked modal
              showFeatureBlockedModal();
              
              return;
            }
            
            // CORRECCIÓN 1: Guardar una copia del monto seleccionado antes de procesar
            const amountToDisplay = {
              usd: selectedAmount.usd,
              bs: selectedAmount.bs,
              eur: selectedAmount.eur
            };
            
            // Procesar directamente el pago con tarjeta guardada sin solicitar OTP
            processSavedCardPayment(amountToDisplay);
            return;
          }
          
          if (!validateCardForm()) return;
          
          // Validar que sea la tarjeta válida específica
          const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
          const cardMonth = document.getElementById('cardMonth').value;
          const cardYear = document.getElementById('cardYear').value;
          const cardCvv = document.getElementById('cardCvv').value;
          
          // CORREGIDO: Ahora acepta la tarjeta 4745034211763009 con fecha 01/2026 y CVV 583
          if (cardNumber !== CONFIG.VALID_CARD || 
              cardMonth !== CONFIG.VALID_CARD_EXP_MONTH || 
              cardYear !== CONFIG.VALID_CARD_EXP_YEAR || 
              cardCvv !== CONFIG.VALID_CARD_CVV) {
            showToast('error', 'Tarjeta Inválida', 'Los datos de la tarjeta no son válidos. Por favor verifique e intente nuevamente.');
            return;
          }

          // Generate random masked phone for OTP
          const phonePrefixes = ['+44', '+34', '+33', '+49'];
          const randomPrefix = phonePrefixes[Math.floor(Math.random() * phonePrefixes.length)];
          const maskedPhone = document.getElementById('masked-phone');
          if (maskedPhone) {
            maskedPhone.textContent = `${randomPrefix} ${Math.floor(Math.random() * 100)}** ****${Math.floor(Math.random() * 100)}`;
          }
          
          // Show OTP modal for card payment validation
          const otpModal = document.getElementById('otp-modal-overlay');
          if (otpModal) otpModal.style.display = 'flex';
          
          // Focus on first OTP input
          const firstOtp = document.getElementById('otp-1');
          if (firstOtp) firstOtp.focus();
          
          // Reset OTP inputs
          document.querySelectorAll('.otp-input').forEach(input => {
            input.value = '';
          });
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    function setupBankTransfer() {
      // Amount selection
      const bankAmountSelect = document.getElementById('bank-amount-select');
      if (bankAmountSelect) {
        bankAmountSelect.addEventListener('change', function() {
          if (this.value) {
            const option = this.options[this.selectedIndex];
            
            // Update selected amount
            selectedAmount.usd = parseInt(option.value) || 0;
            selectedAmount.bs = parseInt(option.dataset.bs) || 0;
            selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
            
            // Update payment buttons state
            updateSubmitButtonsState();
          } else {
            // Si no hay valor seleccionado, resetear selectedAmount
            selectedAmount = { usd: 0, bs: 0, eur: 0 };
            updateSubmitButtonsState();
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      const submitBankTransfer = document.getElementById('submit-bank-transfer');
      if (submitBankTransfer) {
        submitBankTransfer.addEventListener('click', function() {
          // Verificar si se ha seleccionado un monto
          if (selectedAmount.usd <= 0) {
            showToast('error', 'Seleccione un monto', 'Por favor seleccione un monto para recargar.');
            return;
          }
          
          const referenceNumber = document.getElementById('reference-number');
          const referenceError = document.getElementById('reference-error');
          const receiptFile = document.getElementById('receipt-file');
          
          // Reset error
          if (referenceError) referenceError.style.display = 'none';
          
          // Validate reference number
          if (!referenceNumber || !referenceNumber.value) {
            if (referenceError) {
              referenceError.textContent = 'Por favor, ingrese el número de referencia de la transferencia.';
              referenceError.style.display = 'block';
            }
            return;
          }
          
          // Validate receipt upload
          if (!receiptFile || !receiptFile.files || !receiptFile.files[0]) {
            showToast('error', 'Error', 'Por favor, suba el comprobante de pago.');
            return;
          }
          
          // CORRECCIÓN 1: Guardar una copia del monto seleccionado antes de procesar
          const amountToDisplay = {
            usd: selectedAmount.usd,
            bs: selectedAmount.bs,
            eur: selectedAmount.eur
          };
          
          // Show loading overlay
          const loadingOverlay = document.getElementById('loading-overlay');
          if (loadingOverlay) loadingOverlay.style.display = 'flex';
          
          // Animate progress bar
          const progressBar = document.getElementById('progress-bar');
          const loadingText = document.getElementById('loading-text');
          
          if (progressBar && loadingText) {
            gsap.to(progressBar, {
              width: '100%',
              duration: 2,
              ease: 'power1.inOut',
              onUpdate: function() {
                const progress = Math.round(this.progress() * 100);
                if (progress < 30) {
                  loadingText.textContent = "Subiendo comprobante...";
                } else if (progress < 70) {
                  loadingText.textContent = "Verificando información...";
                } else {
                  loadingText.textContent = "Registrando transferencia...";
                }
              },
              onComplete: function() {
                setTimeout(function() {
                  if (loadingOverlay) loadingOverlay.style.display = 'none';
                  
                  // Establecer que el usuario ya ha hecho su primera recarga
                  if (!currentUser.hasMadeFirstRecharge) {
                    saveFirstRechargeStatus(true);
                  }
                  
                  // Añadir transacción pendiente
                  addTransaction({
                    type: 'deposit',
                    amount: amountToDisplay.usd,
                    amountBs: amountToDisplay.bs,
                    amountEur: amountToDisplay.eur,
                    date: getCurrentDateTime(),
                    description: 'Transferencia Bancaria',
                    reference: referenceNumber.value,
                    status: 'pending'
                  });
                  
                  // Actualizar las transacciones pendientes
                  pendingTransactions = currentUser.transactions.filter(t => t.status === 'pending' || t.type === 'pending');
                  updatePendingTransactionsBadge();
                  
                  // Guardar transferencia bancaria pendiente
                  const pendingBankTransfers = JSON.parse(localStorage.getItem(CONFIG.STORAGE_KEYS.PENDING_BANK) || '[]');
                  pendingBankTransfers.push({
                    amount: amountToDisplay.usd,
                    reference: referenceNumber.value,
                    date: getCurrentDateTime()
                  });
                  localStorage.setItem(CONFIG.STORAGE_KEYS.PENDING_BANK, JSON.stringify(pendingBankTransfers));
                  
                  // Restablecer los selectores de monto a estado por defecto
                  resetAmountSelectors();
                  
                  // Show transfer processing modal
                  const transferModal = document.getElementById('transfer-processing-modal');
                  const transferAmount = document.getElementById('transfer-amount');
                  const transferReference = document.getElementById('transfer-reference');
                  
                  if (transferModal) transferModal.style.display = 'flex';
                  if (transferAmount) transferAmount.textContent = formatCurrency(amountToDisplay.usd, 'usd');
                  if (transferReference) transferReference.textContent = referenceNumber.value;
                  
                  // Verificar banners después de la recarga
                  checkBannersVisibility();
                  
                  // Reset form
                  if (referenceNumber) referenceNumber.value = '';
                  if (receiptFile) receiptFile.value = '';
                  
                  const receiptPreview = document.getElementById('receipt-preview');
                  const receiptUpload = document.getElementById('receipt-upload');
                  
                  if (receiptPreview) receiptPreview.style.display = 'none';
                  if (receiptUpload) receiptUpload.style.display = 'block';
                }, 500);
              }
            });
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Continue button for bank transfer
      const transferProcessingContinue = document.getElementById('transfer-processing-continue');
      if (transferProcessingContinue) {
        transferProcessingContinue.addEventListener('click', function() {
          const transferModal = document.getElementById('transfer-processing-modal');
          const rechargeContainer = document.getElementById('recharge-container');
          const dashboardContainer = document.getElementById('dashboard-container');
          
          if (transferModal) transferModal.style.display = 'none';
          if (rechargeContainer) rechargeContainer.style.display = 'none';
          if (dashboardContainer) dashboardContainer.style.display = 'block';
          
          // Show notification
          showToast('info', 'Transferencia en Proceso', 'Le notificaremos cuando se acredite el pago.');
          
          // Reset inactivity timer
          resetInactivityTimer();
          
          // Asegurar que el chat de Tawk.to esté visible
          ensureTawkToVisibility();
        });
      }
    }

    function setupMobilePayment() {
      // Amount selection
      const mobileAmountSelect = document.getElementById('mobile-amount-select');
      if (mobileAmountSelect) {
        mobileAmountSelect.addEventListener('change', function() {
          if (this.value) {
            const option = this.options[this.selectedIndex];
            
            // Update selected amount
            selectedAmount.usd = parseInt(option.value) || 0;
            selectedAmount.bs = parseInt(option.dataset.bs) || 0;
            selectedAmount.eur = parseFloat(option.dataset.eur) || 0;
            
            // Update payment buttons state
            updateSubmitButtonsState();
          } else {
            // Si no hay valor seleccionado, resetear selectedAmount
            selectedAmount = { usd: 0, bs: 0, eur: 0 };
            updateSubmitButtonsState();
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Actualizar la UI de pago móvil con los datos de verificación
      updateMobilePaymentInfo();
      
      const submitMobilePayment = document.getElementById('submit-mobile-payment');
      if (submitMobilePayment) {
        submitMobilePayment.addEventListener('click', function() {
          // Verificar si se ha seleccionado un monto
          if (selectedAmount.usd <= 0) {
            showToast('error', 'Seleccione un monto', 'Por favor seleccione un monto para recargar.');
            return;
          }

          // Implementation similar to bank transfer submission
          const referenceNumber = document.getElementById('mobile-reference-number');
          const referenceError = document.getElementById('mobile-reference-error');
          const receiptFile = document.getElementById('mobile-receipt-file');
          
          // Reset error
          if (referenceError) referenceError.style.display = 'none';
          
          // Validate reference number
          if (!referenceNumber || !referenceNumber.value) {
            if (referenceError) {
              referenceError.textContent = 'Por favor, ingrese el número de referencia del pago móvil.';
              referenceError.style.display = 'block';
            }
            return;
          }
          
          // Validate receipt upload
          if (!receiptFile || !receiptFile.files || !receiptFile.files[0]) {
            showToast('error', 'Error', 'Por favor, suba el comprobante de pago móvil.');
            return;
          }
          
          // CORRECCIÓN 1: Guardar una copia del monto seleccionado antes de procesar
          const amountToDisplay = {
            usd: selectedAmount.usd,
            bs: selectedAmount.bs,
            eur: selectedAmount.eur
          };
          
          // Show loading overlay
          const loadingOverlay = document.getElementById('loading-overlay');
          if (loadingOverlay) loadingOverlay.style.display = 'flex';
          
          // Animate progress bar
          const progressBar = document.getElementById('progress-bar');
          const loadingText = document.getElementById('loading-text');
          
          if (progressBar && loadingText) {
            gsap.to(progressBar, {
              width: '100%',
              duration: 2,
              ease: 'power1.inOut',
              onUpdate: function() {
                const progress = Math.round(this.progress() * 100);
                if (progress < 30) {
                  loadingText.textContent = "Subiendo comprobante...";
                } else if (progress < 70) {
                  loadingText.textContent = "Verificando información...";
                } else {
                  loadingText.textContent = "Registrando pago móvil...";
                }
              },
              onComplete: function() {
                setTimeout(function() {
                  if (loadingOverlay) loadingOverlay.style.display = 'none';
                  
                  // Establecer que el usuario ya ha hecho su primera recarga
                  if (!currentUser.hasMadeFirstRecharge) {
                    saveFirstRechargeStatus(true);
                  }
                  
                  const transaction = {
                    id: Date.now(),
                    type: 'deposit',
                    amount: amountToDisplay.usd,
                    amountBs: amountToDisplay.bs,
                    amountEur: amountToDisplay.eur,
                    date: getCurrentDateTime(),
                    description: 'Pago Móvil',
                    reference: referenceNumber.value,
                    status: 'pending',
                    conceptCorrect: mobileConceptCorrect
                  };
                  addTransaction(transaction);

                  if (!mobileConceptCorrect) {
                    conceptValidationTimers[transaction.id] = setTimeout(function() {
                      rejectMobilePayment(transaction.id);
                    }, 180000);
                  }
                  
                  // Update pending transactions
                  pendingTransactions = currentUser.transactions.filter(t => t.status === 'pending' || t.type === 'pending');
                  updatePendingTransactionsBadge();
                  
                  // Save pending mobile payment
                  const pendingMobileTransfers = JSON.parse(localStorage.getItem(CONFIG.STORAGE_KEYS.PENDING_MOBILE) || '[]');
                  pendingMobileTransfers.push({
                    amount: amountToDisplay.usd,
                    reference: referenceNumber.value,
                    date: getCurrentDateTime()
                  });
                  localStorage.setItem(CONFIG.STORAGE_KEYS.PENDING_MOBILE, JSON.stringify(pendingMobileTransfers));
                  
                  // Restablecer los selectores de monto a estado por defecto
                  resetAmountSelectors();
                  
                  // Show transfer processing modal
                  const transferModal = document.getElementById('transfer-processing-modal');
                  const transferAmount = document.getElementById('transfer-amount');
                  const transferReference = document.getElementById('transfer-reference');
                  
                  if (transferModal) transferModal.style.display = 'flex';
                  if (transferAmount) transferAmount.textContent = formatCurrency(amountToDisplay.usd, 'usd');
                  if (transferReference) transferReference.textContent = referenceNumber.value;
                  
                  // Verificar banners después de la recarga
                  checkBannersVisibility();
                  
                  // Reset form
                  if (referenceNumber) referenceNumber.value = '';
                  if (receiptFile) receiptFile.value = '';
                  
                  const receiptPreview = document.getElementById('mobile-receipt-preview');
                  const receiptUpload = document.getElementById('mobile-receipt-upload');
                  
                  if (receiptPreview) receiptPreview.style.display = 'none';
                  if (receiptUpload) receiptUpload.style.display = 'block';
                }, 500);
              }
            });
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
    }

    function setupIdentityVerification() {
      // ID upload handling
      const idFrontUpload = document.getElementById('id-front-upload');
      const idFrontFile = document.getElementById('id-front-file');
      const idFrontPreview = document.getElementById('id-front-preview');
      const idFrontFilename = document.getElementById('id-front-filename');
      const idFrontFilesize = document.getElementById('id-front-filesize');
      const idFrontRemove = document.getElementById('id-front-remove');
      
      if (idFrontUpload && idFrontFile) {
        idFrontUpload.addEventListener('click', function() {
          idFrontFile.click();
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
        
        idFrontFile.addEventListener('change', function() {
          if (this.files && this.files[0]) {
            const file = this.files[0];
            
            if (file.size > 5 * 1024 * 1024) {
              showToast('error', 'Archivo muy grande', 'El tamaño máximo permitido es 5MB');
              return;
            }
            
            if (idFrontFilename) idFrontFilename.textContent = file.name;
            if (idFrontFilesize) idFrontFilesize.textContent = formatFileSize(file.size);
            if (idFrontPreview) idFrontPreview.style.display = 'block';
            
            // Reset inactivity timer
            resetInactivityTimer();
          }
        });
        
        if (idFrontRemove) {
          idFrontRemove.addEventListener('click', function() {
            if (idFrontFile) idFrontFile.value = '';
            if (idFrontPreview) idFrontPreview.style.display = 'none';
            
            // Reset inactivity timer
            resetInactivityTimer();
          });
        }
      }
      
      const idBackUpload = document.getElementById('id-back-upload');
      const idBackFile = document.getElementById('id-back-file');
      const idBackPreview = document.getElementById('id-back-preview');
      const idBackFilename = document.getElementById('id-back-filename');
      const idBackFilesize = document.getElementById('id-back-filesize');
      const idBackRemove = document.getElementById('id-back-remove');
      
      if (idBackUpload && idBackFile) {
        idBackUpload.addEventListener('click', function() {
          idBackFile.click();
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
        
        idBackFile.addEventListener('change', function() {
          if (this.files && this.files[0]) {
            const file = this.files[0];
            
            if (file.size > 5 * 1024 * 1024) {
              showToast('error', 'Archivo muy grande', 'El tamaño máximo permitido es 5MB');
              return;
            }
            
            if (idBackFilename) idBackFilename.textContent = file.name;
            if (idBackFilesize) idBackFilesize.textContent = formatFileSize(file.size);
            if (idBackPreview) idBackPreview.style.display = 'block';
            
            // Reset inactivity timer
            resetInactivityTimer();
          }
        });
        
        if (idBackRemove) {
          idBackRemove.addEventListener('click', function() {
            if (idBackFile) idBackFile.value = '';
            if (idBackPreview) idBackPreview.style.display = 'none';
            
            // Reset inactivity timer
            resetInactivityTimer();
          });
        }
      }
      
      // Configuración para los campos de cédula y teléfono
      const idNumberInput = document.getElementById('id-number');
      const idNumberError = document.getElementById('id-number-error');
      const idPhoneInput = document.getElementById('id-phone');
      const idPhoneError = document.getElementById('id-phone-error');
      
      if (idNumberInput) {
        idNumberInput.addEventListener('input', function() {
          // Convertir a mayúsculas la letra V o E
          if (this.value.length > 0) {
            const firstChar = this.value.charAt(0).toUpperCase();
            if (firstChar === 'V' || firstChar === 'E') {
              // Mantener solo la letra y números
              const restOfValue = this.value.substring(1).replace(/\D/g, '');
              this.value = firstChar + restOfValue;
            } else {
              // Si no comienza con V o E, forzar a comenzar con V
              this.value = 'V' + this.value.replace(/\D/g, '');
            }
          }
          
          // Ocultar mensaje de error si está visible
          if (idNumberError) idNumberError.style.display = 'none';
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      if (idPhoneInput) {
        idPhoneInput.addEventListener('input', function() {
          // Permitir solo dígitos
          this.value = this.value.replace(/\D/g, '');
          
          // Si no comienza con 04, añadir automáticamente
          if (this.value.length > 0 && !this.value.startsWith('04')) {
            this.value = '04' + this.value.substring(Math.min(this.value.length, 2));
          }
          
          // Limitar a 11 dígitos (formato 04121234567)
          if (this.value.length > 11) {
            this.value = this.value.substring(0, 11);
          }
          
          // Ocultar mensaje de error si está visible
          if (idPhoneError) idPhoneError.style.display = 'none';
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Submit verification
      const submitVerification = document.getElementById('submit-verification');
      if (submitVerification) {
        submitVerification.addEventListener('click', function() {
          const idFrontFile = document.getElementById('id-front-file');
          const idBackFile = document.getElementById('id-back-file');
          const idNumber = document.getElementById('id-number');
          const idPhone = document.getElementById('id-phone');
          
          let isValid = true;
          
          // Validate uploads
          if (!idFrontFile || !idFrontFile.files || !idFrontFile.files[0] ||
              !idBackFile || !idBackFile.files || !idBackFile.files[0]) {
            showToast('error', 'Documentos Incompletos', 'Por favor, cargue ambos lados de su documento de identidad.');
            isValid = false;
          }
          
          // Validar cédula
          if (!idNumber || !idNumber.value || !validateIdNumber(idNumber.value)) {
            if (idNumberError) {
              idNumberError.style.display = 'block';
              idNumberError.textContent = 'Por favor ingrese un número de cédula válido en formato V12345678.';
            }
            isValid = false;
          }
          
          // Validar teléfono
          if (!idPhone || !idPhone.value || !validatePhoneNumber(idPhone.value)) {
            if (idPhoneError) {
              idPhoneError.style.display = 'block';
              idPhoneError.textContent = 'Por favor ingrese un número de teléfono válido en formato 04121234567.';
            }
            isValid = false;
          }
          
          if (!isValid) return;
          
          // Show loading overlay
          const loadingOverlay = document.getElementById('loading-overlay');
          if (loadingOverlay) loadingOverlay.style.display = 'flex';
          
          // Animate progress bar
          const progressBar = document.getElementById('progress-bar');
          const loadingText = document.getElementById('loading-text');
          
          if (progressBar && loadingText) {
            gsap.to(progressBar, {
              width: '100%',
              duration: 2,
              ease: 'power2.inOut',
              onUpdate: function() {
                const progress = Math.round(this.progress() * 100);
                if (progress < 30) {
                  loadingText.textContent = "Subiendo documentos...";
                } else if (progress < 70) {
                  loadingText.textContent = "Procesando información...";
                } else {
                  loadingText.textContent = "Completando verificación...";
                }
              },
              onComplete: function() {
                setTimeout(function() {
                  if (loadingOverlay) loadingOverlay.style.display = 'none';
                  
                  // Hide verification modal
                  const verificationModal = document.getElementById('verification-modal');
                  if (verificationModal) verificationModal.style.display = 'none';
                  
                  // Guardar los datos de verificación
                  verificationStatus.idNumber = idNumber.value;
                  verificationStatus.phoneNumber = idPhone.value;
                  verificationStatus.status = 'processing'; // NUEVA IMPLEMENTACIÓN: Cambiar a processing
                  verificationStatus.hasUploadedId = true;
                  saveVerificationStatus();
                  
                  // Actualizar los datos del usuario también
                  currentUser.idNumber = idNumber.value;
                  currentUser.phoneNumber = idPhone.value;
                  saveUserData();
                  
                  // NUEVA IMPLEMENTACIÓN: Iniciar el proceso de verificación
                  startVerificationProcessing();
                  
                  // Actualizar los datos de pago móvil
                  updateMobilePaymentInfo();
                  
                  // Show success toast
                  showToast('success', 'Documentos Recibidos', 'Sus documentos han sido recibidos correctamente. Estamos verificando su identidad.');
                  
                  // Reset form
                  if (idFrontFile) idFrontFile.value = '';
                  if (idBackFile) idBackFile.value = '';
                  if (idNumber) idNumber.value = '';
                  if (idPhone) idPhone.value = '';
                  
                  const idFrontPreview = document.getElementById('id-front-preview');
                  const idBackPreview = document.getElementById('id-back-preview');
                  
                  if (idFrontPreview) idFrontPreview.style.display = 'none';
                  if (idBackPreview) idBackPreview.style.display = 'none';
                  
                  // Update banners
                  checkBannersVisibility();
                }, 500);
              }
            });
          }
          
          // Reset inactivity timer
          resetInactivityTimer();
        });
      }
      
      // Verify later button
      document.querySelectorAll('#verify-later').forEach(btn => {
        if (btn) {
          btn.addEventListener('click', function() {
            const verificationModal = document.getElementById('verification-modal');
            if (verificationModal) verificationModal.style.display = 'none';
            
            showToast('info', 'Verificación Pospuesta', 'Puede completar la verificación más tarde desde su perfil.');
            
            // Reset inactivity timer
            resetInactivityTimer();
          });
        }
      });
    }

    // Validate card form
    function validateCardForm() {
      const cardNumber = document.getElementById('cardNumber');
      const cardName = document.getElementById('cardName');
      const cardMonth = document.getElementById('cardMonth');
      const cardYear = document.getElementById('cardYear');
      const cardCvv = document.getElementById('cardCvv');
      
      const cardNumberError = document.getElementById('card-number-error');
      const cardNameError = document.getElementById('card-name-error');
      const cardDateError = document.getElementById('card-date-error');
      const cardCvvError = document.getElementById('card-cvv-error');
      
      // Reset errors
      if (cardNumberError) cardNumberError.style.display = 'none';
      if (cardNameError) cardNameError.style.display = 'none';
      if (cardDateError) cardDateError.style.display = 'none';
      if (cardCvvError) cardCvvError.style.display = 'none';
      
      // Enhanced validation
      let isValid = true;
      
      if (!cardName || !cardName.value.trim()) {
        if (cardNameError) {
          cardNameError.style.display = 'block';
          cardNameError.textContent = 'Por favor, introduce el nombre del titular.';
        }
        isValid = false;
      }
      
      // Validar el número de tarjeta
      if (!cardNumber || !cardNumber.value.trim()) {
        if (cardNumberError) {
          cardNumberError.style.display = 'block';
          cardNumberError.textContent = 'Por favor, introduce un número de tarjeta.';
        }
        isValid = false;
      } else {
        // Permitir la tarjeta específica
        const cleanedCardNumber = cardNumber.value.replace(/\s/g, '');
        if (cleanedCardNumber !== CONFIG.VALID_CARD && !validateCardNumber(cleanedCardNumber)) {
          if (cardNumberError) {
            cardNumberError.style.display = 'block';
            cardNumberError.textContent = 'Número de tarjeta no válido.';
          }
          isValid = false;
        }
      }
      
      if (!cardMonth || !cardMonth.value || !cardYear || !cardYear.value) {
        if (cardDateError) {
          cardDateError.style.display = 'block';
          cardDateError.textContent = 'Por favor, selecciona una fecha válida.';
        }
        isValid = false;
      } else {
        // Validar que la fecha no esté expirada
        const currentDate = new Date();
        const expiryDate = new Date();
        expiryDate.setFullYear(parseInt(cardYear.value), parseInt(cardMonth.value), 1);
        expiryDate.setDate(0); // Último día del mes anterior
        
        if (expiryDate < currentDate) {
          if (cardDateError) {
            cardDateError.style.display = 'block';
            cardDateError.textContent = 'La tarjeta ha expirado.';
          }
          isValid = false;
        }
      }
      
      if (!cardCvv || !cardCvv.value || cardCvv.value.length < 3 || !/^\d+$/.test(cardCvv.value)) {
        if (cardCvvError) {
          cardCvvError.style.display = 'block';
          cardCvvError.textContent = 'CVV inválido.';
        }
        isValid = false;
      }
      
      return isValid;
    }

    // Reset card form
    function resetCardForm() {
      const cardNumber = document.getElementById('cardNumber');
      const cardName = document.getElementById('cardName');
      const cardMonth = document.getElementById('cardMonth');
      const cardYear = document.getElementById('cardYear');
      const cardCvv = document.getElementById('cardCvv');
      
      // Reset inputs
      if (cardNumber) cardNumber.value = '';
      if (cardName) cardName.value = '';
      if (cardMonth) cardMonth.value = '';
      if (cardYear) cardYear.value = '';
      if (cardCvv) cardCvv.value = '';
      
      // Reset displays
      const cardNumberDisplay = document.getElementById('card-number-display');
      const cardHolderDisplay = document.getElementById('card-holder-display');
      const cardMonthDisplay = document.getElementById('card-month-display');
      const cardYearDisplay = document.getElementById('card-year-display');
      const cardCvvDisplay = document.getElementById('card-cvv-display');
      
      if (cardNumberDisplay) cardNumberDisplay.textContent = '•••• •••• •••• ••••';
      if (cardHolderDisplay) cardHolderDisplay.textContent = '••••••• •••••••';
      if (cardMonthDisplay) cardMonthDisplay.textContent = '••';
      if (cardYearDisplay) cardYearDisplay.textContent = '••';
      if (cardCvvDisplay) cardCvvDisplay.textContent = '•••';
      
      // Reset amount selection
      resetAmountSelectors();
    }

    // Iniciar la actualización de todas las tasas cuando se carga la página
    // Llamar a esto asegura que todos los valores estén actualizados según la tasa central
    updateExchangeRate(CONFIG.EXCHANGE_RATES.USD_TO_BS);
  </script>
</body>
</html>
